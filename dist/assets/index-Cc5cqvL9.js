import{g as na,U as K,W as yt,S as pe,B as Bn,a as Ht,V as ee,D as Lc,b as Bc,c as Ic,d as Uc,L as Sn,e as Nr,O as Vc,M as ra,C as zr,f as bn,h as zi,i as jt,F as Nc,E as is,j as sa,N as oa,k as vi,R as aa,P as la,l as ha,T as ua,m as ca,n as Fr,o as Eo,A as zc,r as Fc,p as Hc,w as Gc,q as da,s as pa,t as jc,u as Kc,v as Yc,x as Wc,y as qc,z as je,G as ai,H as ri,Q as Co,I as Po,J as $c,K as Xc,X as Zc,Y as Qc,Z as Jc,_ as ed,$ as td,a0 as id,a1 as nd,a2 as rd,a3 as sd,a4 as od,a5 as ad,a6 as So,a7 as ld,a8 as hd,a9 as ud,aa as cd,ab as dd}from"./vendor-BUDwebSF.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const h of a)if(h.type==="childList")for(const u of h.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function n(a){const h={};return a.integrity&&(h.integrity=a.integrity),a.referrerPolicy&&(h.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?h.credentials="include":a.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function s(a){if(a.ep)return;a.ep=!0;const h=n(a);fetch(a.href,h)}})();function Je(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function fa(o,t){o.prototype=Object.create(t.prototype),o.prototype.constructor=o,o.__proto__=t}var Te={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},ci={duration:.5,overwrite:!1,delay:0},ns,De=1e8,X=1/De,Hr=Math.PI*2,pd=Hr/4,fd=0,ma=Math.sqrt,md=Math.cos,vd=Math.sin,he=function(t){return typeof t=="string"},le=function(t){return typeof t=="function"},it=function(t){return typeof t=="number"},rs=function(t){return typeof t>"u"},nt=function(t){return typeof t=="object"},we=function(t){return t!==!1},va=function(){return typeof window<"u"},xn=function(t){return le(t)||he(t)},_a=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},me=Array.isArray,Gr=/(?:-?\.?\d|\.)+/gi,ga=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,si=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,xr=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,ba=/[+-]=-?[.\d]+/,xa=/[^,'"\[\]\s]+/gi,_d=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ie,Ke,jr,ss,Me={},Tn={},wa,ya=function(t){return(Tn=Gt(t,Me))&&Ve},os=function(t,n){return console.warn("Invalid property",t,"set to",n,"Missing plugin? gsap.registerPlugin()")},Mn=function(t,n){return!n&&console.warn(t)},Ea=function(t,n){return t&&(Me[t]=n)&&Tn&&(Tn[t]=n)||Me},qi=function(){return 0},as={},_t=[],Kr={},Ca,Pe={},wr={},To=30,Cn=[],ls="",hs=function(t){var n=t[0],s,a;if(nt(n)||le(n)||(t=[t]),!(s=(n._gsap||{}).harness)){for(a=Cn.length;a--&&!Cn[a].targetTest(n););s=Cn[a]}for(a=t.length;a--;)t[a]&&(t[a]._gsap||(t[a]._gsap=new Ya(t[a],s)))||t.splice(a,1);return t},Ut=function(t){return t._gsap||hs(Oe(t))[0]._gsap},Pa=function(t,n,s){return(s=t[n])&&le(s)?t[n]():rs(s)&&t.getAttribute&&t.getAttribute(n)||s},ye=function(t,n){return(t=t.split(",")).forEach(n)||t},se=function(t){return Math.round(t*1e5)/1e5||0},de=function(t){return Math.round(t*1e7)/1e7||0},li=function(t,n){var s=n.charAt(0),a=parseFloat(n.substr(2));return t=parseFloat(t),s==="+"?t+a:s==="-"?t-a:s==="*"?t*a:t/a},gd=function(t,n){for(var s=n.length,a=0;t.indexOf(n[a])<0&&++a<s;);return a<s},kn=function(){var t=_t.length,n=_t.slice(0),s,a;for(Kr={},_t.length=0,s=0;s<t;s++)a=n[s],a&&a._lazy&&(a.render(a._lazy[0],a._lazy[1],!0)._lazy=0)},Sa=function(t,n,s,a){_t.length&&kn(),t.render(n,s,a),_t.length&&kn()},Ta=function(t){var n=parseFloat(t);return(n||n===0)&&(t+"").match(xa).length<2?n:he(t)?t.trim():t},Ma=function(t){return t},Be=function(t,n){for(var s in n)s in t||(t[s]=n[s]);return t},bd=function(t){return function(n,s){for(var a in s)a in n||a==="duration"&&t||a==="ease"||(n[a]=s[a])}},Gt=function(t,n){for(var s in n)t[s]=n[s];return t},Mo=function o(t,n){for(var s in n)s!=="__proto__"&&s!=="constructor"&&s!=="prototype"&&(t[s]=nt(n[s])?o(t[s]||(t[s]={}),n[s]):n[s]);return t},An=function(t,n){var s={},a;for(a in t)a in n||(s[a]=t[a]);return s},ji=function(t){var n=t.parent||ie,s=t.keyframes?bd(me(t.keyframes)):Be;if(we(t.inherit))for(;n;)s(t,n.vars.defaults),n=n.parent||n._dp;return t},xd=function(t,n){for(var s=t.length,a=s===n.length;a&&s--&&t[s]===n[s];);return s<0},ka=function(t,n,s,a,h){var u=t[a],c;if(h)for(c=n[h];u&&u[h]>c;)u=u._prev;return u?(n._next=u._next,u._next=n):(n._next=t[s],t[s]=n),n._next?n._next._prev=n:t[a]=n,n._prev=u,n.parent=n._dp=t,n},In=function(t,n,s,a){s===void 0&&(s="_first"),a===void 0&&(a="_last");var h=n._prev,u=n._next;h?h._next=u:t[s]===n&&(t[s]=u),u?u._prev=h:t[a]===n&&(t[a]=h),n._next=n._prev=n.parent=null},et=function(t,n){t.parent&&(!n||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},Vt=function(t,n){if(t&&(!n||n._end>t._dur||n._start<0))for(var s=t;s;)s._dirty=1,s=s.parent;return t},wd=function(t){for(var n=t.parent;n&&n.parent;)n._dirty=1,n.totalDuration(),n=n.parent;return t},yd=function o(t){return!t||t._ts&&o(t.parent)},ko=function(t){return t._repeat?di(t._tTime,t=t.duration()+t._rDelay)*t:0},di=function(t,n){var s=Math.floor(t/=n);return t&&s===t?s-1:s},Rn=function(t,n){return(t-n._start)*n._ts+(n._ts>=0?0:n._dirty?n.totalDuration():n._tDur)},Un=function(t){return t._end=de(t._start+(t._tDur/Math.abs(t._ts||t._rts||X)||0))},us=function(t,n){var s=t._dp;return s&&s.smoothChildTiming&&t._ts&&(t._start=de(s._time-(t._ts>0?n/t._ts:((t._dirty?t.totalDuration():t._tDur)-n)/-t._ts)),Un(t),s._dirty||Vt(s,t)),t},Aa=function(t,n){var s;if((n._time||n._initted&&!n._dur)&&(s=Rn(t.rawTime(),n),(!n._dur||tn(0,n.totalDuration(),s)-n._tTime>X)&&n.render(s,!0)),Vt(t,n)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(s=t;s._dp;)s.rawTime()>=0&&s.totalTime(s._tTime),s=s._dp;t._zTime=-X}},Ye=function(t,n,s,a){return n.parent&&et(n),n._start=de((it(s)?s:s||t!==ie?Re(t,s,n):t._time)+n._delay),n._end=de(n._start+(n.totalDuration()/Math.abs(n.timeScale())||0)),ka(t,n,"_first","_last",t._sort?"_start":0),Yr(n)||(t._recent=n),a||Aa(t,n),t},Ra=function(t,n){return(Me.ScrollTrigger||os("scrollTrigger",n))&&Me.ScrollTrigger.create(n,t)},Da=function(t,n,s,a){if(ds(t,n),!t._initted)return 1;if(!s&&t._pt&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&Ca!==Se.frame)return _t.push(t),t._lazy=[n,a],1},Ed=function o(t){var n=t.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||o(n))},Yr=function(t){var n=t.data;return n==="isFromStart"||n==="isStart"},Cd=function(t,n,s,a){var h=t.ratio,u=n<0||!n&&(!t._start&&Ed(t)&&!(!t._initted&&Yr(t))||(t._ts<0||t._dp._ts<0)&&!Yr(t))?0:1,c=t._rDelay,p=0,f,m,_;if(c&&t._repeat&&(p=tn(0,t._tDur,n),m=di(p,c),t._yoyo&&m&1&&(u=1-u),m!==di(t._tTime,c)&&(h=1-u,t.vars.repeatRefresh&&t._initted&&t.invalidate())),u!==h||a||t._zTime===X||!n&&t._zTime){if(!t._initted&&Da(t,n,a,s))return;for(_=t._zTime,t._zTime=n||(s?X:0),s||(s=n&&!_),t.ratio=u,t._from&&(u=1-u),t._time=0,t._tTime=p,f=t._pt;f;)f.r(u,f.d),f=f._next;t._startAt&&n<0&&t._startAt.render(n,!0,!0),t._onUpdate&&!s&&Le(t,"onUpdate"),p&&t._repeat&&!s&&t.parent&&Le(t,"onRepeat"),(n>=t._tDur||n<0)&&t.ratio===u&&(u&&et(t,1),s||(Le(t,u?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=n)},Pd=function(t,n,s){var a;if(s>n)for(a=t._first;a&&a._start<=s;){if(a.data==="isPause"&&a._start>n)return a;a=a._next}else for(a=t._last;a&&a._start>=s;){if(a.data==="isPause"&&a._start<n)return a;a=a._prev}},pi=function(t,n,s,a){var h=t._repeat,u=de(n)||0,c=t._tTime/t._tDur;return c&&!a&&(t._time*=u/t._dur),t._dur=u,t._tDur=h?h<0?1e10:de(u*(h+1)+t._rDelay*h):u,c>0&&!a?us(t,t._tTime=t._tDur*c):t.parent&&Un(t),s||Vt(t.parent,t),t},Ao=function(t){return t instanceof xe?Vt(t):pi(t,t._dur)},Sd={_start:0,endTime:qi,totalDuration:qi},Re=function o(t,n,s){var a=t.labels,h=t._recent||Sd,u=t.duration()>=De?h.endTime(!1):t._dur,c,p,f;return he(n)&&(isNaN(n)||n in a)?(p=n.charAt(0),f=n.substr(-1)==="%",c=n.indexOf("="),p==="<"||p===">"?(c>=0&&(n=n.replace(/=/,"")),(p==="<"?h._start:h.endTime(h._repeat>=0))+(parseFloat(n.substr(1))||0)*(f?(c<0?h:s).totalDuration()/100:1)):c<0?(n in a||(a[n]=u),a[n]):(p=parseFloat(n.charAt(c-1)+n.substr(c+1)),f&&s&&(p=p/100*(me(s)?s[0]:s).totalDuration()),c>1?o(t,n.substr(0,c-1),s)+p:u+p)):n==null?u:+n},Ki=function(t,n,s){var a=it(n[1]),h=(a?2:1)+(t<2?0:1),u=n[h],c,p;if(a&&(u.duration=n[1]),u.parent=s,t){for(c=u,p=s;p&&!("immediateRender"in c);)c=p.vars.defaults||{},p=we(p.vars.inherit)&&p.parent;u.immediateRender=we(c.immediateRender),t<2?u.runBackwards=1:u.startAt=n[h-1]}return new ae(n[0],u,n[h+1])},Et=function(t,n){return t||t===0?n(t):n},tn=function(t,n,s){return s<t?t:s>n?n:s},fe=function(t,n){return!he(t)||!(n=_d.exec(t))?"":n[1]},Td=function(t,n,s){return Et(s,function(a){return tn(t,n,a)})},Wr=[].slice,Oa=function(t,n){return t&&nt(t)&&"length"in t&&(!n&&!t.length||t.length-1 in t&&nt(t[0]))&&!t.nodeType&&t!==Ke},Md=function(t,n,s){return s===void 0&&(s=[]),t.forEach(function(a){var h;return he(a)&&!n||Oa(a,1)?(h=s).push.apply(h,Oe(a)):s.push(a)})||s},Oe=function(t,n,s){return he(t)&&!s&&(jr||!fi())?Wr.call((n||ss).querySelectorAll(t),0):me(t)?Md(t,s):Oa(t)?Wr.call(t,0):t?[t]:[]},kd=function(t){return t=Oe(t)[0]||Mn("Invalid scope")||{},function(n){var s=t.current||t.nativeElement||t;return Oe(n,s.querySelectorAll?s:s===t?Mn("Invalid scope")||ss.createElement("div"):t)}},La=function(t){return t.sort(function(){return .5-Math.random()})},Ba=function(t){if(le(t))return t;var n=nt(t)?t:{each:t},s=Nt(n.ease),a=n.from||0,h=parseFloat(n.base)||0,u={},c=a>0&&a<1,p=isNaN(a)||c,f=n.axis,m=a,_=a;return he(a)?m=_={center:.5,edges:.5,end:1}[a]||0:!c&&p&&(m=a[0],_=a[1]),function(x,v,E){var g=(E||n).length,w=u[g],S,C,P,k,T,M,O,R,D;if(!w){if(D=n.grid==="auto"?0:(n.grid||[1,De])[1],!D){for(O=-De;O<(O=E[D++].getBoundingClientRect().left)&&D<g;);D--}for(w=u[g]=[],S=p?Math.min(D,g)*m-.5:a%D,C=D===De?0:p?g*_/D-.5:a/D|0,O=0,R=De,M=0;M<g;M++)P=M%D-S,k=C-(M/D|0),w[M]=T=f?Math.abs(f==="y"?k:P):ma(P*P+k*k),T>O&&(O=T),T<R&&(R=T);a==="random"&&La(w),w.max=O-R,w.min=R,w.v=g=(parseFloat(n.amount)||parseFloat(n.each)*(D>g?g-1:f?f==="y"?g/D:D:Math.max(D,g/D))||0)*(a==="edges"?-1:1),w.b=g<0?h-g:h,w.u=fe(n.amount||n.each)||0,s=s&&g<0?Ga(s):s}return g=(w[x]-w.min)/w.max||0,de(w.b+(s?s(g):g)*w.v)+w.u}},qr=function(t){var n=Math.pow(10,((t+"").split(".")[1]||"").length);return function(s){var a=Math.round(parseFloat(s)/t)*t*n;return(a-a%1)/n+(it(s)?0:fe(s))}},Ia=function(t,n){var s=me(t),a,h;return!s&&nt(t)&&(a=s=t.radius||De,t.values?(t=Oe(t.values),(h=!it(t[0]))&&(a*=a)):t=qr(t.increment)),Et(n,s?le(t)?function(u){return h=t(u),Math.abs(h-u)<=a?h:u}:function(u){for(var c=parseFloat(h?u.x:u),p=parseFloat(h?u.y:0),f=De,m=0,_=t.length,x,v;_--;)h?(x=t[_].x-c,v=t[_].y-p,x=x*x+v*v):x=Math.abs(t[_]-c),x<f&&(f=x,m=_);return m=!a||f<=a?t[m]:u,h||m===u||it(u)?m:m+fe(u)}:qr(t))},Ua=function(t,n,s,a){return Et(me(t)?!n:s===!0?!!(s=0):!a,function(){return me(t)?t[~~(Math.random()*t.length)]:(s=s||1e-5)&&(a=s<1?Math.pow(10,(s+"").length-2):1)&&Math.floor(Math.round((t-s/2+Math.random()*(n-t+s*.99))/s)*s*a)/a})},Ad=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return function(a){return n.reduce(function(h,u){return u(h)},a)}},Rd=function(t,n){return function(s){return t(parseFloat(s))+(n||fe(s))}},Dd=function(t,n,s){return Na(t,n,0,1,s)},Va=function(t,n,s){return Et(s,function(a){return t[~~n(a)]})},Od=function o(t,n,s){var a=n-t;return me(t)?Va(t,o(0,t.length),n):Et(s,function(h){return(a+(h-t)%a)%a+t})},Ld=function o(t,n,s){var a=n-t,h=a*2;return me(t)?Va(t,o(0,t.length-1),n):Et(s,function(u){return u=(h+(u-t)%h)%h||0,t+(u>a?h-u:u)})},$i=function(t){for(var n=0,s="",a,h,u,c;~(a=t.indexOf("random(",n));)u=t.indexOf(")",a),c=t.charAt(a+7)==="[",h=t.substr(a+7,u-a-7).match(c?xa:Gr),s+=t.substr(n,a-n)+Ua(c?h:+h[0],c?0:+h[1],+h[2]||1e-5),n=u+1;return s+t.substr(n,t.length-n)},Na=function(t,n,s,a,h){var u=n-t,c=a-s;return Et(h,function(p){return s+((p-t)/u*c||0)})},Bd=function o(t,n,s,a){var h=isNaN(t+n)?0:function(v){return(1-v)*t+v*n};if(!h){var u=he(t),c={},p,f,m,_,x;if(s===!0&&(a=1)&&(s=null),u)t={p:t},n={p:n};else if(me(t)&&!me(n)){for(m=[],_=t.length,x=_-2,f=1;f<_;f++)m.push(o(t[f-1],t[f]));_--,h=function(E){E*=_;var g=Math.min(x,~~E);return m[g](E-g)},s=n}else a||(t=Gt(me(t)?[]:{},t));if(!m){for(p in n)cs.call(c,t,p,"get",n[p]);h=function(E){return ms(E,c)||(u?t.p:t)}}}return Et(s,h)},Ro=function(t,n,s){var a=t.labels,h=De,u,c,p;for(u in a)c=a[u]-n,c<0==!!s&&c&&h>(c=Math.abs(c))&&(p=u,h=c);return p},Le=function(t,n,s){var a=t.vars,h=a[n],u,c;if(h)return u=a[n+"Params"],c=a.callbackScope||t,s&&_t.length&&kn(),u?h.apply(c,u):h.call(c)},Fi=function(t){return et(t),t.scrollTrigger&&t.scrollTrigger.kill(!1),t.progress()<1&&Le(t,"onInterrupt"),t},oi,Id=function(t){t=!t.name&&t.default||t;var n=t.name,s=le(t),a=n&&!s&&t.init?function(){this._props=[]}:t,h={init:qi,render:ms,add:cs,kill:Qd,modifier:Zd,rawVars:0},u={targetTest:0,get:0,getSetter:fs,aliases:{},register:0};if(fi(),t!==a){if(Pe[n])return;Be(a,Be(An(t,h),u)),Gt(a.prototype,Gt(h,An(t,u))),Pe[a.prop=n]=a,t.targetTest&&(Cn.push(a),as[n]=1),n=(n==="css"?"CSS":n.charAt(0).toUpperCase()+n.substr(1))+"Plugin"}Ea(n,a),t.register&&t.register(Ve,a,Ee)},$=255,Hi={aqua:[0,$,$],lime:[0,$,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,$],navy:[0,0,128],white:[$,$,$],olive:[128,128,0],yellow:[$,$,0],orange:[$,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[$,0,0],pink:[$,192,203],cyan:[0,$,$],transparent:[$,$,$,0]},yr=function(t,n,s){return t+=t<0?1:t>1?-1:0,(t*6<1?n+(s-n)*t*6:t<.5?s:t*3<2?n+(s-n)*(2/3-t)*6:n)*$+.5|0},za=function(t,n,s){var a=t?it(t)?[t>>16,t>>8&$,t&$]:0:Hi.black,h,u,c,p,f,m,_,x,v,E;if(!a){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),Hi[t])a=Hi[t];else if(t.charAt(0)==="#"){if(t.length<6&&(h=t.charAt(1),u=t.charAt(2),c=t.charAt(3),t="#"+h+h+u+u+c+c+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return a=parseInt(t.substr(1,6),16),[a>>16,a>>8&$,a&$,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),a=[t>>16,t>>8&$,t&$]}else if(t.substr(0,3)==="hsl"){if(a=E=t.match(Gr),!n)p=+a[0]%360/360,f=+a[1]/100,m=+a[2]/100,u=m<=.5?m*(f+1):m+f-m*f,h=m*2-u,a.length>3&&(a[3]*=1),a[0]=yr(p+1/3,h,u),a[1]=yr(p,h,u),a[2]=yr(p-1/3,h,u);else if(~t.indexOf("="))return a=t.match(ga),s&&a.length<4&&(a[3]=1),a}else a=t.match(Gr)||Hi.transparent;a=a.map(Number)}return n&&!E&&(h=a[0]/$,u=a[1]/$,c=a[2]/$,_=Math.max(h,u,c),x=Math.min(h,u,c),m=(_+x)/2,_===x?p=f=0:(v=_-x,f=m>.5?v/(2-_-x):v/(_+x),p=_===h?(u-c)/v+(u<c?6:0):_===u?(c-h)/v+2:(h-u)/v+4,p*=60),a[0]=~~(p+.5),a[1]=~~(f*100+.5),a[2]=~~(m*100+.5)),s&&a.length<4&&(a[3]=1),a},Fa=function(t){var n=[],s=[],a=-1;return t.split(gt).forEach(function(h){var u=h.match(si)||[];n.push.apply(n,u),s.push(a+=u.length+1)}),n.c=s,n},Do=function(t,n,s){var a="",h=(t+a).match(gt),u=n?"hsla(":"rgba(",c=0,p,f,m,_;if(!h)return t;if(h=h.map(function(x){return(x=za(x,n,1))&&u+(n?x[0]+","+x[1]+"%,"+x[2]+"%,"+x[3]:x.join(","))+")"}),s&&(m=Fa(t),p=s.c,p.join(a)!==m.c.join(a)))for(f=t.replace(gt,"1").split(si),_=f.length-1;c<_;c++)a+=f[c]+(~p.indexOf(c)?h.shift()||u+"0,0,0,0)":(m.length?m:h.length?h:s).shift());if(!f)for(f=t.split(gt),_=f.length-1;c<_;c++)a+=f[c]+h[c];return a+f[_]},gt=(function(){var o="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in Hi)o+="|"+t+"\\b";return new RegExp(o+")","gi")})(),Ud=/hsl[a]?\(/,Ha=function(t){var n=t.join(" "),s;if(gt.lastIndex=0,gt.test(n))return s=Ud.test(n),t[1]=Do(t[1],s),t[0]=Do(t[0],s,Fa(t[1])),!0},Xi,Se=(function(){var o=Date.now,t=500,n=33,s=o(),a=s,h=1e3/240,u=h,c=[],p,f,m,_,x,v,E=function g(w){var S=o()-a,C=w===!0,P,k,T,M;if(S>t&&(s+=S-n),a+=S,T=a-s,P=T-u,(P>0||C)&&(M=++_.frame,x=T-_.time*1e3,_.time=T=T/1e3,u+=P+(P>=h?4:h-P),k=1),C||(p=f(g)),k)for(v=0;v<c.length;v++)c[v](T,x,M,w)};return _={time:0,frame:0,tick:function(){E(!0)},deltaRatio:function(w){return x/(1e3/(w||60))},wake:function(){wa&&(!jr&&va()&&(Ke=jr=window,ss=Ke.document||{},Me.gsap=Ve,(Ke.gsapVersions||(Ke.gsapVersions=[])).push(Ve.version),ya(Tn||Ke.GreenSockGlobals||!Ke.gsap&&Ke||{}),m=Ke.requestAnimationFrame),p&&_.sleep(),f=m||function(w){return setTimeout(w,u-_.time*1e3+1|0)},Xi=1,E(2))},sleep:function(){(m?Ke.cancelAnimationFrame:clearTimeout)(p),Xi=0,f=qi},lagSmoothing:function(w,S){t=w||1/X,n=Math.min(S,t,0)},fps:function(w){h=1e3/(w||240),u=_.time*1e3+h},add:function(w,S,C){var P=S?function(k,T,M,O){w(k,T,M,O),_.remove(P)}:w;return _.remove(w),c[C?"unshift":"push"](P),fi(),P},remove:function(w,S){~(S=c.indexOf(w))&&c.splice(S,1)&&v>=S&&v--},_listeners:c},_})(),fi=function(){return!Xi&&Se.wake()},F={},Vd=/^[\d.\-M][\d.\-,\s]/,Nd=/["']/g,zd=function(t){for(var n={},s=t.substr(1,t.length-3).split(":"),a=s[0],h=1,u=s.length,c,p,f;h<u;h++)p=s[h],c=h!==u-1?p.lastIndexOf(","):p.length,f=p.substr(0,c),n[a]=isNaN(f)?f.replace(Nd,"").trim():+f,a=p.substr(c+1).trim();return n},Fd=function(t){var n=t.indexOf("(")+1,s=t.indexOf(")"),a=t.indexOf("(",n);return t.substring(n,~a&&a<s?t.indexOf(")",s+1):s)},Hd=function(t){var n=(t+"").split("("),s=F[n[0]];return s&&n.length>1&&s.config?s.config.apply(null,~t.indexOf("{")?[zd(n[1])]:Fd(t).split(",").map(Ta)):F._CE&&Vd.test(t)?F._CE("",t):s},Ga=function(t){return function(n){return 1-t(1-n)}},ja=function o(t,n){for(var s=t._first,a;s;)s instanceof xe?o(s,n):s.vars.yoyoEase&&(!s._yoyo||!s._repeat)&&s._yoyo!==n&&(s.timeline?o(s.timeline,n):(a=s._ease,s._ease=s._yEase,s._yEase=a,s._yoyo=n)),s=s._next},Nt=function(t,n){return t&&(le(t)?t:F[t]||Hd(t))||n},Kt=function(t,n,s,a){s===void 0&&(s=function(p){return 1-n(1-p)}),a===void 0&&(a=function(p){return p<.5?n(p*2)/2:1-n((1-p)*2)/2});var h={easeIn:n,easeOut:s,easeInOut:a},u;return ye(t,function(c){F[c]=Me[c]=h,F[u=c.toLowerCase()]=s;for(var p in h)F[u+(p==="easeIn"?".in":p==="easeOut"?".out":".inOut")]=F[c+"."+p]=h[p]}),h},Ka=function(t){return function(n){return n<.5?(1-t(1-n*2))/2:.5+t((n-.5)*2)/2}},Er=function o(t,n,s){var a=n>=1?n:1,h=(s||(t?.3:.45))/(n<1?n:1),u=h/Hr*(Math.asin(1/a)||0),c=function(m){return m===1?1:a*Math.pow(2,-10*m)*vd((m-u)*h)+1},p=t==="out"?c:t==="in"?function(f){return 1-c(1-f)}:Ka(c);return h=Hr/h,p.config=function(f,m){return o(t,f,m)},p},Cr=function o(t,n){n===void 0&&(n=1.70158);var s=function(u){return u?--u*u*((n+1)*u+n)+1:0},a=t==="out"?s:t==="in"?function(h){return 1-s(1-h)}:Ka(s);return a.config=function(h){return o(t,h)},a};ye("Linear,Quad,Cubic,Quart,Quint,Strong",function(o,t){var n=t<5?t+1:t;Kt(o+",Power"+(n-1),t?function(s){return Math.pow(s,n)}:function(s){return s},function(s){return 1-Math.pow(1-s,n)},function(s){return s<.5?Math.pow(s*2,n)/2:1-Math.pow((1-s)*2,n)/2})});F.Linear.easeNone=F.none=F.Linear.easeIn;Kt("Elastic",Er("in"),Er("out"),Er());(function(o,t){var n=1/t,s=2*n,a=2.5*n,h=function(c){return c<n?o*c*c:c<s?o*Math.pow(c-1.5/t,2)+.75:c<a?o*(c-=2.25/t)*c+.9375:o*Math.pow(c-2.625/t,2)+.984375};Kt("Bounce",function(u){return 1-h(1-u)},h)})(7.5625,2.75);Kt("Expo",function(o){return o?Math.pow(2,10*(o-1)):0});Kt("Circ",function(o){return-(ma(1-o*o)-1)});Kt("Sine",function(o){return o===1?1:-md(o*pd)+1});Kt("Back",Cr("in"),Cr("out"),Cr());F.SteppedEase=F.steps=Me.SteppedEase={config:function(t,n){t===void 0&&(t=1);var s=1/t,a=t+(n?0:1),h=n?1:0,u=1-X;return function(c){return((a*tn(0,u,c)|0)+h)*s}}};ci.ease=F["quad.out"];ye("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(o){return ls+=o+","+o+"Params,"});var Ya=function(t,n){this.id=fd++,t._gsap=this,this.target=t,this.harness=n,this.get=n?n.get:Pa,this.set=n?n.getSetter:fs},Zi=(function(){function o(n){this.vars=n,this._delay=+n.delay||0,(this._repeat=n.repeat===1/0?-2:n.repeat||0)&&(this._rDelay=n.repeatDelay||0,this._yoyo=!!n.yoyo||!!n.yoyoEase),this._ts=1,pi(this,+n.duration,1,1),this.data=n.data,Xi||Se.wake()}var t=o.prototype;return t.delay=function(s){return s||s===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+s-this._delay),this._delay=s,this):this._delay},t.duration=function(s){return arguments.length?this.totalDuration(this._repeat>0?s+(s+this._rDelay)*this._repeat:s):this.totalDuration()&&this._dur},t.totalDuration=function(s){return arguments.length?(this._dirty=0,pi(this,this._repeat<0?s:(s-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(s,a){if(fi(),!arguments.length)return this._tTime;var h=this._dp;if(h&&h.smoothChildTiming&&this._ts){for(us(this,s),!h._dp||h.parent||Aa(h,this);h&&h.parent;)h.parent._time!==h._start+(h._ts>=0?h._tTime/h._ts:(h.totalDuration()-h._tTime)/-h._ts)&&h.totalTime(h._tTime,!0),h=h.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&s<this._tDur||this._ts<0&&s>0||!this._tDur&&!s)&&Ye(this._dp,this,this._start-this._delay)}return(this._tTime!==s||!this._dur&&!a||this._initted&&Math.abs(this._zTime)===X||!s&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=s),Sa(this,s,a)),this},t.time=function(s,a){return arguments.length?this.totalTime(Math.min(this.totalDuration(),s+ko(this))%(this._dur+this._rDelay)||(s?this._dur:0),a):this._time},t.totalProgress=function(s,a){return arguments.length?this.totalTime(this.totalDuration()*s,a):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(s,a){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-s:s)+ko(this),a):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(s,a){var h=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(s-1)*h,a):this._repeat?di(this._tTime,h)+1:1},t.timeScale=function(s){if(!arguments.length)return this._rts===-X?0:this._rts;if(this._rts===s)return this;var a=this.parent&&this._ts?Rn(this.parent._time,this):this._tTime;return this._rts=+s||0,this._ts=this._ps||s===-X?0:this._rts,this.totalTime(tn(-this._delay,this._tDur,a),!0),Un(this),wd(this)},t.paused=function(s){return arguments.length?(this._ps!==s&&(this._ps=s,s?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(fi(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==X&&(this._tTime-=X)))),this):this._ps},t.startTime=function(s){if(arguments.length){this._start=s;var a=this.parent||this._dp;return a&&(a._sort||!this.parent)&&Ye(a,this,s-this._delay),this}return this._start},t.endTime=function(s){return this._start+(we(s)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(s){var a=this.parent||this._dp;return a?s&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Rn(a.rawTime(s),this):this._tTime:this._tTime},t.globalTime=function(s){for(var a=this,h=arguments.length?s:a.rawTime();a;)h=a._start+h/(a._ts||1),a=a._dp;return h},t.repeat=function(s){return arguments.length?(this._repeat=s===1/0?-2:s,Ao(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(s){if(arguments.length){var a=this._time;return this._rDelay=s,Ao(this),a?this.time(a):this}return this._rDelay},t.yoyo=function(s){return arguments.length?(this._yoyo=s,this):this._yoyo},t.seek=function(s,a){return this.totalTime(Re(this,s),we(a))},t.restart=function(s,a){return this.play().totalTime(s?-this._delay:0,we(a))},t.play=function(s,a){return s!=null&&this.seek(s,a),this.reversed(!1).paused(!1)},t.reverse=function(s,a){return s!=null&&this.seek(s||this.totalDuration(),a),this.reversed(!0).paused(!1)},t.pause=function(s,a){return s!=null&&this.seek(s,a),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(s){return arguments.length?(!!s!==this.reversed()&&this.timeScale(-this._rts||(s?-X:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-X,this},t.isActive=function(){var s=this.parent||this._dp,a=this._start,h;return!!(!s||this._ts&&this._initted&&s.isActive()&&(h=s.rawTime(!0))>=a&&h<this.endTime(!0)-X)},t.eventCallback=function(s,a,h){var u=this.vars;return arguments.length>1?(a?(u[s]=a,h&&(u[s+"Params"]=h),s==="onUpdate"&&(this._onUpdate=a)):delete u[s],this):u[s]},t.then=function(s){var a=this;return new Promise(function(h){var u=le(s)?s:Ma,c=function(){var f=a.then;a.then=null,le(u)&&(u=u(a))&&(u.then||u===a)&&(a.then=f),h(u),a.then=f};a._initted&&a.totalProgress()===1&&a._ts>=0||!a._tTime&&a._ts<0?c():a._prom=c})},t.kill=function(){Fi(this)},o})();Be(Zi.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-X,_prom:0,_ps:!1,_rts:1});var xe=(function(o){fa(t,o);function t(s,a){var h;return s===void 0&&(s={}),h=o.call(this,s)||this,h.labels={},h.smoothChildTiming=!!s.smoothChildTiming,h.autoRemoveChildren=!!s.autoRemoveChildren,h._sort=we(s.sortChildren),ie&&Ye(s.parent||ie,Je(h),a),s.reversed&&h.reverse(),s.paused&&h.paused(!0),s.scrollTrigger&&Ra(Je(h),s.scrollTrigger),h}var n=t.prototype;return n.to=function(a,h,u){return Ki(0,arguments,this),this},n.from=function(a,h,u){return Ki(1,arguments,this),this},n.fromTo=function(a,h,u,c){return Ki(2,arguments,this),this},n.set=function(a,h,u){return h.duration=0,h.parent=this,ji(h).repeatDelay||(h.repeat=0),h.immediateRender=!!h.immediateRender,new ae(a,h,Re(this,u),1),this},n.call=function(a,h,u){return Ye(this,ae.delayedCall(0,a,h),u)},n.staggerTo=function(a,h,u,c,p,f,m){return u.duration=h,u.stagger=u.stagger||c,u.onComplete=f,u.onCompleteParams=m,u.parent=this,new ae(a,u,Re(this,p)),this},n.staggerFrom=function(a,h,u,c,p,f,m){return u.runBackwards=1,ji(u).immediateRender=we(u.immediateRender),this.staggerTo(a,h,u,c,p,f,m)},n.staggerFromTo=function(a,h,u,c,p,f,m,_){return c.startAt=u,ji(c).immediateRender=we(c.immediateRender),this.staggerTo(a,h,c,p,f,m,_)},n.render=function(a,h,u){var c=this._time,p=this._dirty?this.totalDuration():this._tDur,f=this._dur,m=a<=0?0:de(a),_=this._zTime<0!=a<0&&(this._initted||!f),x,v,E,g,w,S,C,P,k,T,M,O;if(this!==ie&&m>p&&a>=0&&(m=p),m!==this._tTime||u||_){if(c!==this._time&&f&&(m+=this._time-c,a+=this._time-c),x=m,k=this._start,P=this._ts,S=!P,_&&(f||(c=this._zTime),(a||!h)&&(this._zTime=a)),this._repeat){if(M=this._yoyo,w=f+this._rDelay,this._repeat<-1&&a<0)return this.totalTime(w*100+a,h,u);if(x=de(m%w),m===p?(g=this._repeat,x=f):(g=~~(m/w),g&&g===m/w&&(x=f,g--),x>f&&(x=f)),T=di(this._tTime,w),!c&&this._tTime&&T!==g&&(T=g),M&&g&1&&(x=f-x,O=1),g!==T&&!this._lock){var R=M&&T&1,D=R===(M&&g&1);if(g<T&&(R=!R),c=R?0:f,this._lock=1,this.render(c||(O?0:de(g*w)),h,!f)._lock=0,this._tTime=m,!h&&this.parent&&Le(this,"onRepeat"),this.vars.repeatRefresh&&!O&&(this.invalidate()._lock=1),c&&c!==this._time||S!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(f=this._dur,p=this._tDur,D&&(this._lock=2,c=R?f:-1e-4,this.render(c,!0),this.vars.repeatRefresh&&!O&&this.invalidate()),this._lock=0,!this._ts&&!S)return this;ja(this,O)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(C=Pd(this,de(c),de(x)),C&&(m-=x-(x=C._start))),this._tTime=m,this._time=x,this._act=!P,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=a,c=0),!c&&x&&!h&&(Le(this,"onStart"),this._tTime!==m))return this;if(x>=c&&a>=0)for(v=this._first;v;){if(E=v._next,(v._act||x>=v._start)&&v._ts&&C!==v){if(v.parent!==this)return this.render(a,h,u);if(v.render(v._ts>0?(x-v._start)*v._ts:(v._dirty?v.totalDuration():v._tDur)+(x-v._start)*v._ts,h,u),x!==this._time||!this._ts&&!S){C=0,E&&(m+=this._zTime=-X);break}}v=E}else{v=this._last;for(var U=a<0?a:x;v;){if(E=v._prev,(v._act||U<=v._end)&&v._ts&&C!==v){if(v.parent!==this)return this.render(a,h,u);if(v.render(v._ts>0?(U-v._start)*v._ts:(v._dirty?v.totalDuration():v._tDur)+(U-v._start)*v._ts,h,u),x!==this._time||!this._ts&&!S){C=0,E&&(m+=this._zTime=U?-X:X);break}}v=E}}if(C&&!h&&(this.pause(),C.render(x>=c?0:-X)._zTime=x>=c?1:-1,this._ts))return this._start=k,Un(this),this.render(a,h,u);this._onUpdate&&!h&&Le(this,"onUpdate",!0),(m===p&&this._tTime>=this.totalDuration()||!m&&c)&&(k===this._start||Math.abs(P)!==Math.abs(this._ts))&&(this._lock||((a||!f)&&(m===p&&this._ts>0||!m&&this._ts<0)&&et(this,1),!h&&!(a<0&&!c)&&(m||c||!p)&&(Le(this,m===p&&a>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(m<p&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(a,h){var u=this;if(it(h)||(h=Re(this,h,a)),!(a instanceof Zi)){if(me(a))return a.forEach(function(c){return u.add(c,h)}),this;if(he(a))return this.addLabel(a,h);if(le(a))a=ae.delayedCall(0,a);else return this}return this!==a?Ye(this,a,h):this},n.getChildren=function(a,h,u,c){a===void 0&&(a=!0),h===void 0&&(h=!0),u===void 0&&(u=!0),c===void 0&&(c=-De);for(var p=[],f=this._first;f;)f._start>=c&&(f instanceof ae?h&&p.push(f):(u&&p.push(f),a&&p.push.apply(p,f.getChildren(!0,h,u)))),f=f._next;return p},n.getById=function(a){for(var h=this.getChildren(1,1,1),u=h.length;u--;)if(h[u].vars.id===a)return h[u]},n.remove=function(a){return he(a)?this.removeLabel(a):le(a)?this.killTweensOf(a):(In(this,a),a===this._recent&&(this._recent=this._last),Vt(this))},n.totalTime=function(a,h){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=de(Se.time-(this._ts>0?a/this._ts:(this.totalDuration()-a)/-this._ts))),o.prototype.totalTime.call(this,a,h),this._forcing=0,this):this._tTime},n.addLabel=function(a,h){return this.labels[a]=Re(this,h),this},n.removeLabel=function(a){return delete this.labels[a],this},n.addPause=function(a,h,u){var c=ae.delayedCall(0,h||qi,u);return c.data="isPause",this._hasPause=1,Ye(this,c,Re(this,a))},n.removePause=function(a){var h=this._first;for(a=Re(this,a);h;)h._start===a&&h.data==="isPause"&&et(h),h=h._next},n.killTweensOf=function(a,h,u){for(var c=this.getTweensOf(a,u),p=c.length;p--;)pt!==c[p]&&c[p].kill(a,h);return this},n.getTweensOf=function(a,h){for(var u=[],c=Oe(a),p=this._first,f=it(h),m;p;)p instanceof ae?gd(p._targets,c)&&(f?(!pt||p._initted&&p._ts)&&p.globalTime(0)<=h&&p.globalTime(p.totalDuration())>h:!h||p.isActive())&&u.push(p):(m=p.getTweensOf(c,h)).length&&u.push.apply(u,m),p=p._next;return u},n.tweenTo=function(a,h){h=h||{};var u=this,c=Re(u,a),p=h,f=p.startAt,m=p.onStart,_=p.onStartParams,x=p.immediateRender,v,E=ae.to(u,Be({ease:h.ease||"none",lazy:!1,immediateRender:!1,time:c,overwrite:"auto",duration:h.duration||Math.abs((c-(f&&"time"in f?f.time:u._time))/u.timeScale())||X,onStart:function(){if(u.pause(),!v){var w=h.duration||Math.abs((c-(f&&"time"in f?f.time:u._time))/u.timeScale());E._dur!==w&&pi(E,w,0,1).render(E._time,!0,!0),v=1}m&&m.apply(E,_||[])}},h));return x?E.render(0):E},n.tweenFromTo=function(a,h,u){return this.tweenTo(h,Be({startAt:{time:Re(this,a)}},u))},n.recent=function(){return this._recent},n.nextLabel=function(a){return a===void 0&&(a=this._time),Ro(this,Re(this,a))},n.previousLabel=function(a){return a===void 0&&(a=this._time),Ro(this,Re(this,a),1)},n.currentLabel=function(a){return arguments.length?this.seek(a,!0):this.previousLabel(this._time+X)},n.shiftChildren=function(a,h,u){u===void 0&&(u=0);for(var c=this._first,p=this.labels,f;c;)c._start>=u&&(c._start+=a,c._end+=a),c=c._next;if(h)for(f in p)p[f]>=u&&(p[f]+=a);return Vt(this)},n.invalidate=function(){var a=this._first;for(this._lock=0;a;)a.invalidate(),a=a._next;return o.prototype.invalidate.call(this)},n.clear=function(a){a===void 0&&(a=!0);for(var h=this._first,u;h;)u=h._next,this.remove(h),h=u;return this._dp&&(this._time=this._tTime=this._pTime=0),a&&(this.labels={}),Vt(this)},n.totalDuration=function(a){var h=0,u=this,c=u._last,p=De,f,m,_;if(arguments.length)return u.timeScale((u._repeat<0?u.duration():u.totalDuration())/(u.reversed()?-a:a));if(u._dirty){for(_=u.parent;c;)f=c._prev,c._dirty&&c.totalDuration(),m=c._start,m>p&&u._sort&&c._ts&&!u._lock?(u._lock=1,Ye(u,c,m-c._delay,1)._lock=0):p=m,m<0&&c._ts&&(h-=m,(!_&&!u._dp||_&&_.smoothChildTiming)&&(u._start+=m/u._ts,u._time-=m,u._tTime-=m),u.shiftChildren(-m,!1,-1/0),p=0),c._end>h&&c._ts&&(h=c._end),c=f;pi(u,u===ie&&u._time>h?u._time:h,1,1),u._dirty=0}return u._tDur},t.updateRoot=function(a){if(ie._ts&&(Sa(ie,Rn(a,ie)),Ca=Se.frame),Se.frame>=To){To+=Te.autoSleep||120;var h=ie._first;if((!h||!h._ts)&&Te.autoSleep&&Se._listeners.length<2){for(;h&&!h._ts;)h=h._next;h||Se.sleep()}}},t})(Zi);Be(xe.prototype,{_lock:0,_hasPause:0,_forcing:0});var Gd=function(t,n,s,a,h,u,c){var p=new Ee(this._pt,t,n,0,1,Qa,null,h),f=0,m=0,_,x,v,E,g,w,S,C;for(p.b=s,p.e=a,s+="",a+="",(S=~a.indexOf("random("))&&(a=$i(a)),u&&(C=[s,a],u(C,t,n),s=C[0],a=C[1]),x=s.match(xr)||[];_=xr.exec(a);)E=_[0],g=a.substring(f,_.index),v?v=(v+1)%5:g.substr(-5)==="rgba("&&(v=1),E!==x[m++]&&(w=parseFloat(x[m-1])||0,p._pt={_next:p._pt,p:g||m===1?g:",",s:w,c:E.charAt(1)==="="?li(w,E)-w:parseFloat(E)-w,m:v&&v<4?Math.round:0},f=xr.lastIndex);return p.c=f<a.length?a.substring(f,a.length):"",p.fp=c,(ba.test(a)||S)&&(p.e=0),this._pt=p,p},cs=function(t,n,s,a,h,u,c,p,f){le(a)&&(a=a(h||0,t,u));var m=t[n],_=s!=="get"?s:le(m)?f?t[n.indexOf("set")||!le(t["get"+n.substr(3)])?n:"get"+n.substr(3)](f):t[n]():m,x=le(m)?f?qd:Xa:ps,v;if(he(a)&&(~a.indexOf("random(")&&(a=$i(a)),a.charAt(1)==="="&&(v=li(_,a)+(fe(_)||0),(v||v===0)&&(a=v))),_!==a||$r)return!isNaN(_*a)&&a!==""?(v=new Ee(this._pt,t,n,+_||0,a-(_||0),typeof m=="boolean"?Xd:Za,0,x),f&&(v.fp=f),c&&v.modifier(c,this,t),this._pt=v):(!m&&!(n in t)&&os(n,a),Gd.call(this,t,n,_,a,x,p||Te.stringFilter,f))},jd=function(t,n,s,a,h){if(le(t)&&(t=Yi(t,h,n,s,a)),!nt(t)||t.style&&t.nodeType||me(t)||_a(t))return he(t)?Yi(t,h,n,s,a):t;var u={},c;for(c in t)u[c]=Yi(t[c],h,n,s,a);return u},Wa=function(t,n,s,a,h,u){var c,p,f,m;if(Pe[t]&&(c=new Pe[t]).init(h,c.rawVars?n[t]:jd(n[t],a,h,u,s),s,a,u)!==!1&&(s._pt=p=new Ee(s._pt,h,t,0,1,c.render,c,0,c.priority),s!==oi))for(f=s._ptLookup[s._targets.indexOf(h)],m=c._props.length;m--;)f[c._props[m]]=p;return c},pt,$r,ds=function o(t,n){var s=t.vars,a=s.ease,h=s.startAt,u=s.immediateRender,c=s.lazy,p=s.onUpdate,f=s.onUpdateParams,m=s.callbackScope,_=s.runBackwards,x=s.yoyoEase,v=s.keyframes,E=s.autoRevert,g=t._dur,w=t._startAt,S=t._targets,C=t.parent,P=C&&C.data==="nested"?C.parent._targets:S,k=t._overwrite==="auto"&&!ns,T=t.timeline,M,O,R,D,U,Z,ne,re,Q,N,L,ce,qe;if(T&&(!v||!a)&&(a="none"),t._ease=Nt(a,ci.ease),t._yEase=x?Ga(Nt(x===!0?a:x,ci.ease)):0,x&&t._yoyo&&!t._repeat&&(x=t._yEase,t._yEase=t._ease,t._ease=x),t._from=!T&&!!s.runBackwards,!T||v&&!s.stagger){if(re=S[0]?Ut(S[0]).harness:0,ce=re&&s[re.prop],M=An(s,as),w&&(et(w.render(-1,!0)),w._lazy=0),h)if(et(t._startAt=ae.set(S,Be({data:"isStart",overwrite:!1,parent:C,immediateRender:!0,lazy:we(c),startAt:null,delay:0,onUpdate:p,onUpdateParams:f,callbackScope:m,stagger:0},h))),n<0&&!u&&!E&&t._startAt.render(-1,!0),u){if(n>0&&!E&&(t._startAt=0),g&&n<=0){n&&(t._zTime=n);return}}else E===!1&&(t._startAt=0);else if(_&&g){if(w)!E&&(t._startAt=0);else if(n&&(u=!1),R=Be({overwrite:!1,data:"isFromStart",lazy:u&&we(c),immediateRender:u,stagger:0,parent:C},M),ce&&(R[re.prop]=ce),et(t._startAt=ae.set(S,R)),n<0&&t._startAt.render(-1,!0),t._zTime=n,!u)o(t._startAt,X);else if(!n)return}for(t._pt=t._ptCache=0,c=g&&we(c)||c&&!g,O=0;O<S.length;O++){if(U=S[O],ne=U._gsap||hs(S)[O]._gsap,t._ptLookup[O]=N={},Kr[ne.id]&&_t.length&&kn(),L=P===S?O:P.indexOf(U),re&&(Q=new re).init(U,ce||M,t,L,P)!==!1&&(t._pt=D=new Ee(t._pt,U,Q.name,0,1,Q.render,Q,0,Q.priority),Q._props.forEach(function($e){N[$e]=D}),Q.priority&&(Z=1)),!re||ce)for(R in M)Pe[R]&&(Q=Wa(R,M,t,L,U,P))?Q.priority&&(Z=1):N[R]=D=cs.call(t,U,R,"get",M[R],L,P,0,s.stringFilter);t._op&&t._op[O]&&t.kill(U,t._op[O]),k&&t._pt&&(pt=t,ie.killTweensOf(U,N,t.globalTime(n)),qe=!t.parent,pt=0),t._pt&&c&&(Kr[ne.id]=1)}Z&&Ja(t),t._onInit&&t._onInit(t)}t._onUpdate=p,t._initted=(!t._op||t._pt)&&!qe,v&&n<=0&&T.render(De,!0,!0)},Kd=function(t,n,s,a,h,u,c){var p=(t._pt&&t._ptCache||(t._ptCache={}))[n],f,m,_;if(!p)for(p=t._ptCache[n]=[],m=t._ptLookup,_=t._targets.length;_--;){if(f=m[_][n],f&&f.d&&f.d._pt)for(f=f.d._pt;f&&f.p!==n;)f=f._next;if(!f)return $r=1,t.vars[n]="+=0",ds(t,c),$r=0,1;p.push(f)}for(_=p.length;_--;)f=p[_],f.s=(a||a===0)&&!h?a:f.s+(a||0)+u*f.c,f.c=s-f.s,f.e&&(f.e=se(s)+fe(f.e)),f.b&&(f.b=f.s+fe(f.b))},Yd=function(t,n){var s=t[0]?Ut(t[0]).harness:0,a=s&&s.aliases,h,u,c,p;if(!a)return n;h=Gt({},n);for(u in a)if(u in h)for(p=a[u].split(","),c=p.length;c--;)h[p[c]]=h[u];return h},Wd=function(t,n,s,a){var h=n.ease||a||"power1.inOut",u,c;if(me(n))c=s[t]||(s[t]=[]),n.forEach(function(p,f){return c.push({t:f/(n.length-1)*100,v:p,e:h})});else for(u in n)c=s[u]||(s[u]=[]),u==="ease"||c.push({t:parseFloat(t),v:n[u],e:h})},Yi=function(t,n,s,a,h){return le(t)?t.call(n,s,a,h):he(t)&&~t.indexOf("random(")?$i(t):t},qa=ls+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",$a={};ye(qa+",id,stagger,delay,duration,paused,scrollTrigger",function(o){return $a[o]=1});var ae=(function(o){fa(t,o);function t(s,a,h,u){var c;typeof a=="number"&&(h.duration=a,a=h,h=null),c=o.call(this,u?a:ji(a))||this;var p=c.vars,f=p.duration,m=p.delay,_=p.immediateRender,x=p.stagger,v=p.overwrite,E=p.keyframes,g=p.defaults,w=p.scrollTrigger,S=p.yoyoEase,C=a.parent||ie,P=(me(s)||_a(s)?it(s[0]):"length"in a)?[s]:Oe(s),k,T,M,O,R,D,U,Z;if(c._targets=P.length?hs(P):Mn("GSAP target "+s+" not found. https://greensock.com",!Te.nullTargetWarn)||[],c._ptLookup=[],c._overwrite=v,E||x||xn(f)||xn(m)){if(a=c.vars,k=c.timeline=new xe({data:"nested",defaults:g||{}}),k.kill(),k.parent=k._dp=Je(c),k._start=0,x||xn(f)||xn(m)){if(O=P.length,U=x&&Ba(x),nt(x))for(R in x)~qa.indexOf(R)&&(Z||(Z={}),Z[R]=x[R]);for(T=0;T<O;T++)M=An(a,$a),M.stagger=0,S&&(M.yoyoEase=S),Z&&Gt(M,Z),D=P[T],M.duration=+Yi(f,Je(c),T,D,P),M.delay=(+Yi(m,Je(c),T,D,P)||0)-c._delay,!x&&O===1&&M.delay&&(c._delay=m=M.delay,c._start+=m,M.delay=0),k.to(D,M,U?U(T,D,P):0),k._ease=F.none;k.duration()?f=m=0:c.timeline=0}else if(E){ji(Be(k.vars.defaults,{ease:"none"})),k._ease=Nt(E.ease||a.ease||"none");var ne=0,re,Q,N;if(me(E))E.forEach(function(L){return k.to(P,L,">")});else{M={};for(R in E)R==="ease"||R==="easeEach"||Wd(R,E[R],M,E.easeEach);for(R in M)for(re=M[R].sort(function(L,ce){return L.t-ce.t}),ne=0,T=0;T<re.length;T++)Q=re[T],N={ease:Q.e,duration:(Q.t-(T?re[T-1].t:0))/100*f},N[R]=Q.v,k.to(P,N,ne),ne+=N.duration;k.duration()<f&&k.to({},{duration:f-k.duration()})}}f||c.duration(f=k.duration())}else c.timeline=0;return v===!0&&!ns&&(pt=Je(c),ie.killTweensOf(P),pt=0),Ye(C,Je(c),h),a.reversed&&c.reverse(),a.paused&&c.paused(!0),(_||!f&&!E&&c._start===de(C._time)&&we(_)&&yd(Je(c))&&C.data!=="nested")&&(c._tTime=-X,c.render(Math.max(0,-m))),w&&Ra(Je(c),w),c}var n=t.prototype;return n.render=function(a,h,u){var c=this._time,p=this._tDur,f=this._dur,m=a>p-X&&a>=0?p:a<X?0:a,_,x,v,E,g,w,S,C,P;if(!f)Cd(this,a,h,u);else if(m!==this._tTime||!a||u||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=a<0){if(_=m,C=this.timeline,this._repeat){if(E=f+this._rDelay,this._repeat<-1&&a<0)return this.totalTime(E*100+a,h,u);if(_=de(m%E),m===p?(v=this._repeat,_=f):(v=~~(m/E),v&&v===m/E&&(_=f,v--),_>f&&(_=f)),w=this._yoyo&&v&1,w&&(P=this._yEase,_=f-_),g=di(this._tTime,E),_===c&&!u&&this._initted)return this._tTime=m,this;v!==g&&(C&&this._yEase&&ja(C,w),this.vars.repeatRefresh&&!w&&!this._lock&&(this._lock=u=1,this.render(de(E*v),!0).invalidate()._lock=0))}if(!this._initted){if(Da(this,a<0?a:_,u,h))return this._tTime=0,this;if(c!==this._time)return this;if(f!==this._dur)return this.render(a,h,u)}if(this._tTime=m,this._time=_,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=S=(P||this._ease)(_/f),this._from&&(this.ratio=S=1-S),_&&!c&&!h&&(Le(this,"onStart"),this._tTime!==m))return this;for(x=this._pt;x;)x.r(S,x.d),x=x._next;C&&C.render(a<0?a:!_&&w?-X:C._dur*C._ease(_/this._dur),h,u)||this._startAt&&(this._zTime=a),this._onUpdate&&!h&&(a<0&&this._startAt&&this._startAt.render(a,!0,u),Le(this,"onUpdate")),this._repeat&&v!==g&&this.vars.onRepeat&&!h&&this.parent&&Le(this,"onRepeat"),(m===this._tDur||!m)&&this._tTime===m&&(a<0&&this._startAt&&!this._onUpdate&&this._startAt.render(a,!0,!0),(a||!f)&&(m===this._tDur&&this._ts>0||!m&&this._ts<0)&&et(this,1),!h&&!(a<0&&!c)&&(m||c)&&(Le(this,m===p?"onComplete":"onReverseComplete",!0),this._prom&&!(m<p&&this.timeScale()>0)&&this._prom()))}return this},n.targets=function(){return this._targets},n.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),o.prototype.invalidate.call(this)},n.resetTo=function(a,h,u,c){Xi||Se.wake(),this._ts||this.play();var p=Math.min(this._dur,(this._dp._time-this._start)*this._ts),f;return this._initted||ds(this,p),f=this._ease(p/this._dur),Kd(this,a,h,u,c,f,p)?this.resetTo(a,h,u,c):(us(this,0),this.parent||ka(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},n.kill=function(a,h){if(h===void 0&&(h="all"),!a&&(!h||h==="all"))return this._lazy=this._pt=0,this.parent?Fi(this):this;if(this.timeline){var u=this.timeline.totalDuration();return this.timeline.killTweensOf(a,h,pt&&pt.vars.overwrite!==!0)._first||Fi(this),this.parent&&u!==this.timeline.totalDuration()&&pi(this,this._dur*this.timeline._tDur/u,0,1),this}var c=this._targets,p=a?Oe(a):c,f=this._ptLookup,m=this._pt,_,x,v,E,g,w,S;if((!h||h==="all")&&xd(c,p))return h==="all"&&(this._pt=0),Fi(this);for(_=this._op=this._op||[],h!=="all"&&(he(h)&&(g={},ye(h,function(C){return g[C]=1}),h=g),h=Yd(c,h)),S=c.length;S--;)if(~p.indexOf(c[S])){x=f[S],h==="all"?(_[S]=h,E=x,v={}):(v=_[S]=_[S]||{},E=h);for(g in E)w=x&&x[g],w&&((!("kill"in w.d)||w.d.kill(g)===!0)&&In(this,w,"_pt"),delete x[g]),v!=="all"&&(v[g]=1)}return this._initted&&!this._pt&&m&&Fi(this),this},t.to=function(a,h){return new t(a,h,arguments[2])},t.from=function(a,h){return Ki(1,arguments)},t.delayedCall=function(a,h,u,c){return new t(h,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:a,onComplete:h,onReverseComplete:h,onCompleteParams:u,onReverseCompleteParams:u,callbackScope:c})},t.fromTo=function(a,h,u){return Ki(2,arguments)},t.set=function(a,h){return h.duration=0,h.repeatDelay||(h.repeat=0),new t(a,h)},t.killTweensOf=function(a,h,u){return ie.killTweensOf(a,h,u)},t})(Zi);Be(ae.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});ye("staggerTo,staggerFrom,staggerFromTo",function(o){ae[o]=function(){var t=new xe,n=Wr.call(arguments,0);return n.splice(o==="staggerFromTo"?5:4,0,0),t[o].apply(t,n)}});var ps=function(t,n,s){return t[n]=s},Xa=function(t,n,s){return t[n](s)},qd=function(t,n,s,a){return t[n](a.fp,s)},$d=function(t,n,s){return t.setAttribute(n,s)},fs=function(t,n){return le(t[n])?Xa:rs(t[n])&&t.setAttribute?$d:ps},Za=function(t,n){return n.set(n.t,n.p,Math.round((n.s+n.c*t)*1e6)/1e6,n)},Xd=function(t,n){return n.set(n.t,n.p,!!(n.s+n.c*t),n)},Qa=function(t,n){var s=n._pt,a="";if(!t&&n.b)a=n.b;else if(t===1&&n.e)a=n.e;else{for(;s;)a=s.p+(s.m?s.m(s.s+s.c*t):Math.round((s.s+s.c*t)*1e4)/1e4)+a,s=s._next;a+=n.c}n.set(n.t,n.p,a,n)},ms=function(t,n){for(var s=n._pt;s;)s.r(t,s.d),s=s._next},Zd=function(t,n,s,a){for(var h=this._pt,u;h;)u=h._next,h.p===a&&h.modifier(t,n,s),h=u},Qd=function(t){for(var n=this._pt,s,a;n;)a=n._next,n.p===t&&!n.op||n.op===t?In(this,n,"_pt"):n.dep||(s=1),n=a;return!s},Jd=function(t,n,s,a){a.mSet(t,n,a.m.call(a.tween,s,a.mt),a)},Ja=function(t){for(var n=t._pt,s,a,h,u;n;){for(s=n._next,a=h;a&&a.pr>n.pr;)a=a._next;(n._prev=a?a._prev:u)?n._prev._next=n:h=n,(n._next=a)?a._prev=n:u=n,n=s}t._pt=h},Ee=(function(){function o(n,s,a,h,u,c,p,f,m){this.t=s,this.s=h,this.c=u,this.p=a,this.r=c||Za,this.d=p||this,this.set=f||ps,this.pr=m||0,this._next=n,n&&(n._prev=this)}var t=o.prototype;return t.modifier=function(s,a,h){this.mSet=this.mSet||this.set,this.set=Jd,this.m=s,this.mt=h,this.tween=a},o})();ye(ls+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(o){return as[o]=1});Me.TweenMax=Me.TweenLite=ae;Me.TimelineLite=Me.TimelineMax=xe;ie=new xe({sortChildren:!1,defaults:ci,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Te.stringFilter=Ha;var Dn={registerPlugin:function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];n.forEach(function(a){return Id(a)})},timeline:function(t){return new xe(t)},getTweensOf:function(t,n){return ie.getTweensOf(t,n)},getProperty:function(t,n,s,a){he(t)&&(t=Oe(t)[0]);var h=Ut(t||{}).get,u=s?Ma:Ta;return s==="native"&&(s=""),t&&(n?u((Pe[n]&&Pe[n].get||h)(t,n,s,a)):function(c,p,f){return u((Pe[c]&&Pe[c].get||h)(t,c,p,f))})},quickSetter:function(t,n,s){if(t=Oe(t),t.length>1){var a=t.map(function(m){return Ve.quickSetter(m,n,s)}),h=a.length;return function(m){for(var _=h;_--;)a[_](m)}}t=t[0]||{};var u=Pe[n],c=Ut(t),p=c.harness&&(c.harness.aliases||{})[n]||n,f=u?function(m){var _=new u;oi._pt=0,_.init(t,s?m+s:m,oi,0,[t]),_.render(1,_),oi._pt&&ms(1,oi)}:c.set(t,p);return u?f:function(m){return f(t,p,s?m+s:m,c,1)}},quickTo:function(t,n,s){var a,h=Ve.to(t,Gt((a={},a[n]="+=0.1",a.paused=!0,a),s||{})),u=function(p,f,m){return h.resetTo(n,p,f,m)};return u.tween=h,u},isTweening:function(t){return ie.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=Nt(t.ease,ci.ease)),Mo(ci,t||{})},config:function(t){return Mo(Te,t||{})},registerEffect:function(t){var n=t.name,s=t.effect,a=t.plugins,h=t.defaults,u=t.extendTimeline;(a||"").split(",").forEach(function(c){return c&&!Pe[c]&&!Me[c]&&Mn(n+" effect requires "+c+" plugin.")}),wr[n]=function(c,p,f){return s(Oe(c),Be(p||{},h),f)},u&&(xe.prototype[n]=function(c,p,f){return this.add(wr[n](c,nt(p)?p:(f=p)&&{},this),f)})},registerEase:function(t,n){F[t]=Nt(n)},parseEase:function(t,n){return arguments.length?Nt(t,n):F},getById:function(t){return ie.getById(t)},exportRoot:function(t,n){t===void 0&&(t={});var s=new xe(t),a,h;for(s.smoothChildTiming=we(t.smoothChildTiming),ie.remove(s),s._dp=0,s._time=s._tTime=ie._time,a=ie._first;a;)h=a._next,(n||!(!a._dur&&a instanceof ae&&a.vars.onComplete===a._targets[0]))&&Ye(s,a,a._start-a._delay),a=h;return Ye(ie,s,0),s},utils:{wrap:Od,wrapYoyo:Ld,distribute:Ba,random:Ua,snap:Ia,normalize:Dd,getUnit:fe,clamp:Td,splitColor:za,toArray:Oe,selector:kd,mapRange:Na,pipe:Ad,unitize:Rd,interpolate:Bd,shuffle:La},install:ya,effects:wr,ticker:Se,updateRoot:xe.updateRoot,plugins:Pe,globalTimeline:ie,core:{PropTween:Ee,globals:Ea,Tween:ae,Timeline:xe,Animation:Zi,getCache:Ut,_removeLinkedListItem:In,suppressOverwrites:function(t){return ns=t}}};ye("to,from,fromTo,delayedCall,set,killTweensOf",function(o){return Dn[o]=ae[o]});Se.add(xe.updateRoot);oi=Dn.to({},{duration:0});var ep=function(t,n){for(var s=t._pt;s&&s.p!==n&&s.op!==n&&s.fp!==n;)s=s._next;return s},tp=function(t,n){var s=t._targets,a,h,u;for(a in n)for(h=s.length;h--;)u=t._ptLookup[h][a],u&&(u=u.d)&&(u._pt&&(u=ep(u,a)),u&&u.modifier&&u.modifier(n[a],t,s[h],a))},Pr=function(t,n){return{name:t,rawVars:1,init:function(a,h,u){u._onInit=function(c){var p,f;if(he(h)&&(p={},ye(h,function(m){return p[m]=1}),h=p),n){p={};for(f in h)p[f]=n(h[f]);h=p}tp(c,h)}}}},Ve=Dn.registerPlugin({name:"attr",init:function(t,n,s,a,h){var u,c;for(u in n)c=this.add(t,"setAttribute",(t.getAttribute(u)||0)+"",n[u],a,h,0,0,u),c&&(c.op=u),this._props.push(u)}},{name:"endArray",init:function(t,n){for(var s=n.length;s--;)this.add(t,s,t[s]||0,n[s])}},Pr("roundProps",qr),Pr("modifiers"),Pr("snap",Ia))||Dn;ae.version=xe.version=Ve.version="3.10.4";wa=1;va()&&fi();F.Power0;F.Power1;F.Power2;F.Power3;F.Power4;F.Linear;F.Quad;F.Cubic;F.Quart;F.Quint;F.Strong;F.Elastic;F.Back;F.SteppedEase;F.Bounce;F.Sine;F.Expo;F.Circ;var Oo,ft,hi,vs,It,Lo,ip=function(){return typeof window<"u"},bt={},Ot=180/Math.PI,ui=Math.PI/180,ii=Math.atan2,Bo=1e8,el=/([A-Z])/g,np=/(left|right|width|margin|padding|x)/i,rp=/[\s,\(]\S/,mt={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},tl=function(t,n){return n.set(n.t,n.p,Math.round((n.s+n.c*t)*1e4)/1e4+n.u,n)},sp=function(t,n){return n.set(n.t,n.p,t===1?n.e:Math.round((n.s+n.c*t)*1e4)/1e4+n.u,n)},op=function(t,n){return n.set(n.t,n.p,t?Math.round((n.s+n.c*t)*1e4)/1e4+n.u:n.b,n)},ap=function(t,n){var s=n.s+n.c*t;n.set(n.t,n.p,~~(s+(s<0?-.5:.5))+n.u,n)},il=function(t,n){return n.set(n.t,n.p,t?n.e:n.b,n)},nl=function(t,n){return n.set(n.t,n.p,t!==1?n.b:n.e,n)},lp=function(t,n,s){return t.style[n]=s},hp=function(t,n,s){return t.style.setProperty(n,s)},up=function(t,n,s){return t._gsap[n]=s},cp=function(t,n,s){return t._gsap.scaleX=t._gsap.scaleY=s},dp=function(t,n,s,a,h){var u=t._gsap;u.scaleX=u.scaleY=s,u.renderTransform(h,u)},pp=function(t,n,s,a,h){var u=t._gsap;u[n]=s,u.renderTransform(h,u)},ue="transform",xt=ue+"Origin",rl,Xr=function(t,n){var s=ft.createElementNS?ft.createElementNS((n||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):ft.createElement(t);return s.style?s:ft.createElement(t)},tt=function o(t,n,s){var a=getComputedStyle(t);return a[n]||a.getPropertyValue(n.replace(el,"-$1").toLowerCase())||a.getPropertyValue(n)||!s&&o(t,mi(n)||n,1)||""},Io="O,Moz,ms,Ms,Webkit".split(","),mi=function(t,n,s){var a=n||It,h=a.style,u=5;if(t in h&&!s)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);u--&&!(Io[u]+t in h););return u<0?null:(u===3?"ms":u>=0?Io[u]:"")+t},Zr=function(){ip()&&window.document&&(Oo=window,ft=Oo.document,hi=ft.documentElement,It=Xr("div")||{style:{}},Xr("div"),ue=mi(ue),xt=ue+"Origin",It.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",rl=!!mi("perspective"),vs=1)},Sr=function o(t){var n=Xr("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=this.parentNode,a=this.nextSibling,h=this.style.cssText,u;if(hi.appendChild(n),n.appendChild(this),this.style.display="block",t)try{u=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=o}catch{}else this._gsapBBox&&(u=this._gsapBBox());return s&&(a?s.insertBefore(this,a):s.appendChild(this)),hi.removeChild(n),this.style.cssText=h,u},Uo=function(t,n){for(var s=n.length;s--;)if(t.hasAttribute(n[s]))return t.getAttribute(n[s])},sl=function(t){var n;try{n=t.getBBox()}catch{n=Sr.call(t,!0)}return n&&(n.width||n.height)||t.getBBox===Sr||(n=Sr.call(t,!0)),n&&!n.width&&!n.x&&!n.y?{x:+Uo(t,["x","cx","x1"])||0,y:+Uo(t,["y","cy","y1"])||0,width:0,height:0}:n},ol=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&sl(t))},Qi=function(t,n){if(n){var s=t.style;n in bt&&n!==xt&&(n=ue),s.removeProperty?((n.substr(0,2)==="ms"||n.substr(0,6)==="webkit")&&(n="-"+n),s.removeProperty(n.replace(el,"-$1").toLowerCase())):s.removeAttribute(n)}},vt=function(t,n,s,a,h,u){var c=new Ee(t._pt,n,s,0,1,u?nl:il);return t._pt=c,c.b=a,c.e=h,t._props.push(s),c},Vo={deg:1,rad:1,turn:1},wt=function o(t,n,s,a){var h=parseFloat(s)||0,u=(s+"").trim().substr((h+"").length)||"px",c=It.style,p=np.test(n),f=t.tagName.toLowerCase()==="svg",m=(f?"client":"offset")+(p?"Width":"Height"),_=100,x=a==="px",v=a==="%",E,g,w,S;return a===u||!h||Vo[a]||Vo[u]?h:(u!=="px"&&!x&&(h=o(t,n,s,"px")),S=t.getCTM&&ol(t),(v||u==="%")&&(bt[n]||~n.indexOf("adius"))?(E=S?t.getBBox()[p?"width":"height"]:t[m],se(v?h/E*_:h/100*E)):(c[p?"width":"height"]=_+(x?u:a),g=~n.indexOf("adius")||a==="em"&&t.appendChild&&!f?t:t.parentNode,S&&(g=(t.ownerSVGElement||{}).parentNode),(!g||g===ft||!g.appendChild)&&(g=ft.body),w=g._gsap,w&&v&&w.width&&p&&w.time===Se.time?se(h/w.width*_):((v||u==="%")&&(c.position=tt(t,"position")),g===t&&(c.position="static"),g.appendChild(It),E=It[m],g.removeChild(It),c.position="absolute",p&&v&&(w=Ut(g),w.time=Se.time,w.width=g[m]),se(x?E*h/_:E&&h?_/E*h:0))))},Lt=function(t,n,s,a){var h;return vs||Zr(),n in mt&&n!=="transform"&&(n=mt[n],~n.indexOf(",")&&(n=n.split(",")[0])),bt[n]&&n!=="transform"?(h=en(t,a),h=n!=="transformOrigin"?h[n]:h.svg?h.origin:Ln(tt(t,xt))+" "+h.zOrigin+"px"):(h=t.style[n],(!h||h==="auto"||a||~(h+"").indexOf("calc("))&&(h=On[n]&&On[n](t,n,s)||tt(t,n)||Pa(t,n)||(n==="opacity"?1:0))),s&&!~(h+"").trim().indexOf(" ")?wt(t,n,h,s)+s:h},fp=function(t,n,s,a){if(!s||s==="none"){var h=mi(n,t,1),u=h&&tt(t,h,1);u&&u!==s?(n=h,s=u):n==="borderColor"&&(s=tt(t,"borderTopColor"))}var c=new Ee(this._pt,t.style,n,0,1,Qa),p=0,f=0,m,_,x,v,E,g,w,S,C,P,k,T;if(c.b=s,c.e=a,s+="",a+="",a==="auto"&&(t.style[n]=a,a=tt(t,n)||a,t.style[n]=s),m=[s,a],Ha(m),s=m[0],a=m[1],x=s.match(si)||[],T=a.match(si)||[],T.length){for(;_=si.exec(a);)w=_[0],C=a.substring(p,_.index),E?E=(E+1)%5:(C.substr(-5)==="rgba("||C.substr(-5)==="hsla(")&&(E=1),w!==(g=x[f++]||"")&&(v=parseFloat(g)||0,k=g.substr((v+"").length),w.charAt(1)==="="&&(w=li(v,w)+k),S=parseFloat(w),P=w.substr((S+"").length),p=si.lastIndex-P.length,P||(P=P||Te.units[n]||k,p===a.length&&(a+=P,c.e+=P)),k!==P&&(v=wt(t,n,g,P)||0),c._pt={_next:c._pt,p:C||f===1?C:",",s:v,c:S-v,m:E&&E<4||n==="zIndex"?Math.round:0});c.c=p<a.length?a.substring(p,a.length):""}else c.r=n==="display"&&a==="none"?nl:il;return ba.test(a)&&(c.e=0),this._pt=c,c},No={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},mp=function(t){var n=t.split(" "),s=n[0],a=n[1]||"50%";return(s==="top"||s==="bottom"||a==="left"||a==="right")&&(t=s,s=a,a=t),n[0]=No[s]||s,n[1]=No[a]||a,n.join(" ")},vp=function(t,n){if(n.tween&&n.tween._time===n.tween._dur){var s=n.t,a=s.style,h=n.u,u=s._gsap,c,p,f;if(h==="all"||h===!0)a.cssText="",p=1;else for(h=h.split(","),f=h.length;--f>-1;)c=h[f],bt[c]&&(p=1,c=c==="transformOrigin"?xt:ue),Qi(s,c);p&&(Qi(s,ue),u&&(u.svg&&s.removeAttribute("transform"),en(s,1),u.uncache=1))}},On={clearProps:function(t,n,s,a,h){if(h.data!=="isFromStart"){var u=t._pt=new Ee(t._pt,n,s,0,0,vp);return u.u=a,u.pr=-10,u.tween=h,t._props.push(s),1}}},Ji=[1,0,0,1,0,0],al={},ll=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},zo=function(t){var n=tt(t,ue);return ll(n)?Ji:n.substr(7).match(ga).map(se)},_s=function(t,n){var s=t._gsap||Ut(t),a=t.style,h=zo(t),u,c,p,f;return s.svg&&t.getAttribute("transform")?(p=t.transform.baseVal.consolidate().matrix,h=[p.a,p.b,p.c,p.d,p.e,p.f],h.join(",")==="1,0,0,1,0,0"?Ji:h):(h===Ji&&!t.offsetParent&&t!==hi&&!s.svg&&(p=a.display,a.display="block",u=t.parentNode,(!u||!t.offsetParent)&&(f=1,c=t.nextSibling,hi.appendChild(t)),h=zo(t),p?a.display=p:Qi(t,"display"),f&&(c?u.insertBefore(t,c):u?u.appendChild(t):hi.removeChild(t))),n&&h.length>6?[h[0],h[1],h[4],h[5],h[12],h[13]]:h)},Qr=function(t,n,s,a,h,u){var c=t._gsap,p=h||_s(t,!0),f=c.xOrigin||0,m=c.yOrigin||0,_=c.xOffset||0,x=c.yOffset||0,v=p[0],E=p[1],g=p[2],w=p[3],S=p[4],C=p[5],P=n.split(" "),k=parseFloat(P[0])||0,T=parseFloat(P[1])||0,M,O,R,D;s?p!==Ji&&(O=v*w-E*g)&&(R=k*(w/O)+T*(-g/O)+(g*C-w*S)/O,D=k*(-E/O)+T*(v/O)-(v*C-E*S)/O,k=R,T=D):(M=sl(t),k=M.x+(~P[0].indexOf("%")?k/100*M.width:k),T=M.y+(~(P[1]||P[0]).indexOf("%")?T/100*M.height:T)),a||a!==!1&&c.smooth?(S=k-f,C=T-m,c.xOffset=_+(S*v+C*g)-S,c.yOffset=x+(S*E+C*w)-C):c.xOffset=c.yOffset=0,c.xOrigin=k,c.yOrigin=T,c.smooth=!!a,c.origin=n,c.originIsAbsolute=!!s,t.style[xt]="0px 0px",u&&(vt(u,c,"xOrigin",f,k),vt(u,c,"yOrigin",m,T),vt(u,c,"xOffset",_,c.xOffset),vt(u,c,"yOffset",x,c.yOffset)),t.setAttribute("data-svg-origin",k+" "+T)},en=function(t,n){var s=t._gsap||new Ya(t);if("x"in s&&!n&&!s.uncache)return s;var a=t.style,h=s.scaleX<0,u="px",c="deg",p=tt(t,xt)||"0",f,m,_,x,v,E,g,w,S,C,P,k,T,M,O,R,D,U,Z,ne,re,Q,N,L,ce,qe,$e,ve,ze,W,q,Xe;return f=m=_=E=g=w=S=C=P=0,x=v=1,s.svg=!!(t.getCTM&&ol(t)),M=_s(t,s.svg),s.svg&&(L=(!s.uncache||p==="0px 0px")&&!n&&t.getAttribute("data-svg-origin"),Qr(t,L||p,!!L||s.originIsAbsolute,s.smooth!==!1,M)),k=s.xOrigin||0,T=s.yOrigin||0,M!==Ji&&(U=M[0],Z=M[1],ne=M[2],re=M[3],f=Q=M[4],m=N=M[5],M.length===6?(x=Math.sqrt(U*U+Z*Z),v=Math.sqrt(re*re+ne*ne),E=U||Z?ii(Z,U)*Ot:0,S=ne||re?ii(ne,re)*Ot+E:0,S&&(v*=Math.abs(Math.cos(S*ui))),s.svg&&(f-=k-(k*U+T*ne),m-=T-(k*Z+T*re))):(Xe=M[6],W=M[7],$e=M[8],ve=M[9],ze=M[10],q=M[11],f=M[12],m=M[13],_=M[14],O=ii(Xe,ze),g=O*Ot,O&&(R=Math.cos(-O),D=Math.sin(-O),L=Q*R+$e*D,ce=N*R+ve*D,qe=Xe*R+ze*D,$e=Q*-D+$e*R,ve=N*-D+ve*R,ze=Xe*-D+ze*R,q=W*-D+q*R,Q=L,N=ce,Xe=qe),O=ii(-ne,ze),w=O*Ot,O&&(R=Math.cos(-O),D=Math.sin(-O),L=U*R-$e*D,ce=Z*R-ve*D,qe=ne*R-ze*D,q=re*D+q*R,U=L,Z=ce,ne=qe),O=ii(Z,U),E=O*Ot,O&&(R=Math.cos(O),D=Math.sin(O),L=U*R+Z*D,ce=Q*R+N*D,Z=Z*R-U*D,N=N*R-Q*D,U=L,Q=ce),g&&Math.abs(g)+Math.abs(E)>359.9&&(g=E=0,w=180-w),x=se(Math.sqrt(U*U+Z*Z+ne*ne)),v=se(Math.sqrt(N*N+Xe*Xe)),O=ii(Q,N),S=Math.abs(O)>2e-4?O*Ot:0,P=q?1/(q<0?-q:q):0),s.svg&&(L=t.getAttribute("transform"),s.forceCSS=t.setAttribute("transform","")||!ll(tt(t,ue)),L&&t.setAttribute("transform",L))),Math.abs(S)>90&&Math.abs(S)<270&&(h?(x*=-1,S+=E<=0?180:-180,E+=E<=0?180:-180):(v*=-1,S+=S<=0?180:-180)),n=n||s.uncache,s.x=f-((s.xPercent=f&&(!n&&s.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-f)?-50:0)))?t.offsetWidth*s.xPercent/100:0)+u,s.y=m-((s.yPercent=m&&(!n&&s.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-m)?-50:0)))?t.offsetHeight*s.yPercent/100:0)+u,s.z=_+u,s.scaleX=se(x),s.scaleY=se(v),s.rotation=se(E)+c,s.rotationX=se(g)+c,s.rotationY=se(w)+c,s.skewX=S+c,s.skewY=C+c,s.transformPerspective=P+u,(s.zOrigin=parseFloat(p.split(" ")[2])||0)&&(a[xt]=Ln(p)),s.xOffset=s.yOffset=0,s.force3D=Te.force3D,s.renderTransform=s.svg?gp:rl?hl:_p,s.uncache=0,s},Ln=function(t){return(t=t.split(" "))[0]+" "+t[1]},Tr=function(t,n,s){var a=fe(n);return se(parseFloat(n)+parseFloat(wt(t,"x",s+"px",a)))+a},_p=function(t,n){n.z="0px",n.rotationY=n.rotationX="0deg",n.force3D=0,hl(t,n)},At="0deg",Ui="0px",Rt=") ",hl=function(t,n){var s=n||this,a=s.xPercent,h=s.yPercent,u=s.x,c=s.y,p=s.z,f=s.rotation,m=s.rotationY,_=s.rotationX,x=s.skewX,v=s.skewY,E=s.scaleX,g=s.scaleY,w=s.transformPerspective,S=s.force3D,C=s.target,P=s.zOrigin,k="",T=S==="auto"&&t&&t!==1||S===!0;if(P&&(_!==At||m!==At)){var M=parseFloat(m)*ui,O=Math.sin(M),R=Math.cos(M),D;M=parseFloat(_)*ui,D=Math.cos(M),u=Tr(C,u,O*D*-P),c=Tr(C,c,-Math.sin(M)*-P),p=Tr(C,p,R*D*-P+P)}w!==Ui&&(k+="perspective("+w+Rt),(a||h)&&(k+="translate("+a+"%, "+h+"%) "),(T||u!==Ui||c!==Ui||p!==Ui)&&(k+=p!==Ui||T?"translate3d("+u+", "+c+", "+p+") ":"translate("+u+", "+c+Rt),f!==At&&(k+="rotate("+f+Rt),m!==At&&(k+="rotateY("+m+Rt),_!==At&&(k+="rotateX("+_+Rt),(x!==At||v!==At)&&(k+="skew("+x+", "+v+Rt),(E!==1||g!==1)&&(k+="scale("+E+", "+g+Rt),C.style[ue]=k||"translate(0, 0)"},gp=function(t,n){var s=n||this,a=s.xPercent,h=s.yPercent,u=s.x,c=s.y,p=s.rotation,f=s.skewX,m=s.skewY,_=s.scaleX,x=s.scaleY,v=s.target,E=s.xOrigin,g=s.yOrigin,w=s.xOffset,S=s.yOffset,C=s.forceCSS,P=parseFloat(u),k=parseFloat(c),T,M,O,R,D;p=parseFloat(p),f=parseFloat(f),m=parseFloat(m),m&&(m=parseFloat(m),f+=m,p+=m),p||f?(p*=ui,f*=ui,T=Math.cos(p)*_,M=Math.sin(p)*_,O=Math.sin(p-f)*-x,R=Math.cos(p-f)*x,f&&(m*=ui,D=Math.tan(f-m),D=Math.sqrt(1+D*D),O*=D,R*=D,m&&(D=Math.tan(m),D=Math.sqrt(1+D*D),T*=D,M*=D)),T=se(T),M=se(M),O=se(O),R=se(R)):(T=_,R=x,M=O=0),(P&&!~(u+"").indexOf("px")||k&&!~(c+"").indexOf("px"))&&(P=wt(v,"x",u,"px"),k=wt(v,"y",c,"px")),(E||g||w||S)&&(P=se(P+E-(E*T+g*O)+w),k=se(k+g-(E*M+g*R)+S)),(a||h)&&(D=v.getBBox(),P=se(P+a/100*D.width),k=se(k+h/100*D.height)),D="matrix("+T+","+M+","+O+","+R+","+P+","+k+")",v.setAttribute("transform",D),C&&(v.style[ue]=D)},bp=function(t,n,s,a,h){var u=360,c=he(h),p=parseFloat(h)*(c&&~h.indexOf("rad")?Ot:1),f=p-a,m=a+f+"deg",_,x;return c&&(_=h.split("_")[1],_==="short"&&(f%=u,f!==f%(u/2)&&(f+=f<0?u:-u)),_==="cw"&&f<0?f=(f+u*Bo)%u-~~(f/u)*u:_==="ccw"&&f>0&&(f=(f-u*Bo)%u-~~(f/u)*u)),t._pt=x=new Ee(t._pt,n,s,a,f,sp),x.e=m,x.u="deg",t._props.push(s),x},Fo=function(t,n){for(var s in n)t[s]=n[s];return t},xp=function(t,n,s){var a=Fo({},s._gsap),h="perspective,force3D,transformOrigin,svgOrigin",u=s.style,c,p,f,m,_,x,v,E;a.svg?(f=s.getAttribute("transform"),s.setAttribute("transform",""),u[ue]=n,c=en(s,1),Qi(s,ue),s.setAttribute("transform",f)):(f=getComputedStyle(s)[ue],u[ue]=n,c=en(s,1),u[ue]=f);for(p in bt)f=a[p],m=c[p],f!==m&&h.indexOf(p)<0&&(v=fe(f),E=fe(m),_=v!==E?wt(s,p,f,E):parseFloat(f),x=parseFloat(m),t._pt=new Ee(t._pt,c,p,_,x-_,tl),t._pt.u=E||0,t._props.push(p));Fo(c,a)};ye("padding,margin,Width,Radius",function(o,t){var n="Top",s="Right",a="Bottom",h="Left",u=(t<3?[n,s,a,h]:[n+h,n+s,a+s,a+h]).map(function(c){return t<2?o+c:"border"+c+o});On[t>1?"border"+o:o]=function(c,p,f,m,_){var x,v;if(arguments.length<4)return x=u.map(function(E){return Lt(c,E,f)}),v=x.join(" "),v.split(x[0]).length===5?x[0]:v;x=(m+"").split(" "),v={},u.forEach(function(E,g){return v[E]=x[g]=x[g]||x[(g-1)/2|0]}),c.init(p,v,_)}});var ul={name:"css",register:Zr,targetTest:function(t){return t.style&&t.nodeType},init:function(t,n,s,a,h){var u=this._props,c=t.style,p=s.vars.startAt,f,m,_,x,v,E,g,w,S,C,P,k,T,M,O;vs||Zr();for(g in n)if(g!=="autoRound"&&(m=n[g],!(Pe[g]&&Wa(g,n,s,a,t,h)))){if(v=typeof m,E=On[g],v==="function"&&(m=m.call(s,a,t,h),v=typeof m),v==="string"&&~m.indexOf("random(")&&(m=$i(m)),E)E(this,t,g,m,s)&&(O=1);else if(g.substr(0,2)==="--")f=(getComputedStyle(t).getPropertyValue(g)+"").trim(),m+="",gt.lastIndex=0,gt.test(f)||(w=fe(f),S=fe(m)),S?w!==S&&(f=wt(t,g,f,S)+S):w&&(m+=w),this.add(c,"setProperty",f,m,a,h,0,0,g),u.push(g);else if(v!=="undefined"){if(p&&g in p?(f=typeof p[g]=="function"?p[g].call(s,a,t,h):p[g],he(f)&&~f.indexOf("random(")&&(f=$i(f)),fe(f+"")||(f+=Te.units[g]||fe(Lt(t,g))||""),(f+"").charAt(1)==="="&&(f=Lt(t,g))):f=Lt(t,g),x=parseFloat(f),C=v==="string"&&m.charAt(1)==="="&&m.substr(0,2),C&&(m=m.substr(2)),_=parseFloat(m),g in mt&&(g==="autoAlpha"&&(x===1&&Lt(t,"visibility")==="hidden"&&_&&(x=0),vt(this,c,"visibility",x?"inherit":"hidden",_?"inherit":"hidden",!_)),g!=="scale"&&g!=="transform"&&(g=mt[g],~g.indexOf(",")&&(g=g.split(",")[0]))),P=g in bt,P){if(k||(T=t._gsap,T.renderTransform&&!n.parseTransform||en(t,n.parseTransform),M=n.smoothOrigin!==!1&&T.smooth,k=this._pt=new Ee(this._pt,c,ue,0,1,T.renderTransform,T,0,-1),k.dep=1),g==="scale")this._pt=new Ee(this._pt,T,"scaleY",T.scaleY,(C?li(T.scaleY,C+_):_)-T.scaleY||0),u.push("scaleY",g),g+="X";else if(g==="transformOrigin"){m=mp(m),T.svg?Qr(t,m,0,M,0,this):(S=parseFloat(m.split(" ")[2])||0,S!==T.zOrigin&&vt(this,T,"zOrigin",T.zOrigin,S),vt(this,c,g,Ln(f),Ln(m)));continue}else if(g==="svgOrigin"){Qr(t,m,1,M,0,this);continue}else if(g in al){bp(this,T,g,x,C?li(x,C+m):m);continue}else if(g==="smoothOrigin"){vt(this,T,"smooth",T.smooth,m);continue}else if(g==="force3D"){T[g]=m;continue}else if(g==="transform"){xp(this,m,t);continue}}else g in c||(g=mi(g)||g);if(P||(_||_===0)&&(x||x===0)&&!rp.test(m)&&g in c)w=(f+"").substr((x+"").length),_||(_=0),S=fe(m)||(g in Te.units?Te.units[g]:w),w!==S&&(x=wt(t,g,f,S)),this._pt=new Ee(this._pt,P?T:c,g,x,(C?li(x,C+_):_)-x,!P&&(S==="px"||g==="zIndex")&&n.autoRound!==!1?ap:tl),this._pt.u=S||0,w!==S&&S!=="%"&&(this._pt.b=f,this._pt.r=op);else if(g in c)fp.call(this,t,g,f,C?C+m:m);else if(g in t)this.add(t,g,f||t[g],C?C+m:m,a,h);else{os(g,m);continue}u.push(g)}}O&&Ja(this)},get:Lt,aliases:mt,getSetter:function(t,n,s){var a=mt[n];return a&&a.indexOf(",")<0&&(n=a),n in bt&&n!==xt&&(t._gsap.x||Lt(t,"x"))?s&&Lo===s?n==="scale"?cp:up:(Lo=s||{})&&(n==="scale"?dp:pp):t.style&&!rs(t.style[n])?lp:~n.indexOf("-")?hp:fs(t,n)},core:{_removeProperty:Qi,_getMatrix:_s}};Ve.utils.checkPrefix=mi;(function(o,t,n,s){var a=ye(o+","+t+","+n,function(h){bt[h]=1});ye(t,function(h){Te.units[h]="deg",al[h]=1}),mt[a[13]]=o+","+t,ye(s,function(h){var u=h.split(":");mt[u[1]]=a[u[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");ye("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(o){Te.units[o]="px"});Ve.registerPlugin(ul);var Jr=Ve.registerPlugin(ul)||Ve;Jr.core.Tween;var Pn={exports:{}},wp=Pn.exports,Ho;function yp(){return Ho||(Ho=1,(function(o,t){(function(n,s){o.exports=s()})(wp,function(){var n=function(){function s(v){return u.appendChild(v.dom),v}function a(v){for(var E=0;E<u.children.length;E++)u.children[E].style.display=E===v?"block":"none";h=v}var h=0,u=document.createElement("div");u.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",u.addEventListener("click",function(v){v.preventDefault(),a(++h%u.children.length)},!1);var c=(performance||Date).now(),p=c,f=0,m=s(new n.Panel("FPS","#0ff","#002")),_=s(new n.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var x=s(new n.Panel("MB","#f08","#201"));return a(0),{REVISION:16,dom:u,addPanel:s,showPanel:a,begin:function(){c=(performance||Date).now()},end:function(){f++;var v=(performance||Date).now();if(_.update(v-c,200),v>p+1e3&&(m.update(1e3*f/(v-p),100),p=v,f=0,x)){var E=performance.memory;x.update(E.usedJSHeapSize/1048576,E.jsHeapSizeLimit/1048576)}return v},update:function(){c=this.end()},domElement:u,setMode:a}};return n.Panel=function(s,a,h){var u=1/0,c=0,p=Math.round,f=p(window.devicePixelRatio||1),m=80*f,_=48*f,x=3*f,v=2*f,E=3*f,g=15*f,w=74*f,S=30*f,C=document.createElement("canvas");C.width=m,C.height=_,C.style.cssText="width:80px;height:48px";var P=C.getContext("2d");return P.font="bold "+9*f+"px Helvetica,Arial,sans-serif",P.textBaseline="top",P.fillStyle=h,P.fillRect(0,0,m,_),P.fillStyle=a,P.fillText(s,x,v),P.fillRect(E,g,w,S),P.fillStyle=h,P.globalAlpha=.9,P.fillRect(E,g,w,S),{dom:C,update:function(k,T){u=Math.min(u,k),c=Math.max(c,k),P.fillStyle=h,P.globalAlpha=1,P.fillRect(0,0,m,g),P.fillStyle=a,P.fillText(p(k)+" "+s+" ("+p(u)+"-"+p(c)+")",x,v),P.drawImage(C,E+f,g,w-f,S,E,g,w-f,S),P.fillRect(E+w-f,g,f,S),P.fillStyle=h,P.globalAlpha=.9,P.fillRect(E+w-f,g,f,p((1-k/T)*S))}}},n})})(Pn)),Pn.exports}var Ep=yp();const Cp=na(Ep);var Gi={exports:{}};var Pp=Gi.exports,Go;function Sp(){return Go||(Go=1,(function(o,t){(function(n,s){s(t)})(Pp,(function(n){class s{constructor(e){const[i,l]=e.split("-"),d=i.split(".");this.major=parseInt(d[0],10),this.minor=parseInt(d[1],10),this.patch=parseInt(d[2],10),this.prerelease=l??null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}}class a{constructor(e){this.controller_=e}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(e){this.controller_.viewProps.set("hidden",e)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class h{constructor(e){this.target=e}}class u extends h{constructor(e,i,l,d){super(e),this.value=i,this.presetKey=l,this.last=d??!0}}class c extends h{constructor(e,i,l){super(e),this.value=i,this.presetKey=l}}class p extends h{constructor(e,i){super(e),this.expanded=i}}function f(r){return r}function m(r){return r==null}function _(r,e){if(r.length!==e.length)return!1;for(let i=0;i<r.length;i++)if(r[i]!==e[i])return!1;return!0}const x={alreadydisposed:()=>"View has been already disposed",invalidparams:r=>`Invalid parameters for '${r.name}'`,nomatchingcontroller:r=>`No matching controller for '${r.key}'`,nomatchingview:r=>`No matching view for '${JSON.stringify(r.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:r=>`Property '${r.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class v{constructor(e){var i;this.message=(i=x[e.type](e.context))!==null&&i!==void 0?i:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}static alreadyDisposed(){return new v({type:"alreadydisposed"})}static notBindable(){return new v({type:"notbindable"})}static propertyNotFound(e){return new v({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new v({type:"shouldneverhappen"})}}class E{constructor(e,i,l){this.obj_=e,this.key_=i,this.presetKey_=l??i}static isBindable(e){return!(e===null||typeof e!="object")}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(e){this.obj_[this.key_]=e}writeProperty(e,i){const l=this.read();if(!E.isBindable(l))throw v.notBindable();if(!(e in l))throw v.propertyNotFound(e);l[e]=i}}class g extends a{get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get title(){var e;return(e=this.controller_.valueController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller_.valueController.props.set("title",e)}on(e,i){const l=i.bind(this);return this.controller_.valueController.emitter.on(e,()=>{l(new h(this))}),this}}class w{constructor(){this.observers_={}}on(e,i){let l=this.observers_[e];return l||(l=this.observers_[e]=[]),l.push({handler:i}),this}off(e,i){const l=this.observers_[e];return l&&(this.observers_[e]=l.filter(d=>d.handler!==i)),this}emit(e,i){const l=this.observers_[e];l&&l.forEach(d=>{d.handler(i)})}}const S="tp";function C(r){return(i,l)=>[S,"-",r,"v",i?`_${i}`:"",l?`-${l}`:""].join("")}function P(r,e){return i=>e(r(i))}function k(r){return r.rawValue}function T(r,e){r.emitter.on("change",P(k,e)),e(r.rawValue)}function M(r,e,i){T(r.value(e),i)}function O(r,e,i){i?r.classList.add(e):r.classList.remove(e)}function R(r,e){return i=>{O(r,e,i)}}function D(r,e){T(r,i=>{e.textContent=i??""})}const U=C("btn");class Z{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(U()),i.viewProps.bindClassModifiers(this.element);const l=e.createElement("button");l.classList.add(U("b")),i.viewProps.bindDisabled(l),this.element.appendChild(l),this.buttonElement=l;const d=e.createElement("div");d.classList.add(U("t")),D(i.props.value("title"),d),this.buttonElement.appendChild(d)}}class ne{constructor(e,i){this.emitter=new w,this.onClick_=this.onClick_.bind(this),this.props=i.props,this.viewProps=i.viewProps,this.view=new Z(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class re{constructor(e,i){var l;this.constraint_=i?.constraint,this.equals_=(l=i?.equals)!==null&&l!==void 0?l:((d,b)=>d===b),this.emitter=new w,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,i){const l=i??{forceEmit:!1,last:!0},d=this.constraint_?this.constraint_.constrain(e):e;this.equals_(this.rawValue_,d)&&!l.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=d,this.emitter.emit("change",{options:l,rawValue:d,sender:this}))}}class Q{constructor(e){this.emitter=new w,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,i){const l=i??{forceEmit:!1,last:!0};this.value_===e&&!l.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:l,rawValue:this.value_,sender:this}))}}function N(r,e){const i=e?.constraint,l=e?.equals;return!i&&!l?new Q(r):new re(r,e)}class L{constructor(e){this.emitter=new w,this.valMap_=e;for(const i in this.valMap_)this.valMap_[i].emitter.on("change",()=>{this.emitter.emit("change",{key:i,sender:this})})}static createCore(e){return Object.keys(e).reduce((l,d)=>Object.assign(l,{[d]:N(e[d])}),{})}static fromObject(e){const i=this.createCore(e);return new L(i)}get(e){return this.valMap_[e].rawValue}set(e,i){this.valMap_[e].rawValue=i}value(e){return this.valMap_[e]}}function ce(r,e){const l=Object.keys(e).reduce((d,b)=>{if(d===void 0)return;const y=e[b],A=y(r[b]);return A.succeeded?Object.assign(Object.assign({},d),{[b]:A.value}):void 0},{});return l}function qe(r,e){return r.reduce((i,l)=>{if(i===void 0)return;const d=e(l);if(!(!d.succeeded||d.value===void 0))return[...i,d.value]},[])}function $e(r){return r===null?!1:typeof r=="object"}function ve(r){return e=>i=>{if(!e&&i===void 0)return{succeeded:!1,value:void 0};if(e&&i===void 0)return{succeeded:!0,value:void 0};const l=r(i);return l!==void 0?{succeeded:!0,value:l}:{succeeded:!1,value:void 0}}}function ze(r){return{custom:e=>ve(e)(r),boolean:ve(e=>typeof e=="boolean"?e:void 0)(r),number:ve(e=>typeof e=="number"?e:void 0)(r),string:ve(e=>typeof e=="string"?e:void 0)(r),function:ve(e=>typeof e=="function"?e:void 0)(r),constant:e=>ve(i=>i===e?e:void 0)(r),raw:ve(e=>e)(r),object:e=>ve(i=>{if($e(i))return ce(i,e)})(r),array:e=>ve(i=>{if(Array.isArray(i))return qe(i,e)})(r)}}const W={optional:ze(!0),required:ze(!1)};function q(r,e){const i=W.required.object(e)(r);return i.succeeded?i.value:void 0}function Xe(r){return r&&r.parentElement&&r.parentElement.removeChild(r),null}function vl(){return["veryfirst","first","last","verylast"]}const xs=C(""),ws={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class gi{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const i=this.view.element;this.blade.value("positions").emitter.on("change",()=>{vl().forEach(l=>{i.classList.remove(xs(void 0,ws[l]))}),this.blade.get("positions").forEach(l=>{i.classList.add(xs(void 0,ws[l]))})}),this.viewProps.handleDispose(()=>{Xe(i)})}get parent(){return this.parent_}}const Fe="http://www.w3.org/2000/svg";function nn(r){r.offsetHeight}function _l(r,e){const i=r.style.transition;r.style.transition="none",e(),r.style.transition=i}function Vn(r){return r.ontouchstart!==void 0}function gl(){return new Function("return this")()}function bl(){return gl().document}function xl(r){const e=r.ownerDocument.defaultView;return e&&"document"in e?r.getContext("2d"):null}const wl={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function rn(r,e){const i=r.createElementNS(Fe,"svg");return i.innerHTML=wl[e],i}function ys(r,e,i){r.insertBefore(e,r.children[i])}function Es(r){r.parentElement&&r.parentElement.removeChild(r)}function Cs(r){for(;r.children.length>0;)r.removeChild(r.children[0])}function yl(r){for(;r.childNodes.length>0;)r.removeChild(r.childNodes[0])}function Ps(r){return r.relatedTarget?r.relatedTarget:"explicitOriginalTarget"in r?r.explicitOriginalTarget:null}const bi=C("lbl");function El(r,e){const i=r.createDocumentFragment();return e.split(`
`).map(d=>r.createTextNode(d)).forEach((d,b)=>{b>0&&i.appendChild(r.createElement("br")),i.appendChild(d)}),i}class Ss{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(bi()),i.viewProps.bindClassModifiers(this.element);const l=e.createElement("div");l.classList.add(bi("l")),M(i.props,"label",b=>{m(b)?this.element.classList.add(bi(void 0,"nol")):(this.element.classList.remove(bi(void 0,"nol")),yl(l),l.appendChild(El(e,b)))}),this.element.appendChild(l),this.labelElement=l;const d=e.createElement("div");d.classList.add(bi("v")),this.element.appendChild(d),this.valueElement=d}}class sn extends gi{constructor(e,i){const l=i.valueController.viewProps;super(Object.assign(Object.assign({},i),{view:new Ss(e,{props:i.props,viewProps:l}),viewProps:l})),this.props=i.props,this.valueController=i.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const Cl={id:"button",type:"blade",accept(r){const e=W,i=q(r,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return i?{params:i}:null},controller(r){return new sn(r.document,{blade:r.blade,props:L.fromObject({label:r.params.label}),valueController:new ne(r.document,{props:L.fromObject({title:r.params.title}),viewProps:r.viewProps})})},api(r){return!(r.controller instanceof sn)||!(r.controller.valueController instanceof ne)?null:new g(r.controller)}};class Yt extends gi{constructor(e){super(e),this.value=e.value}}function xi(){return new L({positions:N([],{equals:_})})}class wi extends L{constructor(e){super(e)}static create(e){const i={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},l=L.createCore(i);return new wi(l)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!m(e)?`${e}px`:"auto"}bindExpandedClass(e,i){const l=()=>{this.styleExpanded?e.classList.add(i):e.classList.remove(i)};M(this,"expanded",l),M(this,"temporaryExpanded",l)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function Pl(r,e){let i=0;return _l(e,()=>{r.set("expandedHeight",null),r.set("temporaryExpanded",!0),nn(e),i=e.clientHeight,r.set("temporaryExpanded",null),nn(e)}),i}function Ts(r,e){e.style.height=r.styleHeight}function Nn(r,e){r.value("expanded").emitter.on("beforechange",()=>{r.set("completed",!1),m(r.get("expandedHeight"))&&r.set("expandedHeight",Pl(r,e)),r.set("shouldFixHeight",!0),nn(e)}),r.emitter.on("change",()=>{Ts(r,e)}),Ts(r,e),e.addEventListener("transitionend",i=>{i.propertyName==="height"&&r.cleanUpTransition()})}class zn extends a{constructor(e,i){super(e),this.rackApi_=i}}function Sl(r,e){return r.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function Tl(r,e){return r.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function Ml(r,e){const i=e||{};return r.addBlade(Object.assign(Object.assign({},i),{view:"separator"}))}function kl(r,e){return r.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}class Fn{constructor(e){this.emitter=new w,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const i of this.allItems())if(e(i))return i;return null}includes(e){return this.cache_.has(e)}add(e,i){if(this.includes(e))throw v.shouldNeverHappen();const l=i!==void 0?i:this.items_.length;this.items_.splice(l,0,e),this.cache_.add(e);const d=this.extract_(e);d&&(d.emitter.on("add",this.onSubListAdd_),d.emitter.on("remove",this.onSubListRemove_),d.allItems().forEach(b=>{this.cache_.add(b)})),this.emitter.emit("add",{index:l,item:e,root:this,target:this})}remove(e){const i=this.items_.indexOf(e);if(i<0)return;this.items_.splice(i,1),this.cache_.delete(e);const l=this.extract_(e);l&&(l.emitter.off("add",this.onSubListAdd_),l.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:i,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}class Hn extends a{constructor(e){super(e),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new w,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}on(e,i){const l=i.bind(this);return this.emitter_.on(e,d=>{l(d.event)}),this}refresh(){this.controller_.binding.read()}onBindingChange_(e){const i=e.sender.target.read();this.emitter_.emit("change",{event:new u(this,i,this.controller_.binding.target.presetKey,e.options.last)})}}class He extends sn{constructor(e,i){super(e,i),this.binding=i.binding}}class Gn extends a{constructor(e){super(e),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new w,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}on(e,i){const l=i.bind(this);return this.emitter_.on(e,d=>{l(d.event)}),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(e){const i=e.sender.target.read();this.emitter_.emit("update",{event:new c(this,i,this.controller_.binding.target.presetKey)})}}class rt extends sn{constructor(e,i){super(e,i),this.binding=i.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose(()=>{this.binding.dispose()})}}function Al(r){return r instanceof on?r.apiSet_:r instanceof zn?r.rackApi_.apiSet_:null}function yi(r,e){const i=r.find(l=>l.controller_===e);if(!i)throw v.shouldNeverHappen();return i}function Ms(r,e,i){if(!E.isBindable(r))throw v.notBindable();return new E(r,e,i)}class on extends a{constructor(e,i){super(e),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new w,this.apiSet_=new Fn(Al),this.pool_=i;const l=this.controller_.rack;l.emitter.on("add",this.onRackAdd_),l.emitter.on("remove",this.onRackRemove_),l.emitter.on("inputchange",this.onRackInputChange_),l.emitter.on("monitorupdate",this.onRackMonitorUpdate_),l.children.forEach(d=>{this.setUpApi_(d)})}get children(){return this.controller_.rack.children.map(e=>yi(this.apiSet_,e))}addInput(e,i,l){const d=l||{},b=this.controller_.view.element.ownerDocument,y=this.pool_.createInput(b,Ms(e,i,d.presetKey),d),A=new Hn(y);return this.add(A,d.index)}addMonitor(e,i,l){const d=l||{},b=this.controller_.view.element.ownerDocument,y=this.pool_.createMonitor(b,Ms(e,i),d),A=new Gn(y);return this.add(A,d.index)}addFolder(e){return Tl(this,e)}addButton(e){return Sl(this,e)}addSeparator(e){return Ml(this,e)}addTab(e){return kl(this,e)}add(e,i){this.controller_.rack.add(e.controller_,i);const l=this.apiSet_.find(d=>d.controller_===e.controller_);return l&&this.apiSet_.remove(l),this.apiSet_.add(e),e}remove(e){this.controller_.rack.remove(e.controller_)}addBlade(e){const i=this.controller_.view.element.ownerDocument,l=this.pool_.createBlade(i,e),d=this.pool_.createBladeApi(l);return this.add(d,e.index)}on(e,i){const l=i.bind(this);return this.emitter_.on(e,d=>{l(d.event)}),this}setUpApi_(e){this.apiSet_.find(l=>l.controller_===e)||this.apiSet_.add(this.pool_.createBladeApi(e))}onRackAdd_(e){this.setUpApi_(e.bladeController)}onRackRemove_(e){if(e.isRoot){const i=yi(this.apiSet_,e.bladeController);this.apiSet_.remove(i)}}onRackInputChange_(e){const i=e.bladeController;if(i instanceof He){const l=yi(this.apiSet_,i),d=i.binding;this.emitter_.emit("change",{event:new u(l,d.target.read(),d.target.presetKey,e.options.last)})}else if(i instanceof Yt){const l=yi(this.apiSet_,i);this.emitter_.emit("change",{event:new u(l,i.value.rawValue,void 0,e.options.last)})}}onRackMonitorUpdate_(e){if(!(e.bladeController instanceof rt))throw v.shouldNeverHappen();const i=yi(this.apiSet_,e.bladeController),l=e.bladeController.binding;this.emitter_.emit("update",{event:new c(i,l.target.read(),l.target.presetKey)})}}class jn extends zn{constructor(e,i){super(e,new on(e.rackController,i)),this.emitter_=new w,this.controller_.foldable.value("expanded").emitter.on("change",l=>{this.emitter_.emit("fold",{event:new p(this,l.sender.rawValue)})}),this.rackApi_.on("change",l=>{this.emitter_.emit("change",{event:l})}),this.rackApi_.on("update",l=>{this.emitter_.emit("update",{event:l})})}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(e){this.controller_.foldable.set("expanded",e)}get title(){return this.controller_.props.get("title")}set title(e){this.controller_.props.set("title",e)}get children(){return this.rackApi_.children}addInput(e,i,l){return this.rackApi_.addInput(e,i,l)}addMonitor(e,i,l){return this.rackApi_.addMonitor(e,i,l)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addSeparator(e){return this.rackApi_.addSeparator(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,i){return this.rackApi_.add(e,i)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,i){const l=i.bind(this);return this.emitter_.on(e,d=>{l(d.event)}),this}}class Kn extends gi{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}}class Rl{constructor(e,i){const l=C(i.viewName);this.element=e.createElement("div"),this.element.classList.add(l()),i.viewProps.bindClassModifiers(this.element)}}function Dl(r,e){for(let i=0;i<r.length;i++){const l=r[i];if(l instanceof He&&l.binding===e)return l}return null}function Ol(r,e){for(let i=0;i<r.length;i++){const l=r[i];if(l instanceof rt&&l.binding===e)return l}return null}function Ll(r,e){for(let i=0;i<r.length;i++){const l=r[i];if(l instanceof Yt&&l.value===e)return l}return null}function Yn(r){return r instanceof Ei?r.rack:r instanceof Kn?r.rackController.rack:null}function Bl(r){const e=Yn(r);return e?e.bcSet_:null}class Il{constructor(e){var i;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new w,this.blade_=e??null,(i=this.blade_)===null||i===void 0||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new Fn(Bl),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,i){e.parent&&e.parent.remove(e),e.parent_=this,this.bcSet_.add(e,i)}remove(e){e.parent_=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(i=>i instanceof e)}onSetAdd_(e){this.updatePositions_();const i=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,isRoot:i,sender:this}),!i)return;const l=e.item;if(l.viewProps.emitter.on("change",this.onChildViewPropsChange_),l.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),l.viewProps.handleDispose(this.onChildDispose_),l instanceof He)l.binding.emitter.on("change",this.onChildInputChange_);else if(l instanceof rt)l.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(l instanceof Yt)l.value.emitter.on("change",this.onChildValueChange_);else{const d=Yn(l);if(d){const b=d.emitter;b.on("layout",this.onDescendantLayout_),b.on("inputchange",this.onDescendantInputChange_),b.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(e){this.updatePositions_();const i=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,isRoot:i,sender:this}),!i)return;const l=e.item;if(l instanceof He)l.binding.emitter.off("change",this.onChildInputChange_);else if(l instanceof rt)l.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(l instanceof Yt)l.value.emitter.off("change",this.onChildValueChange_);else{const d=Yn(l);if(d){const b=d.emitter;b.off("layout",this.onDescendantLayout_),b.off("inputchange",this.onDescendantInputChange_),b.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const e=this.bcSet_.items.filter(d=>!d.viewProps.get("hidden")),i=e[0],l=e[e.length-1];this.bcSet_.items.forEach(d=>{const b=[];d===i&&(b.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&b.push("veryfirst")),d===l&&(b.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&b.push("verylast")),d.blade.set("positions",b)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(i=>i.viewProps.get("disposed")).forEach(i=>{this.bcSet_.remove(i)})}onChildInputChange_(e){const i=Dl(this.find(He),e.sender);if(!i)throw v.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:i,options:e.options,sender:this})}onChildMonitorUpdate_(e){const i=Ol(this.find(rt),e.sender);if(!i)throw v.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:i,sender:this})}onChildValueChange_(e){const i=Ll(this.find(Yt),e.sender);if(!i)throw v.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:i,options:e.options,sender:this})}onDescendantLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(e){this.emitter.emit("inputchange",{bladeController:e.bladeController,options:e.options,sender:this})}onDescendantMonitorUpdate_(e){this.emitter.emit("monitorupdate",{bladeController:e.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class Ei extends gi{constructor(e,i){super(Object.assign(Object.assign({},i),{view:new Rl(e,{viewName:"brk",viewProps:i.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const l=new Il(i.root?void 0:i.blade);l.emitter.on("add",this.onRackAdd_),l.emitter.on("remove",this.onRackRemove_),this.rack=l,this.viewProps.handleDispose(()=>{for(let d=this.rack.children.length-1;d>=0;d--)this.rack.children[d].viewProps.set("disposed",!0)})}onRackAdd_(e){e.isRoot&&ys(this.view.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.isRoot&&Es(e.bladeController.view.element)}}const ks=C("cnt");class Ul{constructor(e,i){this.className_=C(i.viewName||"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),ks()),i.viewProps.bindClassModifiers(this.element),this.foldable_=i.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),M(this.foldable_,"completed",R(this.element,this.className_(void 0,"cpl")));const l=e.createElement("button");l.classList.add(this.className_("b")),M(i.props,"title",A=>{m(A)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),i.viewProps.bindDisabled(l),this.element.appendChild(l),this.buttonElement=l;const d=e.createElement("div");d.classList.add(this.className_("t")),D(i.props.value("title"),d),this.buttonElement.appendChild(d),this.titleElement=d;const b=e.createElement("div");b.classList.add(this.className_("m")),this.buttonElement.appendChild(b);const y=i.containerElement;y.classList.add(this.className_("c")),this.element.appendChild(y),this.containerElement=y}}class Wn extends Kn{constructor(e,i){var l;const d=wi.create((l=i.expanded)!==null&&l!==void 0?l:!0),b=new Ei(e,{blade:i.blade,root:i.root,viewProps:i.viewProps});super(Object.assign(Object.assign({},i),{rackController:b,view:new Ul(e,{containerElement:b.view.element,foldable:d,props:i.props,viewName:i.root?"rot":void 0,viewProps:i.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=i.props,this.foldable=d,Nn(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const Vl={id:"folder",type:"blade",accept(r){const e=W,i=q(r,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return i?{params:i}:null},controller(r){return new Wn(r.document,{blade:r.blade,expanded:r.params.expanded,props:L.fromObject({title:r.params.title}),viewProps:r.viewProps})},api(r){return r.controller instanceof Wn?new jn(r.controller,r.pool):null}};class Wt extends Yt{constructor(e,i){const l=i.valueController.viewProps;super(Object.assign(Object.assign({},i),{value:i.valueController.value,view:new Ss(e,{props:i.props,viewProps:l}),viewProps:l})),this.props=i.props,this.valueController=i.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class As extends a{}const Rs=C("spr");class Nl{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(Rs()),i.viewProps.bindClassModifiers(this.element);const l=e.createElement("hr");l.classList.add(Rs("r")),this.element.appendChild(l)}}class Ds extends gi{constructor(e,i){super(Object.assign(Object.assign({},i),{view:new Nl(e,{viewProps:i.viewProps})}))}}const zl={id:"separator",type:"blade",accept(r){const i=q(r,{view:W.required.constant("separator")});return i?{params:i}:null},controller(r){return new Ds(r.document,{blade:r.blade,viewProps:r.viewProps})},api(r){return r.controller instanceof Ds?new As(r.controller):null}},Fl=C("");function Os(r,e){return R(r,Fl(void 0,e))}class st extends L{constructor(e){super(e)}static create(e){var i,l;const d=e??{},b={disabled:(i=d.disabled)!==null&&i!==void 0?i:!1,disposed:!1,hidden:(l=d.hidden)!==null&&l!==void 0?l:!1},y=L.createCore(b);return new st(y)}bindClassModifiers(e){M(this,"disabled",Os(e,"disabled")),M(this,"hidden",Os(e,"hidden"))}bindDisabled(e){M(this,"disabled",i=>{e.disabled=i})}bindTabIndex(e){M(this,"disabled",i=>{e.tabIndex=i?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",i=>{i&&e()})}}const Ci=C("tbi");class Hl{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(Ci()),i.viewProps.bindClassModifiers(this.element),M(i.props,"selected",b=>{b?this.element.classList.add(Ci(void 0,"sel")):this.element.classList.remove(Ci(void 0,"sel"))});const l=e.createElement("button");l.classList.add(Ci("b")),i.viewProps.bindDisabled(l),this.element.appendChild(l),this.buttonElement=l;const d=e.createElement("div");d.classList.add(Ci("t")),D(i.props.value("title"),d),this.buttonElement.appendChild(d),this.titleElement=d}}class Gl{constructor(e,i){this.emitter=new w,this.onClick_=this.onClick_.bind(this),this.props=i.props,this.viewProps=i.viewProps,this.view=new Hl(e,{props:i.props,viewProps:i.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class Ls{constructor(e,i){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Gl(e,{props:i.itemProps,viewProps:st.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new Ei(e,{blade:xi(),viewProps:st.create()}),this.props=i.props,M(this.props,"selected",l=>{this.itemController.props.set("selected",l),this.contentController.viewProps.set("hidden",!l)})}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class Bs{constructor(e,i){this.controller_=e,this.rackApi_=i}get title(){var e;return(e=this.controller_.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller_.itemController.props.set("title",e)}get selected(){return this.controller_.props.get("selected")}set selected(e){this.controller_.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addSeparator(e){return this.rackApi_.addSeparator(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,i){this.rackApi_.add(e,i)}remove(e){this.rackApi_.remove(e)}addInput(e,i,l){return this.rackApi_.addInput(e,i,l)}addMonitor(e,i,l){return this.rackApi_.addMonitor(e,i,l)}addBlade(e){return this.rackApi_.addBlade(e)}}class Is extends zn{constructor(e,i){super(e,new on(e.rackController,i)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.emitter_=new w,this.pageApiMap_=new Map,this.rackApi_.on("change",l=>{this.emitter_.emit("change",{event:l})}),this.rackApi_.on("update",l=>{this.emitter_.emit("update",{event:l})}),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach(l=>{this.setUpPageApi_(l)})}get pages(){return this.controller_.pageSet.items.map(e=>{const i=this.pageApiMap_.get(e);if(!i)throw v.shouldNeverHappen();return i})}addPage(e){const i=this.controller_.view.element.ownerDocument,l=new Ls(i,{itemProps:L.fromObject({selected:!1,title:e.title}),props:L.fromObject({selected:!1})});this.controller_.add(l,e.index);const d=this.pageApiMap_.get(l);if(!d)throw v.shouldNeverHappen();return d}removePage(e){this.controller_.remove(e)}on(e,i){const l=i.bind(this);return this.emitter_.on(e,d=>{l(d.event)}),this}setUpPageApi_(e){const i=this.rackApi_.apiSet_.find(d=>d.controller_===e.contentController);if(!i)throw v.shouldNeverHappen();const l=new Bs(e,i);this.pageApiMap_.set(e,l)}onPageAdd_(e){this.setUpPageApi_(e.item)}onPageRemove_(e){if(!this.pageApiMap_.get(e.item))throw v.shouldNeverHappen();this.pageApiMap_.delete(e.item)}}const an=C("tab");class jl{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(an(),ks()),i.viewProps.bindClassModifiers(this.element),T(i.empty,R(this.element,an(void 0,"nop")));const l=e.createElement("div");l.classList.add(an("i")),this.element.appendChild(l),this.itemsElement=l;const d=i.contentsElement;d.classList.add(an("c")),this.element.appendChild(d),this.contentsElement=d}}class Us extends Kn{constructor(e,i){const l=new Ei(e,{blade:i.blade,viewProps:i.viewProps}),d=N(!0);super({blade:i.blade,rackController:l,view:new jl(e,{contentsElement:l.view.element,empty:d,viewProps:i.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onPageSelectedChange_=this.onPageSelectedChange_.bind(this),this.pageSet_=new Fn(()=>null),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.empty_=d,this.applyPages_()}get pageSet(){return this.pageSet_}add(e,i){this.pageSet_.add(e,i??this.pageSet_.items.length)}remove(e){this.pageSet_.remove(this.pageSet_.items[e])}applyPages_(){this.keepSelection_(),this.empty_.rawValue=this.pageSet_.items.length===0}onPageAdd_(e){const i=e.item;ys(this.view.itemsElement,i.itemController.view.element,e.index),this.rackController.rack.add(i.contentController,e.index),i.props.value("selected").emitter.on("change",this.onPageSelectedChange_),this.applyPages_()}onPageRemove_(e){const i=e.item;Es(i.itemController.view.element),this.rackController.rack.remove(i.contentController),i.props.value("selected").emitter.off("change",this.onPageSelectedChange_),this.applyPages_()}keepSelection_(){if(this.pageSet_.items.length===0)return;const e=this.pageSet_.items.findIndex(i=>i.props.get("selected"));e<0?this.pageSet_.items.forEach((i,l)=>{i.props.set("selected",l===0)}):this.pageSet_.items.forEach((i,l)=>{i.props.set("selected",l===e)})}onPageSelectedChange_(e){if(e.rawValue){const i=this.pageSet_.items.findIndex(l=>l.props.value("selected")===e.sender);this.pageSet_.items.forEach((l,d)=>{l.props.set("selected",d===i)})}else this.keepSelection_()}}const Vs={id:"tab",type:"blade",accept(r){const e=W,i=q(r,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return!i||i.pages.length===0?null:{params:i}},controller(r){const e=new Us(r.document,{blade:r.blade,viewProps:r.viewProps});return r.params.pages.forEach(i=>{const l=new Ls(r.document,{itemProps:L.fromObject({selected:!1,title:i.title}),props:L.fromObject({selected:!1})});e.add(l)}),e},api(r){return r.controller instanceof Us?new Is(r.controller,r.pool):null}};function Kl(r,e){const i=r.accept(e.params);if(!i)return null;const l=W.optional.boolean(e.params.disabled).value,d=W.optional.boolean(e.params.hidden).value;return r.controller({blade:xi(),document:e.document,params:Object.assign(Object.assign({},i.params),{disabled:l,hidden:d}),viewProps:st.create({disabled:l,hidden:d})})}class Yl{constructor(){this.disabled=!1,this.emitter=new w}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class Wl{constructor(e,i){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new w,this.interval_=i,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class Ct{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((i,l)=>l.constrain(i),e)}}function Ge(r,e){if(r instanceof e)return r;if(r instanceof Ct){const i=r.constraints.reduce((l,d)=>l||(d instanceof e?d:null),null);if(i)return i}return null}class Pi{constructor(e){this.options=e}constrain(e){const i=this.options;return i.length===0||i.filter(d=>d.value===e).length>0?e:i[0].value}}class Ce{constructor(e){this.maxValue=e.max,this.minValue=e.min}constrain(e){let i=e;return m(this.minValue)||(i=Math.max(i,this.minValue)),m(this.maxValue)||(i=Math.min(i,this.maxValue)),i}}class Pt{constructor(e){this.step=e}constrain(e){return(e<0?-Math.round(-e/this.step):Math.round(e/this.step))*this.step}}const qn=C("lst");class ql{constructor(e,i){this.onValueChange_=this.onValueChange_.bind(this),this.props_=i.props,this.element=e.createElement("div"),this.element.classList.add(qn()),i.viewProps.bindClassModifiers(this.element);const l=e.createElement("select");l.classList.add(qn("s")),M(this.props_,"options",b=>{Cs(l),b.forEach((y,A)=>{const B=e.createElement("option");B.dataset.index=String(A),B.textContent=y.text,B.value=String(y.value),l.appendChild(B)})}),i.viewProps.bindDisabled(l),this.element.appendChild(l),this.selectElement=l;const d=e.createElement("div");d.classList.add(qn("m")),d.appendChild(rn(e,"dropdown")),this.element.appendChild(d),i.value.emitter.on("change",this.onValueChange_),this.value_=i.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class Si{constructor(e,i){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=i.props,this.value=i.value,this.viewProps=i.viewProps,this.view=new ql(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const l=e.currentTarget.selectedOptions.item(0);if(!l)return;const d=Number(l.dataset.index);this.value.rawValue=this.props.get("options")[d].value}}const Ns=C("pop");class $l{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(Ns()),i.viewProps.bindClassModifiers(this.element),T(i.shows,R(this.element,Ns(void 0,"v")))}}class zs{constructor(e,i){this.shows=N(!1),this.viewProps=i.viewProps,this.view=new $l(e,{shows:this.shows,viewProps:this.viewProps})}}const Fs=C("txt");class Xl{constructor(e,i){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Fs()),i.viewProps.bindClassModifiers(this.element),this.props_=i.props,this.props_.emitter.on("change",this.onChange_);const l=e.createElement("input");l.classList.add(Fs("i")),l.type="text",i.viewProps.bindDisabled(l),this.element.appendChild(l),this.inputElement=l,i.value.emitter.on("change",this.onChange_),this.value_=i.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class ln{constructor(e,i){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=i.parser,this.props=i.props,this.value=i.value,this.viewProps=i.viewProps,this.view=new Xl(e,{props:i.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const l=e.currentTarget.value,d=this.parser_(l);m(d)||(this.value.rawValue=d),this.view.refresh()}}function Zl(r){return String(r)}function Hs(r){return r==="false"?!1:!!r}function Gs(r){return Zl(r)}class Ql{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const Jl={"**":(r,e)=>Math.pow(r,e),"*":(r,e)=>r*e,"/":(r,e)=>r/e,"%":(r,e)=>r%e,"+":(r,e)=>r+e,"-":(r,e)=>r-e,"<<":(r,e)=>r<<e,">>":(r,e)=>r>>e,">>>":(r,e)=>r>>>e,"&":(r,e)=>r&e,"^":(r,e)=>r^e,"|":(r,e)=>r|e};class eh{constructor(e,i,l){this.left=i,this.operator=e,this.right=l}evaluate(){const e=Jl[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const th={"+":r=>r,"-":r=>-r,"~":r=>~r};class ih{constructor(e,i){this.operator=e,this.expression=i}evaluate(){const e=th[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function $n(r){return(e,i)=>{for(let l=0;l<r.length;l++){const d=r[l](e,i);if(d!=="")return d}return""}}function Ti(r,e){var i;const l=r.substr(e).match(/^\s+/);return(i=l&&l[0])!==null&&i!==void 0?i:""}function nh(r,e){const i=r.substr(e,1);return i.match(/^[1-9]$/)?i:""}function Mi(r,e){var i;const l=r.substr(e).match(/^[0-9]+/);return(i=l&&l[0])!==null&&i!==void 0?i:""}function rh(r,e){const i=Mi(r,e);if(i!=="")return i;const l=r.substr(e,1);if(e+=1,l!=="-"&&l!=="+")return"";const d=Mi(r,e);return d===""?"":l+d}function Xn(r,e){const i=r.substr(e,1);if(e+=1,i.toLowerCase()!=="e")return"";const l=rh(r,e);return l===""?"":i+l}function js(r,e){const i=r.substr(e,1);if(i==="0")return i;const l=nh(r,e);return e+=l.length,l===""?"":l+Mi(r,e)}function sh(r,e){const i=js(r,e);if(e+=i.length,i==="")return"";const l=r.substr(e,1);if(e+=l.length,l!==".")return"";const d=Mi(r,e);return e+=d.length,i+l+d+Xn(r,e)}function oh(r,e){const i=r.substr(e,1);if(e+=i.length,i!==".")return"";const l=Mi(r,e);return e+=l.length,l===""?"":i+l+Xn(r,e)}function ah(r,e){const i=js(r,e);return e+=i.length,i===""?"":i+Xn(r,e)}const lh=$n([sh,oh,ah]);function hh(r,e){var i;const l=r.substr(e).match(/^[01]+/);return(i=l&&l[0])!==null&&i!==void 0?i:""}function uh(r,e){const i=r.substr(e,2);if(e+=i.length,i.toLowerCase()!=="0b")return"";const l=hh(r,e);return l===""?"":i+l}function ch(r,e){var i;const l=r.substr(e).match(/^[0-7]+/);return(i=l&&l[0])!==null&&i!==void 0?i:""}function dh(r,e){const i=r.substr(e,2);if(e+=i.length,i.toLowerCase()!=="0o")return"";const l=ch(r,e);return l===""?"":i+l}function ph(r,e){var i;const l=r.substr(e).match(/^[0-9a-f]+/i);return(i=l&&l[0])!==null&&i!==void 0?i:""}function fh(r,e){const i=r.substr(e,2);if(e+=i.length,i.toLowerCase()!=="0x")return"";const l=ph(r,e);return l===""?"":i+l}const mh=$n([uh,dh,fh]),vh=$n([mh,lh]);function _h(r,e){const i=vh(r,e);return e+=i.length,i===""?null:{evaluable:new Ql(i),cursor:e}}function gh(r,e){const i=r.substr(e,1);if(e+=i.length,i!=="(")return null;const l=Ys(r,e);if(!l)return null;e=l.cursor,e+=Ti(r,e).length;const d=r.substr(e,1);return e+=d.length,d!==")"?null:{evaluable:l.evaluable,cursor:e}}function bh(r,e){return _h(r,e)||gh(r,e)}function Ks(r,e){const i=bh(r,e);if(i)return i;const l=r.substr(e,1);if(e+=l.length,l!=="+"&&l!=="-"&&l!=="~")return null;const d=Ks(r,e);return d?(e=d.cursor,{cursor:e,evaluable:new ih(l,d.evaluable)}):null}function xh(r,e,i){i+=Ti(e,i).length;const l=r.filter(d=>e.startsWith(d,i))[0];return l?(i+=l.length,i+=Ti(e,i).length,{cursor:i,operator:l}):null}function wh(r,e){return(i,l)=>{const d=r(i,l);if(!d)return null;l=d.cursor;let b=d.evaluable;for(;;){const y=xh(e,i,l);if(!y)break;l=y.cursor;const A=r(i,l);if(!A)return null;l=A.cursor,b=new eh(y.operator,b,A.evaluable)}return b?{cursor:l,evaluable:b}:null}}const yh=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((r,e)=>wh(r,e),Ks);function Ys(r,e){return e+=Ti(r,e).length,yh(r,e)}function Eh(r){const e=Ys(r,0);return!e||e.cursor+Ti(r,e.cursor).length!==r.length?null:e.evaluable}function Ze(r){var e;const i=Eh(r);return(e=i?.evaluate())!==null&&e!==void 0?e:null}function Ws(r){if(typeof r=="number")return r;if(typeof r=="string"){const e=Ze(r);if(!m(e))return e}return 0}function Ch(r){return String(r)}function _e(r){return e=>e.toFixed(Math.max(Math.min(r,20),0))}const Ph=_e(0);function hn(r){return Ph(r)+"%"}function qs(r){return String(r)}function Zn(r){return r}function $s(r,e){for(;r.length<e;)r.push(void 0)}function Sh(r){const e=[];return $s(e,r),N(e)}function Th(r){const e=r.indexOf(void 0);return e<0?r:r.slice(0,e)}function Mh(r,e){const i=[...Th(r),e];return i.length>r.length?i.splice(0,i.length-r.length):$s(i,r.length),i}function ki({primary:r,secondary:e,forward:i,backward:l}){let d=!1;function b(y){d||(d=!0,y(),d=!1)}r.emitter.on("change",y=>{b(()=>{e.setRawValue(i(r,e),y.options)})}),e.emitter.on("change",y=>{b(()=>{r.setRawValue(l(r,e),y.options)}),b(()=>{e.setRawValue(i(r,e),y.options)})}),b(()=>{e.setRawValue(i(r,e),{forceEmit:!1,last:!0})})}function ge(r,e){const i=r*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+i:e.downKey?-i:0}function Ai(r){return{altKey:r.altKey,downKey:r.key==="ArrowDown",shiftKey:r.shiftKey,upKey:r.key==="ArrowUp"}}function Qe(r){return{altKey:r.altKey,downKey:r.key==="ArrowLeft",shiftKey:r.shiftKey,upKey:r.key==="ArrowRight"}}function kh(r){return r==="ArrowUp"||r==="ArrowDown"}function Xs(r){return kh(r)||r==="ArrowLeft"||r==="ArrowRight"}function Qn(r,e){const i=e.ownerDocument.defaultView,l=e.getBoundingClientRect();return{x:r.pageX-((i&&i.scrollX||0)+l.left),y:r.pageY-((i&&i.scrollY||0)+l.top)}}class St{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new w,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const i=this.elem_.getBoundingClientRect();return{bounds:{width:i.width,height:i.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var i;e.preventDefault(),(i=e.currentTarget)===null||i===void 0||i.focus();const l=this.elem_.ownerDocument;l.addEventListener("mousemove",this.onDocumentMouseMove_),l.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Qn(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Qn(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const i=this.elem_.ownerDocument;i.removeEventListener("mousemove",this.onDocumentMouseMove_),i.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Qn(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const i=e.targetTouches.item(0),l=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-l.left,y:i.clientY-l.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=i}onTouchMove_(e){const i=e.targetTouches.item(0),l=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-l.left,y:i.clientY-l.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=i}onTouchEnd_(e){var i;const l=(i=e.targetTouches.item(0))!==null&&i!==void 0?i:this.lastTouch_,d=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(l?{x:l.clientX-d.left,y:l.clientY-d.top}:void 0),sender:this,shiftKey:e.shiftKey})}}function te(r,e,i,l,d){const b=(r-e)/(i-e);return l+b*(d-l)}function Zs(r){return String(r.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function J(r,e,i){return Math.min(Math.max(r,e),i)}function Jn(r,e){return(r%e+e)%e}const ke=C("txt");class Ah{constructor(e,i){this.onChange_=this.onChange_.bind(this),this.props_=i.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(ke(),ke(void 0,"num")),i.arrayPosition&&this.element.classList.add(ke(void 0,i.arrayPosition)),i.viewProps.bindClassModifiers(this.element);const l=e.createElement("input");l.classList.add(ke("i")),l.type="text",i.viewProps.bindDisabled(l),this.element.appendChild(l),this.inputElement=l,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=i.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(ke()),this.inputElement.classList.add(ke("i"));const d=e.createElement("div");d.classList.add(ke("k")),this.element.appendChild(d),this.knobElement=d;const b=e.createElementNS(Fe,"svg");b.classList.add(ke("g")),this.knobElement.appendChild(b);const y=e.createElementNS(Fe,"path");y.classList.add(ke("gb")),b.appendChild(y),this.guideBodyElem_=y;const A=e.createElementNS(Fe,"path");A.classList.add(ke("gh")),b.appendChild(A),this.guideHeadElem_=A;const B=e.createElement("div");B.classList.add(C("tt")()),this.knobElement.appendChild(B),this.tooltipElem_=B,i.value.emitter.on("change",this.onChange_),this.value=i.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(ke(void 0,"drg"));return}this.element.classList.add(ke(void 0,"drg"));const i=e.rawValue/this.props_.get("draggingScale"),l=i+(i>0?-1:i<0?1:0),d=J(-l,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${l+d},0 L${l},4 L${l+d},8`,`M ${i},-1 L${i},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${i},4`);const b=this.props_.get("formatter");this.tooltipElem_.textContent=b(this.value.rawValue),this.tooltipElem_.style.left=`${i}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class Ri{constructor(e,i){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=i.baseStep,this.parser_=i.parser,this.props=i.props,this.value=i.value,this.viewProps=i.viewProps,this.dragging_=N(null),this.view=new Ah(e,{arrayPosition:i.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const l=new St(this.view.knobElement);l.emitter.on("down",this.onPointerDown_),l.emitter.on("move",this.onPointerMove_),l.emitter.on("up",this.onPointerUp_)}onInputChange_(e){const l=e.currentTarget.value,d=this.parser_(l);m(d)||(this.value.rawValue=d),this.view.refresh()}onInputKeyDown_(e){const i=ge(this.baseStep_,Ai(e));i!==0&&this.value.setRawValue(this.value.rawValue+i,{forceEmit:!1,last:!1})}onInputKeyUp_(e){ge(this.baseStep_,Ai(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const i=e.point.x-e.bounds.width/2;return this.originRawValue_+i*this.props.get("draggingScale")}onPointerMove_(e){const i=this.computeDraggingValue_(e.data);i!==null&&(this.value.setRawValue(i,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const i=this.computeDraggingValue_(e.data);i!==null&&(this.value.setRawValue(i,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const er=C("sld");class Rh{constructor(e,i){this.onChange_=this.onChange_.bind(this),this.props_=i.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(er()),i.viewProps.bindClassModifiers(this.element);const l=e.createElement("div");l.classList.add(er("t")),i.viewProps.bindTabIndex(l),this.element.appendChild(l),this.trackElement=l;const d=e.createElement("div");d.classList.add(er("k")),this.trackElement.appendChild(d),this.knobElement=d,i.value.emitter.on("change",this.onChange_),this.value=i.value,this.update_()}update_(){const e=J(te(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}}class Dh{constructor(e,i){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=i.baseStep,this.value=i.value,this.viewProps=i.viewProps,this.props=i.props,this.view=new Rh(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new St(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,i){e.point&&this.value.setRawValue(te(J(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),i)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const i=ge(this.baseStep_,Qe(e));i!==0&&this.value.setRawValue(this.value.rawValue+i,{forceEmit:!1,last:!1})}onKeyUp_(e){ge(this.baseStep_,Qe(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const tr=C("sldtxt");class Oh{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(tr());const l=e.createElement("div");l.classList.add(tr("s")),this.sliderView_=i.sliderView,l.appendChild(this.sliderView_.element),this.element.appendChild(l);const d=e.createElement("div");d.classList.add(tr("t")),this.textView_=i.textView,d.appendChild(this.textView_.element),this.element.appendChild(d)}}class ir{constructor(e,i){this.value=i.value,this.viewProps=i.viewProps,this.sliderC_=new Dh(e,{baseStep:i.baseStep,props:i.sliderProps,value:i.value,viewProps:this.viewProps}),this.textC_=new Ri(e,{baseStep:i.baseStep,parser:i.parser,props:i.textProps,value:i.value,viewProps:i.viewProps}),this.view=new Oh(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function Di(r,e){r.write(e)}function un(r){const e=W;if(Array.isArray(r))return e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(r).value;if(typeof r=="object")return e.required.raw(r).value}function Qs(r){if(r==="inline"||r==="popup")return r}function ot(r){const e=W;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(r).value}function Js(r){if(Array.isArray(r))return r;const e=[];return Object.keys(r).forEach(i=>{e.push({text:i,value:r[i]})}),e}function nr(r){return m(r)?null:new Pi(Js(r))}function rr(r){const e=r?Ge(r,Pi):null;return e?e.options:null}function Lh(r){const e=r?Ge(r,Pt):null;return e?e.step:null}function cn(r,e){const i=r&&Ge(r,Pt);return i?Zs(i.step):Math.max(Zs(e),2)}function qt(r){const e=Lh(r);return e??1}function $t(r,e){var i;const l=r&&Ge(r,Pt),d=Math.abs((i=l?.step)!==null&&i!==void 0?i:e);return d===0?.1:Math.pow(10,Math.floor(Math.log10(d))-1)}const dn=C("ckb");class Bh{constructor(e,i){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(dn()),i.viewProps.bindClassModifiers(this.element);const l=e.createElement("label");l.classList.add(dn("l")),this.element.appendChild(l);const d=e.createElement("input");d.classList.add(dn("i")),d.type="checkbox",l.appendChild(d),this.inputElement=d,i.viewProps.bindDisabled(this.inputElement);const b=e.createElement("div");b.classList.add(dn("w")),l.appendChild(b);const y=rn(e,"check");b.appendChild(y),i.value.emitter.on("change",this.onValueChange_),this.value=i.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class Ih{constructor(e,i){this.onInputChange_=this.onInputChange_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.view=new Bh(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const i=e.currentTarget;this.value.rawValue=i.checked}}function Uh(r){const e=[],i=nr(r.options);return i&&e.push(i),new Ct(e)}const Vh={id:"input-bool",type:"input",accept:(r,e)=>{if(typeof r!="boolean")return null;const l=q(e,{options:W.optional.custom(un)});return l?{initialValue:r,params:l}:null},binding:{reader:r=>Hs,constraint:r=>Uh(r.params),writer:r=>Di},controller:r=>{var e;const i=r.document,l=r.value,d=r.constraint;return d&&Ge(d,Pi)?new Si(i,{props:L.fromObject({options:(e=rr(d))!==null&&e!==void 0?e:[]}),value:l,viewProps:r.viewProps}):new Ih(i,{value:l,viewProps:r.viewProps})}},Tt=C("col");class Nh{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(Tt()),i.foldable.bindExpandedClass(this.element,Tt(void 0,"expanded")),M(i.foldable,"completed",R(this.element,Tt(void 0,"cpl")));const l=e.createElement("div");l.classList.add(Tt("h")),this.element.appendChild(l);const d=e.createElement("div");d.classList.add(Tt("s")),l.appendChild(d),this.swatchElement=d;const b=e.createElement("div");if(b.classList.add(Tt("t")),l.appendChild(b),this.textElement=b,i.pickerLayout==="inline"){const y=e.createElement("div");y.classList.add(Tt("p")),this.element.appendChild(y),this.pickerElement=y}else this.pickerElement=null}}function zh(r,e,i){const l=J(r/255,0,1),d=J(e/255,0,1),b=J(i/255,0,1),y=Math.max(l,d,b),A=Math.min(l,d,b),B=y-A;let I=0,H=0;const j=(A+y)/2;return B!==0&&(H=B/(1-Math.abs(y+A-1)),l===y?I=(d-b)/B:d===y?I=2+(b-l)/B:I=4+(l-d)/B,I=I/6+(I<0?1:0)),[I*360,H*100,j*100]}function Fh(r,e,i){const l=(r%360+360)%360,d=J(e/100,0,1),b=J(i/100,0,1),y=(1-Math.abs(2*b-1))*d,A=y*(1-Math.abs(l/60%2-1)),B=b-y/2;let I,H,j;return l>=0&&l<60?[I,H,j]=[y,A,0]:l>=60&&l<120?[I,H,j]=[A,y,0]:l>=120&&l<180?[I,H,j]=[0,y,A]:l>=180&&l<240?[I,H,j]=[0,A,y]:l>=240&&l<300?[I,H,j]=[A,0,y]:[I,H,j]=[y,0,A],[(I+B)*255,(H+B)*255,(j+B)*255]}function Hh(r,e,i){const l=J(r/255,0,1),d=J(e/255,0,1),b=J(i/255,0,1),y=Math.max(l,d,b),A=Math.min(l,d,b),B=y-A;let I;B===0?I=0:y===l?I=60*(((d-b)/B%6+6)%6):y===d?I=60*((b-l)/B+2):I=60*((l-d)/B+4);const H=y===0?0:B/y,j=y;return[I,H*100,j*100]}function eo(r,e,i){const l=Jn(r,360),d=J(e/100,0,1),b=J(i/100,0,1),y=b*d,A=y*(1-Math.abs(l/60%2-1)),B=b-y;let I,H,j;return l>=0&&l<60?[I,H,j]=[y,A,0]:l>=60&&l<120?[I,H,j]=[A,y,0]:l>=120&&l<180?[I,H,j]=[0,y,A]:l>=180&&l<240?[I,H,j]=[0,A,y]:l>=240&&l<300?[I,H,j]=[A,0,y]:[I,H,j]=[y,0,A],[(I+B)*255,(H+B)*255,(j+B)*255]}function Gh(r,e,i){const l=i+e*(100-Math.abs(2*i-100))/200;return[r,l!==0?e*(100-Math.abs(2*i-100))/l:0,i+e*(100-Math.abs(2*i-100))/200]}function jh(r,e,i){const l=100-Math.abs(i*(200-e)/100-100);return[r,l!==0?e*i/l:0,i*(200-e)/200]}function Xt(r){return[r[0],r[1],r[2]]}function to(r,e){return[r[0],r[1],r[2],e]}const Kh={hsl:{hsl:(r,e,i)=>[r,e,i],hsv:Gh,rgb:Fh},hsv:{hsl:jh,hsv:(r,e,i)=>[r,e,i],rgb:eo},rgb:{hsl:zh,hsv:Hh,rgb:(r,e,i)=>[r,e,i]}};function Yh(r,e,i){return Kh[e][i](...r)}const Wh={hsl:r=>{var e;return[Jn(r[0],360),J(r[1],0,100),J(r[2],0,100),J((e=r[3])!==null&&e!==void 0?e:1,0,1)]},hsv:r=>{var e;return[Jn(r[0],360),J(r[1],0,100),J(r[2],0,100),J((e=r[3])!==null&&e!==void 0?e:1,0,1)]},rgb:r=>{var e;return[J(r[0],0,255),J(r[1],0,255),J(r[2],0,255),J((e=r[3])!==null&&e!==void 0?e:1,0,1)]}};function pn(r,e){return typeof r!="object"||m(r)?!1:e in r&&typeof r[e]=="number"}class V{constructor(e,i){this.mode_=i,this.comps_=Wh[i](e)}static black(){return new V([0,0,0],"rgb")}static fromObject(e){const i="a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b];return new V(i,"rgb")}static toRgbaObject(e){return e.toRgbaObject()}static isRgbColorObject(e){return pn(e,"r")&&pn(e,"g")&&pn(e,"b")}static isRgbaColorObject(e){return this.isRgbColorObject(e)&&pn(e,"a")}static isColorObject(e){return this.isRgbColorObject(e)}static equals(e,i){if(e.mode_!==i.mode_)return!1;const l=e.comps_,d=i.comps_;for(let b=0;b<l.length;b++)if(l[b]!==d[b])return!1;return!0}get mode(){return this.mode_}getComponents(e){return to(Yh(Xt(this.comps_),this.mode_,e||this.mode_),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const at=C("colp");class qh{constructor(e,i){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(at());const l=e.createElement("div");l.classList.add(at("hsv"));const d=e.createElement("div");d.classList.add(at("sv")),this.svPaletteView_=i.svPaletteView,d.appendChild(this.svPaletteView_.element),l.appendChild(d);const b=e.createElement("div");b.classList.add(at("h")),this.hPaletteView_=i.hPaletteView,b.appendChild(this.hPaletteView_.element),l.appendChild(b),this.element.appendChild(l);const y=e.createElement("div");if(y.classList.add(at("rgb")),this.textView_=i.textView,y.appendChild(this.textView_.element),this.element.appendChild(y),i.alphaViews){this.alphaViews_={palette:i.alphaViews.palette,text:i.alphaViews.text};const A=e.createElement("div");A.classList.add(at("a"));const B=e.createElement("div");B.classList.add(at("ap")),B.appendChild(this.alphaViews_.palette.element),A.appendChild(B);const I=e.createElement("div");I.classList.add(at("at")),I.appendChild(this.alphaViews_.text.element),A.appendChild(I),this.element.appendChild(A)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map(i=>i.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function sr(r){const e=W;return q(r,{alpha:e.optional.boolean,expanded:e.optional.boolean,picker:e.optional.custom(Qs)})}function Mt(r){return r?.1:1}function Ae(r,e){const i=r.match(/^(.+)%$/);return Math.min(i?parseFloat(i[1])*.01*e:parseFloat(r),e)}const $h={deg:r=>r,grad:r=>r*360/400,rad:r=>r*360/(2*Math.PI),turn:r=>r*360};function io(r){const e=r.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(r);const i=parseFloat(e[1]),l=e[2];return $h[l](i)}const or={"func.rgb":r=>{const e=r.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[Ae(e[1],255),Ae(e[2],255),Ae(e[3],255)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:new V(i,"rgb")},"func.rgba":r=>{const e=r.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[Ae(e[1],255),Ae(e[2],255),Ae(e[3],255),Ae(e[4],1)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:new V(i,"rgb")},"func.hsl":r=>{const e=r.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[io(e[1]),Ae(e[2],100),Ae(e[3],100)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:new V(i,"hsl")},"func.hsla":r=>{const e=r.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[io(e[1]),Ae(e[2],100),Ae(e[3],100),Ae(e[4],1)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:new V(i,"hsl")},"hex.rgb":r=>{const e=r.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return new V([parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)],"rgb");const i=r.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return i?new V([parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)],"rgb"):null},"hex.rgba":r=>{const e=r.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return new V([parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),te(parseInt(e[4]+e[4],16),0,255,0,1)],"rgb");const i=r.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return i?new V([parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16),te(parseInt(i[4],16),0,255,0,1)],"rgb"):null}};function fn(r){return Object.keys(or).reduce((i,l)=>{if(i)return i;const d=or[l];return d(r)?l:null},null)}const mn=r=>{const e=fn(r);return e?or[e](r):null};function Xh(r){return r==="func.hsla"||r==="func.rgba"||r==="hex.rgba"}function Zh(r){if(typeof r=="string"){const e=mn(r);if(e)return e}return V.black()}function no(r){const e=J(Math.floor(r),0,255).toString(16);return e.length===1?`0${e}`:e}function ar(r,e="#"){const i=Xt(r.getComponents("rgb")).map(no).join("");return`${e}${i}`}function vn(r,e="#"){const i=r.getComponents("rgb"),l=[i[0],i[1],i[2],i[3]*255].map(no).join("");return`${e}${l}`}function ro(r){const e=_e(0);return`rgb(${Xt(r.getComponents("rgb")).map(l=>e(l)).join(", ")})`}function _n(r){const e=_e(2),i=_e(0);return`rgba(${r.getComponents("rgb").map((d,b)=>(b===3?e:i)(d)).join(", ")})`}function Qh(r){const e=[_e(0),hn,hn];return`hsl(${Xt(r.getComponents("hsl")).map((l,d)=>e[d](l)).join(", ")})`}function Jh(r){const e=[_e(0),hn,hn,_e(2)];return`hsla(${r.getComponents("hsl").map((l,d)=>e[d](l)).join(", ")})`}const eu={"func.hsl":Qh,"func.hsla":Jh,"func.rgb":ro,"func.rgba":_n,"hex.rgb":ar,"hex.rgba":vn};function so(r){return eu[r]}const Oi=C("apl");class tu{constructor(e,i){this.onValueChange_=this.onValueChange_.bind(this),this.value=i.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Oi()),i.viewProps.bindTabIndex(this.element);const l=e.createElement("div");l.classList.add(Oi("b")),this.element.appendChild(l);const d=e.createElement("div");d.classList.add(Oi("c")),l.appendChild(d),this.colorElem_=d;const b=e.createElement("div");b.classList.add(Oi("m")),this.element.appendChild(b),this.markerElem_=b;const y=e.createElement("div");y.classList.add(Oi("p")),this.markerElem_.appendChild(y),this.previewElem_=y,this.update_()}update_(){const e=this.value.rawValue,i=e.getComponents("rgb"),l=new V([i[0],i[1],i[2],0],"rgb"),d=new V([i[0],i[1],i[2],255],"rgb"),b=["to right",_n(l),_n(d)];this.colorElem_.style.background=`linear-gradient(${b.join(",")})`,this.previewElem_.style.backgroundColor=_n(e);const y=te(i[3],0,1,0,100);this.markerElem_.style.left=`${y}%`}onValueChange_(){this.update_()}}class iu{constructor(e,i){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.view=new tu(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new St(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,i){if(!e.point)return;const l=e.point.x/e.bounds.width,d=this.value.rawValue,[b,y,A]=d.getComponents("hsv");this.value.setRawValue(new V([b,y,A,l],"hsv"),i)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const i=ge(Mt(!0),Qe(e));if(i===0)return;const l=this.value.rawValue,[d,b,y,A]=l.getComponents("hsv");this.value.setRawValue(new V([d,b,y,A+i],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){ge(Mt(!0),Qe(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Zt=C("coltxt");function nu(r){const e=r.createElement("select"),i=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return e.appendChild(i.reduce((l,d)=>{const b=r.createElement("option");return b.textContent=d.text,b.value=d.value,l.appendChild(b),l},r.createDocumentFragment())),e}class ru{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(Zt());const l=e.createElement("div");l.classList.add(Zt("m")),this.modeElem_=nu(e),this.modeElem_.classList.add(Zt("ms")),l.appendChild(this.modeSelectElement);const d=e.createElement("div");d.classList.add(Zt("mm")),d.appendChild(rn(e,"dropdown")),l.appendChild(d),this.element.appendChild(l);const b=e.createElement("div");b.classList.add(Zt("w")),this.element.appendChild(b),this.textsElem_=b,this.textViews_=i.textViews,this.applyTextViews_(),T(i.colorMode,y=>{this.modeElem_.value=y})}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(e){this.textViews_=e,this.applyTextViews_()}applyTextViews_(){Cs(this.textsElem_);const e=this.element.ownerDocument;this.textViews_.forEach(i=>{const l=e.createElement("div");l.classList.add(Zt("c")),l.appendChild(i.element),this.textsElem_.appendChild(l)})}}const su=_e(0),ou={rgb:()=>new Ce({min:0,max:255}),hsl:r=>r===0?new Ce({min:0,max:360}):new Ce({min:0,max:100}),hsv:r=>r===0?new Ce({min:0,max:360}):new Ce({min:0,max:100})};function lr(r,e,i){return new Ri(r,{arrayPosition:i===0?"fst":i===2?"lst":"mid",baseStep:Mt(!1),parser:e.parser,props:L.fromObject({draggingScale:1,formatter:su}),value:N(0,{constraint:ou[e.colorMode](i)}),viewProps:e.viewProps})}class au{constructor(e,i){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.parser_=i.parser,this.value=i.value,this.viewProps=i.viewProps,this.colorMode=N(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new ru(e,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const i={colorMode:this.colorMode.rawValue,parser:this.parser_,viewProps:this.viewProps},l=[lr(e,i,0),lr(e,i,1),lr(e,i,2)];return l.forEach((d,b)=>{ki({primary:this.value,secondary:d.value,forward:y=>y.rawValue.getComponents(this.colorMode.rawValue)[b],backward:(y,A)=>{const B=this.colorMode.rawValue,I=y.rawValue.getComponents(B);return I[b]=A.rawValue,new V(to(Xt(I),I[3]),B)}})}),l}onModeSelectChange_(e){const i=e.currentTarget;this.colorMode.rawValue=i.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const hr=C("hpl");class lu{constructor(e,i){this.onValueChange_=this.onValueChange_.bind(this),this.value=i.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(hr()),i.viewProps.bindTabIndex(this.element);const l=e.createElement("div");l.classList.add(hr("c")),this.element.appendChild(l);const d=e.createElement("div");d.classList.add(hr("m")),this.element.appendChild(d),this.markerElem_=d,this.update_()}update_(){const e=this.value.rawValue,[i]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=ro(new V([i,100,100],"hsv"));const l=te(i,0,360,0,100);this.markerElem_.style.left=`${l}%`}onValueChange_(){this.update_()}}class hu{constructor(e,i){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.view=new lu(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new St(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,i){if(!e.point)return;const l=te(J(e.point.x,0,e.bounds.width),0,e.bounds.width,0,359),d=this.value.rawValue,[,b,y,A]=d.getComponents("hsv");this.value.setRawValue(new V([l,b,y,A],"hsv"),i)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const i=ge(Mt(!1),Qe(e));if(i===0)return;const l=this.value.rawValue,[d,b,y,A]=l.getComponents("hsv");this.value.setRawValue(new V([d+i,b,y,A],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){ge(Mt(!1),Qe(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const ur=C("svp"),oo=64;class uu{constructor(e,i){this.onValueChange_=this.onValueChange_.bind(this),this.value=i.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(ur()),i.viewProps.bindTabIndex(this.element);const l=e.createElement("canvas");l.height=oo,l.width=oo,l.classList.add(ur("c")),this.element.appendChild(l),this.canvasElement=l;const d=e.createElement("div");d.classList.add(ur("m")),this.element.appendChild(d),this.markerElem_=d,this.update_()}update_(){const e=xl(this.canvasElement);if(!e)return;const l=this.value.rawValue.getComponents("hsv"),d=this.canvasElement.width,b=this.canvasElement.height,y=e.getImageData(0,0,d,b),A=y.data;for(let H=0;H<b;H++)for(let j=0;j<d;j++){const kt=te(j,0,d,0,100),Bi=te(H,0,b,100,0),Ii=eo(l[0],kt,Bi),ti=(H*d+j)*4;A[ti]=Ii[0],A[ti+1]=Ii[1],A[ti+2]=Ii[2],A[ti+3]=255}e.putImageData(y,0,0);const B=te(l[1],0,100,0,100);this.markerElem_.style.left=`${B}%`;const I=te(l[2],0,100,100,0);this.markerElem_.style.top=`${I}%`}onValueChange_(){this.update_()}}class cu{constructor(e,i){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.view=new uu(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new St(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,i){if(!e.point)return;const l=te(e.point.x,0,e.bounds.width,0,100),d=te(e.point.y,0,e.bounds.height,100,0),[b,,,y]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new V([b,l,d,y],"hsv"),i)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){Xs(e.key)&&e.preventDefault();const[i,l,d,b]=this.value.rawValue.getComponents("hsv"),y=Mt(!1),A=ge(y,Qe(e)),B=ge(y,Ai(e));A===0&&B===0||this.value.setRawValue(new V([i,l+A,d+B,b],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const i=Mt(!1),l=ge(i,Qe(e)),d=ge(i,Ai(e));l===0&&d===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class du{constructor(e,i){this.value=i.value,this.viewProps=i.viewProps,this.hPaletteC_=new hu(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new cu(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=i.supportsAlpha?{palette:new iu(e,{value:this.value,viewProps:this.viewProps}),text:new Ri(e,{parser:Ze,baseStep:.1,props:L.fromObject({draggingScale:.01,formatter:_e(2)}),value:N(0,{constraint:new Ce({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&ki({primary:this.value,secondary:this.alphaIcs_.text.value,forward:l=>l.rawValue.getComponents()[3],backward:(l,d)=>{const b=l.rawValue.getComponents();return b[3]=d.rawValue,new V(b,l.rawValue.mode)}}),this.textC_=new au(e,{parser:Ze,value:this.value,viewProps:this.viewProps}),this.view=new qh(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:i.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}get textController(){return this.textC_}}const cr=C("colsw");class pu{constructor(e,i){this.onValueChange_=this.onValueChange_.bind(this),i.value.emitter.on("change",this.onValueChange_),this.value=i.value,this.element=e.createElement("div"),this.element.classList.add(cr()),i.viewProps.bindClassModifiers(this.element);const l=e.createElement("div");l.classList.add(cr("sw")),this.element.appendChild(l),this.swatchElem_=l;const d=e.createElement("button");d.classList.add(cr("b")),i.viewProps.bindDisabled(d),this.element.appendChild(d),this.buttonElement=d,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=vn(e)}onValueChange_(){this.update_()}}class fu{constructor(e,i){this.value=i.value,this.viewProps=i.viewProps,this.view=new pu(e,{value:this.value,viewProps:this.viewProps})}}class dr{constructor(e,i){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.foldable_=wi.create(i.expanded),this.swatchC_=new fu(e,{value:this.value,viewProps:this.viewProps});const l=this.swatchC_.view.buttonElement;l.addEventListener("blur",this.onButtonBlur_),l.addEventListener("click",this.onButtonClick_),this.textC_=new ln(e,{parser:i.parser,props:L.fromObject({formatter:i.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new Nh(e,{foldable:this.foldable_,pickerLayout:i.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=i.pickerLayout==="popup"?new zs(e,{viewProps:this.viewProps}):null;const d=new du(e,{supportsAlpha:i.supportsAlpha,value:this.value,viewProps:this.viewProps});d.view.allFocusableElements.forEach(b=>{b.addEventListener("blur",this.onPopupChildBlur_),b.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=d,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(d.view.element),ki({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:b=>b.rawValue,backward:(b,y)=>y.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Nn(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const i=this.view.element,l=e.relatedTarget;(!l||!i.contains(l))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const i=this.popC_.view.element,l=Ps(e);l&&i.contains(l)||l&&l===this.swatchC_.view.buttonElement&&!Vn(i.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function mu(r){return V.isColorObject(r)?V.fromObject(r):V.black()}function vu(r){return Xt(r.getComponents("rgb")).reduce((e,i)=>e<<8|Math.floor(i)&255,0)}function _u(r){return r.getComponents("rgb").reduce((e,i,l)=>{const d=Math.floor(l===3?i*255:i)&255;return e<<8|d},0)>>>0}function gu(r){return new V([r>>16&255,r>>8&255,r&255],"rgb")}function bu(r){return new V([r>>24&255,r>>16&255,r>>8&255,te(r&255,0,255,0,1)],"rgb")}function xu(r){return typeof r!="number"?V.black():gu(r)}function wu(r){return typeof r!="number"?V.black():bu(r)}function yu(r){const e=so(r);return(i,l)=>{Di(i,e(l))}}function Eu(r){const e=r?_u:vu;return(i,l)=>{Di(i,e(l))}}function Cu(r,e){const i=e.toRgbaObject();r.writeProperty("r",i.r),r.writeProperty("g",i.g),r.writeProperty("b",i.b),r.writeProperty("a",i.a)}function Pu(r,e){const i=e.toRgbaObject();r.writeProperty("r",i.r),r.writeProperty("g",i.g),r.writeProperty("b",i.b)}function Su(r){return r?Cu:Pu}function pr(r){return"alpha"in r&&r.alpha===!0}function Tu(r){return r?e=>vn(e,"0x"):e=>ar(e,"0x")}const Mu={id:"input-color-number",type:"input",accept:(r,e)=>{if(typeof r!="number"||!("view"in e)||e.view!=="color")return null;const i=sr(e);return i?{initialValue:r,params:i}:null},binding:{reader:r=>pr(r.params)?wu:xu,equals:V.equals,writer:r=>Eu(pr(r.params))},controller:r=>{const e=pr(r.params),i="expanded"in r.params?r.params.expanded:void 0,l="picker"in r.params?r.params.picker:void 0;return new dr(r.document,{expanded:i??!1,formatter:Tu(e),parser:mn,pickerLayout:l??"popup",supportsAlpha:e,value:r.value,viewProps:r.viewProps})}};function ku(r){return V.isRgbaColorObject(r)}const Au={id:"input-color-object",type:"input",accept:(r,e)=>{if(!V.isColorObject(r))return null;const i=sr(e);return i?{initialValue:r,params:i}:null},binding:{reader:r=>mu,equals:V.equals,writer:r=>Su(ku(r.initialValue))},controller:r=>{const e=V.isRgbaColorObject(r.initialValue),i="expanded"in r.params?r.params.expanded:void 0,l="picker"in r.params?r.params.picker:void 0,d=e?vn:ar;return new dr(r.document,{expanded:i??!1,formatter:d,parser:mn,pickerLayout:l??"popup",supportsAlpha:e,value:r.value,viewProps:r.viewProps})}},Ru={id:"input-color-string",type:"input",accept:(r,e)=>{if(typeof r!="string"||"view"in e&&e.view==="text"||!fn(r))return null;const l=sr(e);return l?{initialValue:r,params:l}:null},binding:{reader:r=>Zh,equals:V.equals,writer:r=>{const e=fn(r.initialValue);if(!e)throw v.shouldNeverHappen();return yu(e)}},controller:r=>{const e=fn(r.initialValue);if(!e)throw v.shouldNeverHappen();const i=so(e),l="expanded"in r.params?r.params.expanded:void 0,d="picker"in r.params?r.params.picker:void 0;return new dr(r.document,{expanded:l??!1,formatter:i,parser:mn,pickerLayout:d??"popup",supportsAlpha:Xh(e),value:r.value,viewProps:r.viewProps})}};class lt{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const i=this.asm_.toComponents(e).map((l,d)=>{var b,y;return(y=(b=this.components[d])===null||b===void 0?void 0:b.constrain(l))!==null&&y!==void 0?y:l});return this.asm_.fromComponents(i)}}const ao=C("pndtxt");class Du{constructor(e,i){this.textViews=i.textViews,this.element=e.createElement("div"),this.element.classList.add(ao()),this.textViews.forEach(l=>{const d=e.createElement("div");d.classList.add(ao("a")),d.appendChild(l.element),this.element.appendChild(d)})}}function Ou(r,e,i){return new Ri(r,{arrayPosition:i===0?"fst":i===e.axes.length-1?"lst":"mid",baseStep:e.axes[i].baseStep,parser:e.parser,props:e.axes[i].textProps,value:N(0,{constraint:e.axes[i].constraint}),viewProps:e.viewProps})}class fr{constructor(e,i){this.value=i.value,this.viewProps=i.viewProps,this.acs_=i.axes.map((l,d)=>Ou(e,i,d)),this.acs_.forEach((l,d)=>{ki({primary:this.value,secondary:l.value,forward:b=>i.assembly.toComponents(b.rawValue)[d],backward:(b,y)=>{const A=i.assembly.toComponents(b.rawValue);return A[d]=y.rawValue,i.assembly.fromComponents(A)}})}),this.view=new Du(e,{textViews:this.acs_.map(l=>l.view)})}}function Lu(r){return"step"in r&&!m(r.step)?new Pt(r.step):null}function Bu(r){return"max"in r&&!m(r.max)||"min"in r&&!m(r.min)?new Ce({max:r.max,min:r.min}):null}function Iu(r){const e=[],i=Lu(r);i&&e.push(i);const l=Bu(r);l&&e.push(l);const d=nr(r.options);return d&&e.push(d),new Ct(e)}function Uu(r){const e=r?Ge(r,Ce):null;return e?[e.minValue,e.maxValue]:[void 0,void 0]}function Vu(r){const[e,i]=Uu(r);return[e??0,i??100]}const Nu={id:"input-number",type:"input",accept:(r,e)=>{if(typeof r!="number")return null;const i=W,l=q(e,{format:i.optional.function,max:i.optional.number,min:i.optional.number,options:i.optional.custom(un),step:i.optional.number});return l?{initialValue:r,params:l}:null},binding:{reader:r=>Ws,constraint:r=>Iu(r.params),writer:r=>Di},controller:r=>{var e,i;const l=r.value,d=r.constraint;if(d&&Ge(d,Pi))return new Si(r.document,{props:L.fromObject({options:(e=rr(d))!==null&&e!==void 0?e:[]}),value:l,viewProps:r.viewProps});const b=(i="format"in r.params?r.params.format:void 0)!==null&&i!==void 0?i:_e(cn(d,l.rawValue));if(d&&Ge(d,Ce)){const[y,A]=Vu(d);return new ir(r.document,{baseStep:qt(d),parser:Ze,sliderProps:L.fromObject({maxValue:A,minValue:y}),textProps:L.fromObject({draggingScale:$t(d,l.rawValue),formatter:b}),value:l,viewProps:r.viewProps})}return new Ri(r.document,{baseStep:qt(d),parser:Ze,props:L.fromObject({draggingScale:$t(d,l.rawValue),formatter:b}),value:l,viewProps:r.viewProps})}};class ht{constructor(e=0,i=0){this.x=e,this.y=i}getComponents(){return[this.x,this.y]}static isObject(e){if(m(e))return!1;const i=e.x,l=e.y;return!(typeof i!="number"||typeof l!="number")}static equals(e,i){return e.x===i.x&&e.y===i.y}toObject(){return{x:this.x,y:this.y}}}const lo={toComponents:r=>r.getComponents(),fromComponents:r=>new ht(...r)},Qt=C("p2d");class zu{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(Qt()),i.viewProps.bindClassModifiers(this.element),T(i.expanded,R(this.element,Qt(void 0,"expanded")));const l=e.createElement("div");l.classList.add(Qt("h")),this.element.appendChild(l);const d=e.createElement("button");d.classList.add(Qt("b")),d.appendChild(rn(e,"p2dpad")),i.viewProps.bindDisabled(d),l.appendChild(d),this.buttonElement=d;const b=e.createElement("div");if(b.classList.add(Qt("t")),l.appendChild(b),this.textElement=b,i.pickerLayout==="inline"){const y=e.createElement("div");y.classList.add(Qt("p")),this.element.appendChild(y),this.pickerElement=y}else this.pickerElement=null}}const ut=C("p2dp");class Fu{constructor(e,i){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=i.invertsY,this.maxValue_=i.maxValue,this.element=e.createElement("div"),this.element.classList.add(ut()),i.layout==="popup"&&this.element.classList.add(ut(void 0,"p"));const l=e.createElement("div");l.classList.add(ut("p")),i.viewProps.bindTabIndex(l),this.element.appendChild(l),this.padElement=l;const d=e.createElementNS(Fe,"svg");d.classList.add(ut("g")),this.padElement.appendChild(d),this.svgElem_=d;const b=e.createElementNS(Fe,"line");b.classList.add(ut("ax")),b.setAttributeNS(null,"x1","0"),b.setAttributeNS(null,"y1","50%"),b.setAttributeNS(null,"x2","100%"),b.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(b);const y=e.createElementNS(Fe,"line");y.classList.add(ut("ax")),y.setAttributeNS(null,"x1","50%"),y.setAttributeNS(null,"y1","0"),y.setAttributeNS(null,"x2","50%"),y.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(y);const A=e.createElementNS(Fe,"line");A.classList.add(ut("l")),A.setAttributeNS(null,"x1","50%"),A.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(A),this.lineElem_=A;const B=e.createElement("div");B.classList.add(ut("m")),this.padElement.appendChild(B),this.markerElem_=B,i.value.emitter.on("change",this.onValueChange_),this.value=i.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,i]=this.value.rawValue.getComponents(),l=this.maxValue_,d=te(e,-l,+l,0,100),b=te(i,-l,+l,0,100),y=this.invertsY_?100-b:b;this.lineElem_.setAttributeNS(null,"x2",`${d}%`),this.lineElem_.setAttributeNS(null,"y2",`${y}%`),this.markerElem_.style.left=`${d}%`,this.markerElem_.style.top=`${y}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function ho(r,e,i){return[ge(e[0],Qe(r)),ge(e[1],Ai(r))*(i?1:-1)]}class Hu{constructor(e,i){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.baseSteps_=i.baseSteps,this.maxValue_=i.maxValue,this.invertsY_=i.invertsY,this.view=new Fu(e,{invertsY:this.invertsY_,layout:i.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new St(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,i){if(!e.point)return;const l=this.maxValue_,d=te(e.point.x,0,e.bounds.width,-l,+l),b=te(this.invertsY_?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-l,+l);this.value.setRawValue(new ht(d,b),i)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){Xs(e.key)&&e.preventDefault();const[i,l]=ho(e,this.baseSteps_,this.invertsY_);i===0&&l===0||this.value.setRawValue(new ht(this.value.rawValue.x+i,this.value.rawValue.y+l),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[i,l]=ho(e,this.baseSteps_,this.invertsY_);i===0&&l===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Gu{constructor(e,i){var l,d;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.foldable_=wi.create(i.expanded),this.popC_=i.pickerLayout==="popup"?new zs(e,{viewProps:this.viewProps}):null;const b=new Hu(e,{baseSteps:[i.axes[0].baseStep,i.axes[1].baseStep],invertsY:i.invertsY,layout:i.pickerLayout,maxValue:i.maxValue,value:this.value,viewProps:this.viewProps});b.view.allFocusableElements.forEach(y=>{y.addEventListener("blur",this.onPopupChildBlur_),y.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=b,this.textC_=new fr(e,{assembly:lo,axes:i.axes,parser:i.parser,value:this.value,viewProps:this.viewProps}),this.view=new zu(e,{expanded:this.foldable_.value("expanded"),pickerLayout:i.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(l=this.view.buttonElement)===null||l===void 0||l.addEventListener("blur",this.onPadButtonBlur_),(d=this.view.buttonElement)===null||d===void 0||d.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),ki({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:y=>y.rawValue,backward:(y,A)=>A.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Nn(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(e){if(!this.popC_)return;const i=this.view.element,l=e.relatedTarget;(!l||!i.contains(l))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const i=this.popC_.view.element,l=Ps(e);l&&i.contains(l)||l&&l===this.view.buttonElement&&!Vn(i.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}}function ju(r){return ht.isObject(r)?new ht(r.x,r.y):new ht}function Ku(r,e){r.writeProperty("x",e.x),r.writeProperty("y",e.y)}function uo(r){if(!r)return;const e=[];return m(r.step)||e.push(new Pt(r.step)),(!m(r.max)||!m(r.min))&&e.push(new Ce({max:r.max,min:r.min})),new Ct(e)}function Yu(r){return new lt({assembly:lo,components:[uo("x"in r?r.x:void 0),uo("y"in r?r.y:void 0)]})}function co(r,e){const i=r&&Ge(r,Ce);if(i)return Math.max(Math.abs(i.minValue||0),Math.abs(i.maxValue||0));const l=qt(r);return Math.max(Math.abs(l)*10,Math.abs(e)*10)}function Wu(r,e){const i=e instanceof lt?e.components[0]:void 0,l=e instanceof lt?e.components[1]:void 0,d=co(i,r.x),b=co(l,r.y);return Math.max(d,b)}function po(r,e){return{baseStep:qt(e),constraint:e,textProps:L.fromObject({draggingScale:$t(e,r),formatter:_e(cn(e,r))})}}function qu(r){if(!("y"in r))return!1;const e=r.y;return e&&"inverted"in e?!!e.inverted:!1}const $u={id:"input-point2d",type:"input",accept:(r,e)=>{if(!ht.isObject(r))return null;const i=W,l=q(e,{expanded:i.optional.boolean,picker:i.optional.custom(Qs),x:i.optional.custom(ot),y:i.optional.object({inverted:i.optional.boolean,max:i.optional.number,min:i.optional.number,step:i.optional.number})});return l?{initialValue:r,params:l}:null},binding:{reader:r=>ju,constraint:r=>Yu(r.params),equals:ht.equals,writer:r=>Ku},controller:r=>{const e=r.document,i=r.value,l=r.constraint;if(!(l instanceof lt))throw v.shouldNeverHappen();const d="expanded"in r.params?r.params.expanded:void 0,b="picker"in r.params?r.params.picker:void 0;return new Gu(e,{axes:[po(i.rawValue.x,l.components[0]),po(i.rawValue.y,l.components[1])],expanded:d??!1,invertsY:qu(r.params),maxValue:Wu(i.rawValue,l),parser:Ze,pickerLayout:b??"popup",value:i,viewProps:r.viewProps})}};class Jt{constructor(e=0,i=0,l=0){this.x=e,this.y=i,this.z=l}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(m(e))return!1;const i=e.x,l=e.y,d=e.z;return!(typeof i!="number"||typeof l!="number"||typeof d!="number")}static equals(e,i){return e.x===i.x&&e.y===i.y&&e.z===i.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const fo={toComponents:r=>r.getComponents(),fromComponents:r=>new Jt(...r)};function Xu(r){return Jt.isObject(r)?new Jt(r.x,r.y,r.z):new Jt}function Zu(r,e){r.writeProperty("x",e.x),r.writeProperty("y",e.y),r.writeProperty("z",e.z)}function mr(r){if(!r)return;const e=[];return m(r.step)||e.push(new Pt(r.step)),(!m(r.max)||!m(r.min))&&e.push(new Ce({max:r.max,min:r.min})),new Ct(e)}function Qu(r){return new lt({assembly:fo,components:[mr("x"in r?r.x:void 0),mr("y"in r?r.y:void 0),mr("z"in r?r.z:void 0)]})}function vr(r,e){return{baseStep:qt(e),constraint:e,textProps:L.fromObject({draggingScale:$t(e,r),formatter:_e(cn(e,r))})}}const Ju={id:"input-point3d",type:"input",accept:(r,e)=>{if(!Jt.isObject(r))return null;const i=W,l=q(e,{x:i.optional.custom(ot),y:i.optional.custom(ot),z:i.optional.custom(ot)});return l?{initialValue:r,params:l}:null},binding:{reader:r=>Xu,constraint:r=>Qu(r.params),equals:Jt.equals,writer:r=>Zu},controller:r=>{const e=r.value,i=r.constraint;if(!(i instanceof lt))throw v.shouldNeverHappen();return new fr(r.document,{assembly:fo,axes:[vr(e.rawValue.x,i.components[0]),vr(e.rawValue.y,i.components[1]),vr(e.rawValue.z,i.components[2])],parser:Ze,value:e,viewProps:r.viewProps})}};class ei{constructor(e=0,i=0,l=0,d=0){this.x=e,this.y=i,this.z=l,this.w=d}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(m(e))return!1;const i=e.x,l=e.y,d=e.z,b=e.w;return!(typeof i!="number"||typeof l!="number"||typeof d!="number"||typeof b!="number")}static equals(e,i){return e.x===i.x&&e.y===i.y&&e.z===i.z&&e.w===i.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const mo={toComponents:r=>r.getComponents(),fromComponents:r=>new ei(...r)};function ec(r){return ei.isObject(r)?new ei(r.x,r.y,r.z,r.w):new ei}function tc(r,e){r.writeProperty("x",e.x),r.writeProperty("y",e.y),r.writeProperty("z",e.z),r.writeProperty("w",e.w)}function gn(r){if(!r)return;const e=[];return m(r.step)||e.push(new Pt(r.step)),(!m(r.max)||!m(r.min))&&e.push(new Ce({max:r.max,min:r.min})),new Ct(e)}function ic(r){return new lt({assembly:mo,components:[gn("x"in r?r.x:void 0),gn("y"in r?r.y:void 0),gn("z"in r?r.z:void 0),gn("w"in r?r.w:void 0)]})}function nc(r,e){return{baseStep:qt(e),constraint:e,textProps:L.fromObject({draggingScale:$t(e,r),formatter:_e(cn(e,r))})}}const rc={id:"input-point4d",type:"input",accept:(r,e)=>{if(!ei.isObject(r))return null;const i=W,l=q(e,{x:i.optional.custom(ot),y:i.optional.custom(ot),z:i.optional.custom(ot),w:i.optional.custom(ot)});return l?{initialValue:r,params:l}:null},binding:{reader:r=>ec,constraint:r=>ic(r.params),equals:ei.equals,writer:r=>tc},controller:r=>{const e=r.value,i=r.constraint;if(!(i instanceof lt))throw v.shouldNeverHappen();return new fr(r.document,{assembly:mo,axes:e.rawValue.getComponents().map((l,d)=>nc(l,i.components[d])),parser:Ze,value:e,viewProps:r.viewProps})}};function sc(r){const e=[],i=nr(r.options);return i&&e.push(i),new Ct(e)}const oc={id:"input-string",type:"input",accept:(r,e)=>{if(typeof r!="string")return null;const l=q(e,{options:W.optional.custom(un)});return l?{initialValue:r,params:l}:null},binding:{reader:r=>qs,constraint:r=>sc(r.params),writer:r=>Di},controller:r=>{var e;const i=r.document,l=r.value,d=r.constraint;return d&&Ge(d,Pi)?new Si(i,{props:L.fromObject({options:(e=rr(d))!==null&&e!==void 0?e:[]}),value:l,viewProps:r.viewProps}):new ln(i,{parser:b=>b,props:L.fromObject({formatter:Zn}),value:l,viewProps:r.viewProps})}},Li={monitor:{defaultInterval:200,defaultLineCount:3}},vo=C("mll");class ac{constructor(e,i){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=i.formatter,this.element=e.createElement("div"),this.element.classList.add(vo()),i.viewProps.bindClassModifiers(this.element);const l=e.createElement("textarea");l.classList.add(vo("i")),l.style.height=`calc(var(--bld-us) * ${i.lineCount})`,l.readOnly=!0,i.viewProps.bindDisabled(l),this.element.appendChild(l),this.textareaElem_=l,i.value.emitter.on("change",this.onValueUpdate_),this.value=i.value,this.update_()}update_(){const e=this.textareaElem_,i=e.scrollTop===e.scrollHeight-e.clientHeight,l=[];this.value.rawValue.forEach(d=>{d!==void 0&&l.push(this.formatter_(d))}),e.textContent=l.join(`
`),i&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class _r{constructor(e,i){this.value=i.value,this.viewProps=i.viewProps,this.view=new ac(e,{formatter:i.formatter,lineCount:i.lineCount,value:this.value,viewProps:this.viewProps})}}const _o=C("sgl");class lc{constructor(e,i){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=i.formatter,this.element=e.createElement("div"),this.element.classList.add(_o()),i.viewProps.bindClassModifiers(this.element);const l=e.createElement("input");l.classList.add(_o("i")),l.readOnly=!0,l.type="text",i.viewProps.bindDisabled(l),this.element.appendChild(l),this.inputElement=l,i.value.emitter.on("change",this.onValueUpdate_),this.value=i.value,this.update_()}update_(){const e=this.value.rawValue,i=e[e.length-1];this.inputElement.value=i!==void 0?this.formatter_(i):""}onValueUpdate_(){this.update_()}}class gr{constructor(e,i){this.value=i.value,this.viewProps=i.viewProps,this.view=new lc(e,{formatter:i.formatter,value:this.value,viewProps:this.viewProps})}}const hc={id:"monitor-bool",type:"monitor",accept:(r,e)=>{if(typeof r!="boolean")return null;const l=q(e,{lineCount:W.optional.number});return l?{initialValue:r,params:l}:null},binding:{reader:r=>Hs},controller:r=>{var e;return r.value.rawValue.length===1?new gr(r.document,{formatter:Gs,value:r.value,viewProps:r.viewProps}):new _r(r.document,{formatter:Gs,lineCount:(e=r.params.lineCount)!==null&&e!==void 0?e:Li.monitor.defaultLineCount,value:r.value,viewProps:r.viewProps})}};class uc{constructor(){this.emitter=new w,this.index_=-1}get index(){return this.index_}set index(e){this.index_!==e&&(this.index_=e,this.emitter.emit("change",{index:e,sender:this}))}}const ct=C("grl");class cc{constructor(e,i){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ct()),i.viewProps.bindClassModifiers(this.element),this.formatter_=i.formatter,this.minValue_=i.minValue,this.maxValue_=i.maxValue,this.cursor_=i.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const l=e.createElementNS(Fe,"svg");l.classList.add(ct("g")),l.style.height=`calc(var(--bld-us) * ${i.lineCount})`,this.element.appendChild(l),this.svgElem_=l;const d=e.createElementNS(Fe,"polyline");this.svgElem_.appendChild(d),this.lineElem_=d;const b=e.createElement("div");b.classList.add(ct("t"),C("tt")()),this.element.appendChild(b),this.tooltipElem_=b,i.value.emitter.on("change",this.onValueUpdate_),this.value=i.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const e=this.svgElem_.getBoundingClientRect(),i=this.value.rawValue.length-1,l=this.minValue_,d=this.maxValue_,b=[];this.value.rawValue.forEach((H,j)=>{if(H===void 0)return;const kt=te(j,0,i,0,e.width),Bi=te(H,l,d,e.height,0);b.push([kt,Bi].join(","))}),this.lineElem_.setAttributeNS(null,"points",b.join(" "));const y=this.tooltipElem_,A=this.value.rawValue[this.cursor_.index];if(A===void 0){y.classList.remove(ct("t","a"));return}const B=te(this.cursor_.index,0,i,0,e.width),I=te(A,l,d,e.height,0);y.style.left=`${B}px`,y.style.top=`${I}px`,y.textContent=`${this.formatter_(A)}`,y.classList.contains(ct("t","a"))||(y.classList.add(ct("t","a"),ct("t","in")),nn(y),y.classList.remove(ct("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class dc{constructor(e,i){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.cursor_=new uc,this.view=new cc(e,{cursor:this.cursor_,formatter:i.formatter,lineCount:i.lineCount,maxValue:i.maxValue,minValue:i.minValue,value:this.value,viewProps:this.viewProps}),!Vn(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const l=new St(this.view.element);l.emitter.on("down",this.onGraphPointerDown_),l.emitter.on("move",this.onGraphPointerMove_),l.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.index=-1}onGraphMouseMove_(e){const i=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(te(e.offsetX,0,i.width,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.index=-1;return}this.cursor_.index=Math.floor(te(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.index=-1}}function br(r){return"format"in r&&!m(r.format)?r.format:_e(2)}function pc(r){var e;return r.value.rawValue.length===1?new gr(r.document,{formatter:br(r.params),value:r.value,viewProps:r.viewProps}):new _r(r.document,{formatter:br(r.params),lineCount:(e=r.params.lineCount)!==null&&e!==void 0?e:Li.monitor.defaultLineCount,value:r.value,viewProps:r.viewProps})}function fc(r){var e,i,l;return new dc(r.document,{formatter:br(r.params),lineCount:(e=r.params.lineCount)!==null&&e!==void 0?e:Li.monitor.defaultLineCount,maxValue:(i="max"in r.params?r.params.max:null)!==null&&i!==void 0?i:100,minValue:(l="min"in r.params?r.params.min:null)!==null&&l!==void 0?l:0,value:r.value,viewProps:r.viewProps})}function go(r){return"view"in r&&r.view==="graph"}const mc={id:"monitor-number",type:"monitor",accept:(r,e)=>{if(typeof r!="number")return null;const i=W,l=q(e,{format:i.optional.function,lineCount:i.optional.number,max:i.optional.number,min:i.optional.number,view:i.optional.string});return l?{initialValue:r,params:l}:null},binding:{defaultBufferSize:r=>go(r)?64:1,reader:r=>Ws},controller:r=>go(r.params)?fc(r):pc(r)},vc={id:"monitor-string",type:"monitor",accept:(r,e)=>{if(typeof r!="string")return null;const i=W,l=q(e,{lineCount:i.optional.number,multiline:i.optional.boolean});return l?{initialValue:r,params:l}:null},binding:{reader:r=>qs},controller:r=>{var e;const i=r.value;return i.rawValue.length>1||"multiline"in r.params&&r.params.multiline?new _r(r.document,{formatter:Zn,lineCount:(e=r.params.lineCount)!==null&&e!==void 0?e:Li.monitor.defaultLineCount,value:i,viewProps:r.viewProps}):new gr(r.document,{formatter:Zn,value:i,viewProps:r.viewProps})}};class _c{constructor(e){this.onValueChange_=this.onValueChange_.bind(this),this.reader=e.reader,this.writer=e.writer,this.emitter=new w,this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.target=e.target,this.read()}read(){const e=this.target.read();e!==void 0&&(this.value.rawValue=this.reader(e))}write_(e){this.writer(this.target,e)}onValueChange_(e){this.write_(e.rawValue),this.emitter.emit("change",{options:e.options,rawValue:e.rawValue,sender:this})}}function gc(r,e){const i=r.accept(e.target.read(),e.params);if(m(i))return null;const l=W,d={target:e.target,initialValue:i.initialValue,params:i.params},b=r.binding.reader(d),y=r.binding.constraint?r.binding.constraint(d):void 0,A=N(b(i.initialValue),{constraint:y,equals:r.binding.equals}),B=new _c({reader:b,target:e.target,value:A,writer:r.binding.writer(d)}),I=l.optional.boolean(e.params.disabled).value,H=l.optional.boolean(e.params.hidden).value,j=r.controller({constraint:y,document:e.document,initialValue:i.initialValue,params:i.params,value:B.value,viewProps:st.create({disabled:I,hidden:H})}),kt=l.optional.string(e.params.label).value;return new He(e.document,{binding:B,blade:xi(),props:L.fromObject({label:kt||e.target.key}),valueController:j})}class bc{constructor(e){this.onTick_=this.onTick_.bind(this),this.reader_=e.reader,this.target=e.target,this.emitter=new w,this.value=e.value,this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const e=this.target.read();if(e===void 0)return;const i=this.value.rawValue,l=this.reader_(e);this.value.rawValue=Mh(i,l),this.emitter.emit("update",{rawValue:l,sender:this})}onTick_(e){this.read()}}function xc(r,e){return e===0?new Yl:new Wl(r,e??Li.monitor.defaultInterval)}function wc(r,e){var i,l,d;const b=W,y=r.accept(e.target.read(),e.params);if(m(y))return null;const A={target:e.target,initialValue:y.initialValue,params:y.params},B=r.binding.reader(A),I=(l=(i=b.optional.number(e.params.bufferSize).value)!==null&&i!==void 0?i:r.binding.defaultBufferSize&&r.binding.defaultBufferSize(y.params))!==null&&l!==void 0?l:1,H=b.optional.number(e.params.interval).value,j=new bc({reader:B,target:e.target,ticker:xc(e.document,H),value:Sh(I)}),kt=b.optional.boolean(e.params.disabled).value,Bi=b.optional.boolean(e.params.hidden).value,Ii=r.controller({document:e.document,params:y.params,value:j.value,viewProps:st.create({disabled:kt,hidden:Bi})}),ti=(d=b.optional.string(e.params.label).value)!==null&&d!==void 0?d:e.target.key;return new rt(e.document,{binding:j,blade:xi(),props:L.fromObject({label:ti}),valueController:Ii})}class yc{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(e){e.type==="blade"?this.pluginsMap_.blades.unshift(e):e.type==="input"?this.pluginsMap_.inputs.unshift(e):e.type==="monitor"&&this.pluginsMap_.monitors.unshift(e)}createInput(e,i,l){const d=i.read();if(m(d))throw new v({context:{key:i.key},type:"nomatchingcontroller"});const b=this.pluginsMap_.inputs.reduce((y,A)=>y||gc(A,{document:e,target:i,params:l}),null);if(b)return b;throw new v({context:{key:i.key},type:"nomatchingcontroller"})}createMonitor(e,i,l){const d=this.pluginsMap_.monitors.reduce((b,y)=>b||wc(y,{document:e,params:l,target:i}),null);if(d)return d;throw new v({context:{key:i.key},type:"nomatchingcontroller"})}createBlade(e,i){const l=this.pluginsMap_.blades.reduce((d,b)=>d||Kl(b,{document:e,params:i}),null);if(!l)throw new v({type:"nomatchingview",context:{params:i}});return l}createBladeApi(e){if(e instanceof He)return new Hn(e);if(e instanceof rt)return new Gn(e);if(e instanceof Ei)return new on(e,this);const i=this.pluginsMap_.blades.reduce((l,d)=>l||d.api({controller:e,pool:this}),null);if(!i)throw v.shouldNeverHappen();return i}}function Ec(){const r=new yc;return[$u,Ju,rc,oc,Nu,Ru,Au,Mu,Vh,hc,vc,mc,Cl,Vl,zl,Vs].forEach(e=>{r.register(e)}),r}class bo extends a{constructor(e){super(e),this.emitter_=new w,this.controller_.valueController.value.emitter.on("change",i=>{this.emitter_.emit("change",{event:new u(this,i.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get options(){return this.controller_.valueController.props.get("options")}set options(e){this.controller_.valueController.props.set("options",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,i){const l=i.bind(this);return this.emitter_.on(e,d=>{l(d.event)}),this}}class xo extends a{constructor(e){super(e),this.emitter_=new w,this.controller_.valueController.value.emitter.on("change",i=>{this.emitter_.emit("change",{event:new u(this,i.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(e){this.controller_.valueController.sliderController.props.set("maxValue",e)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(e){this.controller_.valueController.sliderController.props.set("minValue",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,i){const l=i.bind(this);return this.emitter_.on(e,d=>{l(d.event)}),this}}class wo extends a{constructor(e){super(e),this.emitter_=new w,this.controller_.valueController.value.emitter.on("change",i=>{this.emitter_.emit("change",{event:new u(this,i.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(e){this.controller_.valueController.props.set("formatter",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,i){const l=i.bind(this);return this.emitter_.on(e,d=>{l(d.event)}),this}}const Cc=(function(){return{id:"list",type:"blade",accept(r){const e=W,i=q(r,{options:e.required.custom(un),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string});return i?{params:i}:null},controller(r){const e=new Si(r.document,{props:L.fromObject({options:Js(r.params.options)}),value:N(r.params.value),viewProps:r.viewProps});return new Wt(r.document,{blade:r.blade,props:L.fromObject({label:r.params.label}),valueController:e})},api(r){return!(r.controller instanceof Wt)||!(r.controller.valueController instanceof Si)?null:new bo(r.controller)}}})();function Pc(r){return r.reduce((e,i)=>Object.assign(e,{[i.presetKey]:i.read()}),{})}function Sc(r,e){r.forEach(i=>{const l=e[i.presetKey];l!==void 0&&i.write(l)})}class Tc extends jn{constructor(e,i){super(e,i)}get element(){return this.controller_.view.element}importPreset(e){const i=this.controller_.rackController.rack.find(He).map(l=>l.binding.target);Sc(i,e),this.refresh()}exportPreset(){const e=this.controller_.rackController.rack.find(He).map(i=>i.binding.target);return Pc(e)}refresh(){this.controller_.rackController.rack.find(He).forEach(e=>{e.binding.read()}),this.controller_.rackController.rack.find(rt).forEach(e=>{e.binding.read()})}}class Mc extends Wn{constructor(e,i){super(e,{expanded:i.expanded,blade:i.blade,props:i.props,root:!0,viewProps:i.viewProps})}}const kc={id:"slider",type:"blade",accept(r){const e=W,i=q(r,{max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number});return i?{params:i}:null},controller(r){var e,i;const l=(e=r.params.value)!==null&&e!==void 0?e:0,d=new ir(r.document,{baseStep:1,parser:Ze,sliderProps:L.fromObject({maxValue:r.params.max,minValue:r.params.min}),textProps:L.fromObject({draggingScale:$t(void 0,l),formatter:(i=r.params.format)!==null&&i!==void 0?i:Ch}),value:N(l),viewProps:r.viewProps});return new Wt(r.document,{blade:r.blade,props:L.fromObject({label:r.params.label}),valueController:d})},api(r){return!(r.controller instanceof Wt)||!(r.controller.valueController instanceof ir)?null:new xo(r.controller)}},Ac=(function(){return{id:"text",type:"blade",accept(r){const e=W,i=q(r,{parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string});return i?{params:i}:null},controller(r){var e;const i=new ln(r.document,{parser:r.params.parse,props:L.fromObject({formatter:(e=r.params.format)!==null&&e!==void 0?e:(l=>String(l))}),value:N(r.params.value),viewProps:r.viewProps});return new Wt(r.document,{blade:r.blade,props:L.fromObject({label:r.params.label}),valueController:i})},api(r){return!(r.controller instanceof Wt)||!(r.controller.valueController instanceof ln)?null:new wo(r.controller)}}})();function Rc(r){const e=r.createElement("div");return e.classList.add(C("dfw")()),r.body&&r.body.appendChild(e),e}function yo(r,e,i){if(r.querySelector(`style[data-tp-style=${e}]`))return;const l=r.createElement("style");l.dataset.tpStyle=e,l.textContent=i,r.head.appendChild(l)}class Dc extends Tc{constructor(e){var i;const l=e||{},d=(i=l.document)!==null&&i!==void 0?i:bl(),b=Ec(),y=new Mc(d,{expanded:l.expanded,blade:xi(),props:L.fromObject({title:l.title}),viewProps:st.create()});super(y,b),this.pool_=b,this.containerElem_=l.container||Rc(d),this.containerElem_.appendChild(this.element),this.doc_=d,this.usesDefaultWrapper_=!l.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw v.alreadyDisposed();return this.doc_}dispose(){const e=this.containerElem_;if(!e)throw v.alreadyDisposed();if(this.usesDefaultWrapper_){const i=e.parentElement;i&&i.removeChild(e)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(e){("plugin"in e?[e.plugin]:"plugins"in e?e.plugins:[]).forEach(l=>{this.pool_.register(l),this.embedPluginStyle_(l)})}embedPluginStyle_(e){e.css&&yo(this.document,`plugin-${e.id}`,e.css)}setUpDefaultPlugins_(){yo(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor transparent;scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:transparent}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:transparent solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #28292e);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #28292e);--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i,.tp-fldv_c>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach(e=>{this.embedPluginStyle_(e)}),this.registerPlugin({plugins:[kc,Cc,Vs,Ac]})}}const Oc=new s("3.0.8");n.BladeApi=a,n.ButtonApi=g,n.FolderApi=jn,n.InputBindingApi=Hn,n.ListApi=bo,n.MonitorBindingApi=Gn,n.Pane=Dc,n.SeparatorApi=As,n.SliderApi=xo,n.TabApi=Is,n.TabPageApi=Bs,n.TextApi=wo,n.TpChangeEvent=u,n.VERSION=Oc,Object.defineProperty(n,"__esModule",{value:!0})}))})(Gi,Gi.exports)),Gi.exports}var Tp=Sp();var Mr=1/1e3,Mp=1e3,kp=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(o){typeof document<"u"&&document.hidden!==void 0&&(o?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=o)}get delta(){return this._delta*Mr}get fixedDelta(){return this._fixedDelta*Mr}set fixedDelta(o){this._fixedDelta=o*Mp}get elapsed(){return this._elapsed*Mr}update(o){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(o!==void 0?o:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(o){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},Ap=(()=>{const o=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]),n=new ca;return n.setAttribute("position",new Fr(o,3)),n.setAttribute("uv",new Fr(t,2)),n})(),Ne=class es{static get fullscreenGeometry(){return Ap}constructor(t="Pass",n=new Nr,s=new Vc){this.name=t,this.renderer=null,this.scene=n,this.camera=s,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(t){if(this.rtt===t){const n=this.fullscreenMaterial;n!==null&&(n.needsUpdate=!0),this.rtt=!t}}set mainScene(t){}set mainCamera(t){}setRenderer(t){this.renderer=t}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(t){let n=this.screen;n!==null?n.material=t:(n=new ra(es.fullscreenGeometry,t),n.frustumCulled=!1,this.scene===null&&(this.scene=new Nr),this.scene.add(n),this.screen=n)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(t){this.fullscreenMaterial=t}getDepthTexture(){return null}setDepthTexture(t,n=Bn){}render(t,n,s,a,h){throw new Error("Render method not implemented!")}setSize(t,n){}initialize(t,n,s){}dispose(){for(const t of Object.keys(this)){const n=this[t];(n instanceof yt||n instanceof ha||n instanceof ua||n instanceof es)&&this[t].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},Rp=class extends Ne{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(o,t,n,s,a){const h=o.state.buffers.stencil;h.setLocked(!1),h.setTest(!1)}},Dp=`#ifdef COLOR_WRITE
#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#endif
#ifdef DEPTH_WRITE
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}
#endif
#ifdef USE_WEIGHTS
uniform vec4 channelWeights;
#endif
uniform float opacity;varying vec2 vUv;void main(){
#ifdef COLOR_WRITE
vec4 texel=texture2D(inputBuffer,vUv);
#ifdef USE_WEIGHTS
texel*=channelWeights;
#endif
gl_FragColor=opacity*texel;
#ifdef COLOR_SPACE_CONVERSION
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
#else
gl_FragColor=vec4(0.0);
#endif
#ifdef DEPTH_WRITE
gl_FragDepth=readDepth(vUv);
#endif
}`,cl="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",dl=class extends jt{constructor(){super({name:"CopyMaterial",defines:{DEPTH_PACKING:"0",COLOR_WRITE:"1"},uniforms:{inputBuffer:new K(null),depthBuffer:new K(null),channelWeights:new K(null),opacity:new K(1)},blending:vi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Dp,vertexShader:cl}),this.depthFunc=zc}get inputBuffer(){return this.uniforms.inputBuffer.value}set inputBuffer(o){const t=o!==null;this.colorWrite!==t&&(t?this.defines.COLOR_WRITE=!0:delete this.defines.COLOR_WRITE,this.colorWrite=t,this.needsUpdate=!0),this.uniforms.inputBuffer.value=o}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(o){const t=o!==null;this.depthWrite!==t&&(t?this.defines.DEPTH_WRITE=!0:delete this.defines.DEPTH_WRITE,this.depthTest=t,this.depthWrite=t,this.needsUpdate=!0),this.uniforms.depthBuffer.value=o}set depthPacking(o){this.defines.DEPTH_PACKING=o.toFixed(0),this.needsUpdate=!0}get channelWeights(){return this.uniforms.channelWeights.value}set channelWeights(o){o!==null?(this.defines.USE_WEIGHTS="1",this.uniforms.channelWeights.value=o):delete this.defines.USE_WEIGHTS,this.needsUpdate=!0}setInputBuffer(o){this.uniforms.inputBuffer.value=o}getOpacity(o){return this.uniforms.opacity.value}setOpacity(o){this.uniforms.opacity.value=o}},Op=class extends Ne{constructor(o,t=!0){super("CopyPass"),this.fullscreenMaterial=new dl,this.needsSwap=!1,this.renderTarget=o,o===void 0&&(this.renderTarget=new yt(1,1,{minFilter:Sn,magFilter:Sn,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(o){this.autoResize=o}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(o){this.autoResize=o}render(o,t,n,s,a){this.fullscreenMaterial.inputBuffer=t.texture,o.setRenderTarget(this.renderToScreen?null:this.renderTarget),o.render(this.scene,this.camera)}setSize(o,t){this.autoResize&&this.renderTarget.setSize(o,t)}initialize(o,t,n){n!==void 0&&(this.renderTarget.texture.type=n,n!==Ht?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":o!==null&&o.outputColorSpace===pe&&(this.renderTarget.texture.colorSpace=pe))}},jo=new zr,pl=class extends Ne{constructor(o=!0,t=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=o,this.depth=t,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(o,t,n){this.color=o,this.depth=t,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(o){this.overrideClearColor=o}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(o){this.overrideClearAlpha=o}render(o,t,n,s,a){const h=this.overrideClearColor,u=this.overrideClearAlpha,c=o.getClearAlpha(),p=h!==null,f=u>=0;p?(o.getClearColor(jo),o.setClearColor(h,f?u:c)):f&&o.setClearAlpha(u),o.setRenderTarget(this.renderToScreen?null:t),o.clear(this.color,this.depth,this.stencil),p?o.setClearColor(jo,c):f&&o.setClearAlpha(c)}},Lp=class extends Ne{constructor(o,t){super("MaskPass",o,t),this.needsSwap=!1,this.clearPass=new pl(!1,!1,!0),this.inverse=!1}set mainScene(o){this.scene=o}set mainCamera(o){this.camera=o}get inverted(){return this.inverse}set inverted(o){this.inverse=o}get clear(){return this.clearPass.enabled}set clear(o){this.clearPass.enabled=o}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(o){this.inverted=o}render(o,t,n,s,a){const h=o.getContext(),u=o.state.buffers,c=this.scene,p=this.camera,f=this.clearPass,m=this.inverted?0:1,_=1-m;u.color.setMask(!1),u.depth.setMask(!1),u.color.setLocked(!0),u.depth.setLocked(!0),u.stencil.setTest(!0),u.stencil.setOp(h.REPLACE,h.REPLACE,h.REPLACE),u.stencil.setFunc(h.ALWAYS,m,4294967295),u.stencil.setClear(_),u.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?f.render(o,null):(f.render(o,t),f.render(o,n))),this.renderToScreen?(o.setRenderTarget(null),o.render(c,p)):(o.setRenderTarget(t),o.render(c,p),o.setRenderTarget(n),o.render(c,p)),u.color.setLocked(!1),u.depth.setLocked(!1),u.stencil.setLocked(!1),u.stencil.setFunc(h.EQUAL,1,4294967295),u.stencil.setOp(h.KEEP,h.KEEP,h.KEEP),u.stencil.setLocked(!0)}},Bp=class{constructor(o=null,{depthBuffer:t=!0,stencilBuffer:n=!1,multisampling:s=0,frameBufferType:a}={}){this.renderer=null,this.inputBuffer=this.createBuffer(t,n,a,s),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new Op,this.depthTexture=null,this.passes=[],this.timer=new kp,this.autoRenderToScreen=!0,this.setRenderer(o)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(o){const t=this.inputBuffer,n=this.multisampling;n>0&&o>0?(this.inputBuffer.samples=o,this.outputBuffer.samples=o,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==o&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,o),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(o){if(this.renderer=o,o!==null){const t=o.getSize(new ee),n=o.getContext().getContextAttributes().alpha,s=this.inputBuffer.texture.type;s===Ht&&o.outputColorSpace===pe&&(this.inputBuffer.texture.colorSpace=pe,this.outputBuffer.texture.colorSpace=pe,this.inputBuffer.dispose(),this.outputBuffer.dispose()),o.autoClear=!1,this.setSize(t.width,t.height);for(const a of this.passes)a.initialize(o,n,s)}}replaceRenderer(o,t=!0){const n=this.renderer,s=n.domElement.parentNode;return this.setRenderer(o),t&&s!==null&&(s.removeChild(n.domElement),s.appendChild(o.domElement)),n}createDepthTexture(){const o=this.depthTexture=new Lc;return this.inputBuffer.depthTexture=o,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(o.format=Bc,o.type=Ic):o.type=Uc,o}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const o of this.passes)o.setDepthTexture(null)}}createBuffer(o,t,n,s){const a=this.renderer,h=a===null?new ee:a.getDrawingBufferSize(new ee),u={minFilter:Sn,magFilter:Sn,stencilBuffer:t,depthBuffer:o,type:n},c=new yt(h.width,h.height,u);return s>0&&(c.samples=s),n===Ht&&a!==null&&a.outputColorSpace===pe&&(c.texture.colorSpace=pe),c.texture.name="EffectComposer.Buffer",c.texture.generateMipmaps=!1,c}setMainScene(o){for(const t of this.passes)t.mainScene=o}setMainCamera(o){for(const t of this.passes)t.mainCamera=o}addPass(o,t){const n=this.passes,s=this.renderer,a=s.getDrawingBufferSize(new ee),h=s.getContext().getContextAttributes().alpha,u=this.inputBuffer.texture.type;if(o.setRenderer(s),o.setSize(a.width,a.height),o.initialize(s,h,u),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),o.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?n.splice(t,0,o):n.push(o),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),o.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const c=this.createDepthTexture();for(o of n)o.setDepthTexture(c)}else o.setDepthTexture(this.depthTexture)}removePass(o){const t=this.passes,n=t.indexOf(o);if(n!==-1&&t.splice(n,1).length>0){if(this.depthTexture!==null){const h=(c,p)=>c||p.needsDepthTexture;t.reduce(h,!1)||(o.getDepthTexture()===this.depthTexture&&o.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===t.length&&(o.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){const o=this.passes;this.deleteDepthTexture(),o.length>0&&(this.autoRenderToScreen&&(o[o.length-1].renderToScreen=!1),this.passes=[])}render(o){const t=this.renderer,n=this.copyPass;let s=this.inputBuffer,a=this.outputBuffer,h=!1,u,c,p;o===void 0&&(this.timer.update(),o=this.timer.getDelta());for(const f of this.passes)f.enabled&&(f.render(t,s,a,o,h),f.needsSwap&&(h&&(n.renderToScreen=f.renderToScreen,u=t.getContext(),c=t.state.buffers.stencil,c.setFunc(u.NOTEQUAL,1,4294967295),n.render(t,s,a,o,h),c.setFunc(u.EQUAL,1,4294967295)),p=s,s=a,a=p),f instanceof Lp?h=!0:f instanceof Rp&&(h=!1))}setSize(o,t,n){const s=this.renderer,a=s.getSize(new ee);(o===void 0||t===void 0)&&(o=a.width,t=a.height),(a.width!==o||a.height!==t)&&s.setSize(o,t,n);const h=s.getDrawingBufferSize(new ee);this.inputBuffer.setSize(h.width,h.height),this.outputBuffer.setSize(h.width,h.height);for(const u of this.passes)u.setSize(h.width,h.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const o of this.passes)o.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Ne.fullscreenGeometry.dispose()}},zt={NONE:0,DEPTH:1,CONVOLUTION:2},G={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Ip=class{constructor(){this.shaderParts=new Map([[G.FRAGMENT_HEAD,null],[G.FRAGMENT_MAIN_UV,null],[G.FRAGMENT_MAIN_IMAGE,null],[G.VERTEX_HEAD,null],[G.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=zt.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=sa}},kr=!1,Ko=class{constructor(o=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(o),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let n;if(t.material.flatShading)switch(t.material.side){case zi:n=this.materialsFlatShadedDoubleSide;break;case bn:n=this.materialsFlatShadedBackSide;break;default:n=this.materialsFlatShaded;break}else switch(t.material.side){case zi:n=this.materialsDoubleSide;break;case bn:n=this.materialsBackSide;break;default:n=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=n[2]:t.isInstancedMesh?t.material=n[1]:t.material=n[0],++this.meshCount}}}cloneMaterial(o){if(!(o instanceof jt))return o.clone();const t=o.uniforms,n=new Map;for(const a in t){const h=t[a].value;h.isRenderTargetTexture&&(t[a].value=null,n.set(a,h))}const s=o.clone();for(const a of n)t[a[0]].value=a[1],s.uniforms[a[0]].value=a[1];return s}setMaterial(o){if(this.disposeMaterials(),this.material=o,o!==null){const t=this.materials=[this.cloneMaterial(o),this.cloneMaterial(o),this.cloneMaterial(o)];for(const n of t)n.uniforms=Object.assign({},o.uniforms),n.side=Nc;t[2].skinning=!0,this.materialsBackSide=t.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},o.uniforms),s.side=bn,s}),this.materialsDoubleSide=t.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},o.uniforms),s.side=zi,s}),this.materialsFlatShaded=t.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},o.uniforms),s.flatShading=!0,s}),this.materialsFlatShadedBackSide=t.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},o.uniforms),s.flatShading=!0,s.side=bn,s}),this.materialsFlatShadedDoubleSide=t.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},o.uniforms),s.flatShading=!0,s.side=zi,s})}}render(o,t,n){const s=o.shadowMap.enabled;if(o.shadowMap.enabled=!1,kr){const a=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),o.render(t,n);for(const h of a)h[0].material=h[1];this.meshCount!==a.size&&a.clear()}else{const a=t.overrideMaterial;t.overrideMaterial=this.material,o.render(t,n),t.overrideMaterial=a}o.shadowMap.enabled=s}disposeMaterials(){if(this.material!==null){const o=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const t of o)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return kr}static set workaroundEnabled(o){kr=o}},dt=-1,We=class extends is{constructor(o,t=dt,n=dt,s=1){super(),this.resizable=o,this.baseSize=new ee(1,1),this.preferredSize=new ee(t,n),this.target=this.preferredSize,this.s=s,this.effectiveSize=new ee,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const o=this.baseSize,t=this.preferredSize,n=this.effectiveSize,s=this.scale;t.width!==dt?n.width=t.width:t.height!==dt?n.width=Math.round(t.height*(o.width/Math.max(o.height,1))):n.width=Math.round(o.width*s),t.height!==dt?n.height=t.height:t.width!==dt?n.height=Math.round(t.width/Math.max(o.width/Math.max(o.height,1),1)):n.height=Math.round(o.height*s)}get width(){return this.effectiveSize.width}set width(o){this.preferredWidth=o}get height(){return this.effectiveSize.height}set height(o){this.preferredHeight=o}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(o){this.s!==o&&(this.s=o,this.preferredSize.setScalar(dt),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(o){this.scale=o}get baseWidth(){return this.baseSize.width}set baseWidth(o){this.baseSize.width!==o&&(this.baseSize.width=o,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(o){this.baseWidth=o}get baseHeight(){return this.baseSize.height}set baseHeight(o){this.baseSize.height!==o&&(this.baseSize.height=o,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(o){this.baseHeight=o}setBaseSize(o,t){(this.baseSize.width!==o||this.baseSize.height!==t)&&(this.baseSize.set(o,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(o){this.preferredSize.width!==o&&(this.preferredSize.width=o,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(o){this.preferredWidth=o}get preferredHeight(){return this.preferredSize.height}set preferredHeight(o){this.preferredSize.height!==o&&(this.preferredSize.height=o,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(o){this.preferredHeight=o}setPreferredSize(o,t){(this.preferredSize.width!==o||this.preferredSize.height!==t)&&(this.preferredSize.set(o,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(o){this.s=o.scale,this.baseSize.set(o.baseWidth,o.baseHeight),this.preferredSize.set(o.preferredWidth,o.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return dt}},z={ADD:0,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},Up="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb,y.a),y.a*opacity);}",Vp="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb)*0.5,y.a),y.a*opacity);}",Np="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.xy,xHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",zp="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/b)),vec3(1.0),step(1.0,a));return mix(x,vec4(z,y.a),y.a*opacity);}",Fp="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(x,vec4(z,y.a),y.a*opacity);}",Hp="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb,y.rgb),y.a),y.a*opacity);}",Gp="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(abs(x.rgb-y.rgb),y.a),y.a*opacity);}",jp="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb/max(y.rgb,1e-12),y.a),y.a*opacity);}",Kp="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb-2.0*x.rgb*y.rgb),y.a),y.a*opacity);}",Yp="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=min(x.rgb,1.0);vec3 b=min(y.rgb,1.0);vec3 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(x,vec4(z,y.a),y.a*opacity);}",Wp="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(step(1.0,x.rgb+y.rgb),y.a),y.a*opacity);}",qp="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.x,xHSL.yz));return mix(x,vec4(z,y.a),y.a*opacity);}",$p="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-y.rgb,y.a),y.a*opacity);}",Xp="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(y.rgb*(1.0-x.rgb),y.a),y.a*opacity);}",Zp="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb,y.rgb),y.a),y.a*opacity);}",Qp="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(y.rgb+x.rgb-1.0,0.0,1.0),y.a),y.a*opacity);}",Jp="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb+y.rgb,1.0),y.a),y.a*opacity);}",ef="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(2.0*y.rgb+x.rgb-1.0,0.0,1.0),y.a),y.a*opacity);}",tf="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.xy,yHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",nf="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb*y.rgb,y.a),y.a*opacity);}",rf="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-abs(1.0-x.rgb-y.rgb),y.a),y.a*opacity);}",sf="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,y.a*opacity);}",of="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(2.0*y.rgb*x.rgb,1.0-2.0*(1.0-y.rgb)*(1.0-x.rgb),step(0.5,x.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",af="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 y2=2.0*y.rgb;vec3 z=mix(mix(y2,x.rgb,step(0.5*x.rgb,y.rgb)),max(y2-1.0,vec3(0.0)),step(x.rgb,y2-1.0));return mix(x,vec4(z,y.a),y.a*opacity);}",lf="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(min(x.rgb*x.rgb/max(1.0-y.rgb,1e-12),1.0),y.rgb,step(1.0,y.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",hf="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.x,yHSL.y,xHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",uf="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb-min(x.rgb*y.rgb,1.0),y.a),y.a*opacity);}",cf="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb;vec3 b=y.rgb;vec3 y2=2.0*b;vec3 w=step(0.5,b);vec3 c=a-(1.0-y2)*a*(1.0-a);vec3 d=mix(a+(y2-1.0)*(sqrt(a)-a),a+(y2-1.0)*a*((16.0*a-12.0)*a+3.0),w*(1.0-step(0.25,a)));vec3 z=mix(c,d,w);return mix(x,vec4(z,y.a),y.a*opacity);}",df="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",pf="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb+y.rgb-1.0,0.0),y.a),y.a*opacity);}",ff="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(max(1.0-min((1.0-x.rgb)/(2.0*y.rgb),1.0),0.0),min(x.rgb/(2.0*(1.0-y.rgb)),1.0),step(0.5,y.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",mf=new Map([[z.ADD,Up],[z.AVERAGE,Vp],[z.COLOR,Np],[z.COLOR_BURN,zp],[z.COLOR_DODGE,Fp],[z.DARKEN,Hp],[z.DIFFERENCE,Gp],[z.DIVIDE,jp],[z.DST,null],[z.EXCLUSION,Kp],[z.HARD_LIGHT,Yp],[z.HARD_MIX,Wp],[z.HUE,qp],[z.INVERT,$p],[z.INVERT_RGB,Xp],[z.LIGHTEN,Zp],[z.LINEAR_BURN,Qp],[z.LINEAR_DODGE,Jp],[z.LINEAR_LIGHT,ef],[z.LUMINOSITY,tf],[z.MULTIPLY,nf],[z.NEGATION,rf],[z.NORMAL,sf],[z.OVERLAY,of],[z.PIN_LIGHT,af],[z.REFLECT,lf],[z.SATURATION,hf],[z.SCREEN,uf],[z.SOFT_LIGHT,cf],[z.SRC,df],[z.SUBTRACT,pf],[z.VIVID_LIGHT,ff]]),vf=class extends is{constructor(o,t=1){super(),this._blendFunction=o,this.opacity=new K(t)}getOpacity(){return this.opacity.value}setOpacity(o){this.opacity.value=o}get blendFunction(){return this._blendFunction}set blendFunction(o){this._blendFunction=o,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(o){this.blendFunction=o}getShaderCode(){return mf.get(this.blendFunction)}},_f=class extends is{constructor(o,t,{attributes:n=zt.NONE,blendFunction:s=z.NORMAL,defines:a=new Map,uniforms:h=new Map,extensions:u=null,vertexShader:c=null}={}){super(),this.name=o,this.renderer=null,this.attributes=n,this.fragmentShader=t,this.vertexShader=c,this.defines=a,this.uniforms=h,this.extensions=u,this.blendMode=new vf(s),this.blendMode.addEventListener("change",p=>this.setChanged()),this._inputColorSpace=sa,this._outputColorSpace=oa}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(o){this._inputColorSpace=o,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(o){this._outputColorSpace=o,this.setChanged()}set mainScene(o){}set mainCamera(o){}getName(){return this.name}setRenderer(o){this.renderer=o}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(o){this.attributes=o,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(o){this.fragmentShader=o,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(o){this.vertexShader=o,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(o,t=Bn){}update(o,t,n){}setSize(o,t){}initialize(o,t,n){}dispose(){for(const o of Object.keys(this)){const t=this[o];(t instanceof yt||t instanceof ha||t instanceof ua||t instanceof Ne)&&this[o].dispose()}}},gs={MEDIUM:2,LARGE:3},gf=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,bf="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",xf=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],wf=class extends jt{constructor(o=new Eo){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new K(null),texelSize:new K(new Eo),scale:new K(1),kernel:new K(0)},blending:vi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:gf,vertexShader:bf}),this.setTexelSize(o.x,o.y),this.kernelSize=gs.MEDIUM}set inputBuffer(o){this.uniforms.inputBuffer.value=o}setInputBuffer(o){this.inputBuffer=o}get kernelSequence(){return xf[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(o){this.uniforms.scale.value=o}getScale(){return this.uniforms.scale.value}setScale(o){this.uniforms.scale.value=o}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(o){this.uniforms.kernel.value=o}setKernel(o){this.kernel=o}setTexelSize(o,t){this.uniforms.texelSize.value.set(o,t,o*.5,t*.5)}setSize(o,t){const n=1/o,s=1/t;this.uniforms.texelSize.value.set(n,s,n*.5,s*.5)}},yf=class extends Ne{constructor({kernelSize:o=gs.MEDIUM,resolutionScale:t=.5,width:n=We.AUTO_SIZE,height:s=We.AUTO_SIZE,resolutionX:a=n,resolutionY:h=s}={}){super("KawaseBlurPass"),this.renderTargetA=new yt(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const u=this.resolution=new We(this,a,h,t);u.addEventListener("change",c=>this.setSize(u.baseWidth,u.baseHeight)),this._blurMaterial=new wf,this._blurMaterial.kernelSize=o,this.copyMaterial=new dl}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(o){this._blurMaterial=o}get dithering(){return this.copyMaterial.dithering}set dithering(o){this.copyMaterial.dithering=o}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(o){this.blurMaterial.kernelSize=o}get width(){return this.resolution.width}set width(o){this.resolution.preferredWidth=o}get height(){return this.resolution.height}set height(o){this.resolution.preferredHeight=o}get scale(){return this.blurMaterial.scale}set scale(o){this.blurMaterial.scale=o}getScale(){return this.blurMaterial.scale}setScale(o){this.blurMaterial.scale=o}getKernelSize(){return this.kernelSize}setKernelSize(o){this.kernelSize=o}getResolutionScale(){return this.resolution.scale}setResolutionScale(o){this.resolution.scale=o}render(o,t,n,s,a){const h=this.scene,u=this.camera,c=this.renderTargetA,p=this.renderTargetB,f=this.blurMaterial,m=f.kernelSequence;let _=t;this.fullscreenMaterial=f;for(let x=0,v=m.length;x<v;++x){const E=(x&1)===0?c:p;f.kernel=m[x],f.inputBuffer=_.texture,o.setRenderTarget(E),o.render(h,u),_=E}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=_.texture,o.setRenderTarget(this.renderToScreen?null:n),o.render(h,u)}setSize(o,t){const n=this.resolution;n.setBaseSize(o,t);const s=n.width,a=n.height;this.renderTargetA.setSize(s,a),this.renderTargetB.setSize(s,a),this.blurMaterial.setSize(o,t)}initialize(o,t,n){n!==void 0&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==Ht?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):o!==null&&o.outputColorSpace===pe&&(this.renderTargetA.texture.colorSpace=pe,this.renderTargetB.texture.colorSpace=pe))}static get AUTO_SIZE(){return We.AUTO_SIZE}},Ef=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);float mask=1.0;
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);mask=low*high;
#elif defined(THRESHOLD)
mask=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=texel*mask;
#else
gl_FragColor=vec4(l*mask);
#endif
}`,Cf=class extends jt{constructor(o=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:aa.replace(/\D+/g,"")},uniforms:{inputBuffer:new K(null),threshold:new K(0),smoothing:new K(1),range:new K(null)},blending:vi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Ef,vertexShader:cl}),this.colorOutput=o,this.luminanceRange=t}set inputBuffer(o){this.uniforms.inputBuffer.value=o}setInputBuffer(o){this.uniforms.inputBuffer.value=o}get threshold(){return this.uniforms.threshold.value}set threshold(o){this.smoothing>0||o>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=o}getThreshold(){return this.threshold}setThreshold(o){this.threshold=o}get smoothing(){return this.uniforms.smoothing.value}set smoothing(o){this.threshold>0||o>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=o}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(o){this.smoothing=o}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(o){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(o){o?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(o){return this.colorOutput}setColorOutputEnabled(o){this.colorOutput=o}get useRange(){return this.luminanceRange!==null}set useRange(o){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(o){o!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=o,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(o){this.luminanceRange=o}},Pf=class extends Ne{constructor({renderTarget:o,luminanceRange:t,colorOutput:n,resolutionScale:s=1,width:a=We.AUTO_SIZE,height:h=We.AUTO_SIZE,resolutionX:u=a,resolutionY:c=h}={}){super("LuminancePass"),this.fullscreenMaterial=new Cf(n,t),this.needsSwap=!1,this.renderTarget=o,this.renderTarget===void 0&&(this.renderTarget=new yt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const p=this.resolution=new We(this,u,c,s);p.addEventListener("change",f=>this.setSize(p.baseWidth,p.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(o,t,n,s,a){const h=this.fullscreenMaterial;h.inputBuffer=t.texture,o.setRenderTarget(this.renderToScreen?null:this.renderTarget),o.render(this.scene,this.camera)}setSize(o,t){const n=this.resolution;n.setBaseSize(o,t),this.renderTarget.setSize(n.width,n.height)}initialize(o,t,n){n!==void 0&&n!==Ht&&(this.renderTarget.texture.type=n,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Sf=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,Tf="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",Mf=class extends jt{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new K(null),texelSize:new K(new ee)},blending:vi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Sf,vertexShader:Tf})}set inputBuffer(o){this.uniforms.inputBuffer.value=o}setSize(o,t){this.uniforms.texelSize.value.set(1/o,1/t)}},kf=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,Af="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",Rf=class extends jt{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new K(null),supportBuffer:new K(null),texelSize:new K(new ee),radius:new K(.85)},blending:vi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:kf,vertexShader:Af})}set inputBuffer(o){this.uniforms.inputBuffer.value=o}set supportBuffer(o){this.uniforms.supportBuffer.value=o}get radius(){return this.uniforms.radius.value}set radius(o){this.uniforms.radius.value=o}setSize(o,t){this.uniforms.texelSize.value.set(1/o,1/t)}},Df=class extends Ne{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new yt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new Mf,this.upsamplingMaterial=new Rf,this.resolution=new ee}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(o){if(this.levels!==o){const t=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let n=0;n<o;++n){const s=t.clone();s.texture.name="Downsampling.Mipmap"+n,this.downsamplingMipmaps.push(s)}this.upsamplingMipmaps.push(t);for(let n=1,s=o-1;n<s;++n){const a=t.clone();a.texture.name="Upsampling.Mipmap"+n,this.upsamplingMipmaps.push(a)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(o){this.upsamplingMaterial.radius=o}render(o,t,n,s,a){const{scene:h,camera:u}=this,{downsamplingMaterial:c,upsamplingMaterial:p}=this,{downsamplingMipmaps:f,upsamplingMipmaps:m}=this;let _=t;this.fullscreenMaterial=c;for(let x=0,v=f.length;x<v;++x){const E=f[x];c.setSize(_.width,_.height),c.inputBuffer=_.texture,o.setRenderTarget(E),o.render(h,u),_=E}this.fullscreenMaterial=p;for(let x=m.length-1;x>=0;--x){const v=m[x];p.setSize(_.width,_.height),p.inputBuffer=_.texture,p.supportBuffer=f[x].texture,o.setRenderTarget(v),o.render(h,u),_=v}}setSize(o,t){const n=this.resolution;n.set(o,t);let s=n.width,a=n.height;for(let h=0,u=this.downsamplingMipmaps.length;h<u;++h)s=Math.round(s*.5),a=Math.round(a*.5),this.downsamplingMipmaps[h].setSize(s,a),h<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[h].setSize(s,a)}initialize(o,t,n){if(n!==void 0){const s=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const a of s)a.texture.type=n;if(n!==Ht)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(o!==null&&o.outputColorSpace===pe)for(const a of s)a.texture.colorSpace=pe}}dispose(){super.dispose();for(const o of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))o.dispose()}},Of=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,max(inputColor.a,texel.a));}`,Lf=class extends _f{constructor({blendFunction:o=z.SCREEN,luminanceThreshold:t=1,luminanceSmoothing:n=.03,mipmapBlur:s=!0,intensity:a=1,radius:h=.85,levels:u=8,kernelSize:c=gs.LARGE,resolutionScale:p=.5,width:f=We.AUTO_SIZE,height:m=We.AUTO_SIZE,resolutionX:_=f,resolutionY:x=m}={}){super("BloomEffect",Of,{blendFunction:o,uniforms:new Map([["map",new K(null)],["intensity",new K(a)]])}),this.renderTarget=new yt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new yf({kernelSize:c}),this.luminancePass=new Pf({colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothing=n,this.mipmapBlurPass=new Df,this.mipmapBlurPass.enabled=s,this.mipmapBlurPass.radius=h,this.mipmapBlurPass.levels=u,this.uniforms.get("map").value=s?this.mipmapBlurPass.texture:this.renderTarget.texture;const v=this.resolution=new We(this,_,x,p);v.addEventListener("change",E=>this.setSize(v.baseWidth,v.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(o){this.resolution.preferredWidth=o}get height(){return this.resolution.height}set height(o){this.resolution.preferredHeight=o}get dithering(){return this.blurPass.dithering}set dithering(o){this.blurPass.dithering=o}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(o){this.blurPass.kernelSize=o}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(o){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(o){this.uniforms.get("intensity").value=o}getIntensity(){return this.intensity}setIntensity(o){this.intensity=o}getResolutionScale(){return this.resolution.scale}setResolutionScale(o){this.resolution.scale=o}update(o,t,n){const s=this.renderTarget,a=this.luminancePass;a.enabled?(a.render(o,t),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(o,a.renderTarget):this.blurPass.render(o,a.renderTarget,s)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(o,t):this.blurPass.render(o,t,s)}setSize(o,t){const n=this.resolution;n.setBaseSize(o,t),this.renderTarget.setSize(n.width,n.height),this.blurPass.resolution.copy(n),this.luminancePass.setSize(o,t),this.mipmapBlurPass.setSize(o,t)}initialize(o,t,n){this.blurPass.initialize(o,t,n),this.luminancePass.initialize(o,t,n),this.mipmapBlurPass.initialize(o,t,n),n!==void 0&&(this.renderTarget.texture.type=n,o!==null&&o.outputColorSpace===pe&&(this.renderTarget.texture.colorSpace=pe))}},Bf=class extends Ne{constructor(o,t,n=null){super("RenderPass",o,t),this.needsSwap=!1,this.clearPass=new pl,this.overrideMaterialManager=n===null?null:new Ko(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(o){this.scene=o}set mainCamera(o){this.camera=o}get renderToScreen(){return super.renderToScreen}set renderToScreen(o){super.renderToScreen=o,this.clearPass.renderToScreen=o}get overrideMaterial(){const o=this.overrideMaterialManager;return o!==null?o.material:null}set overrideMaterial(o){const t=this.overrideMaterialManager;o!==null?t!==null?t.setMaterial(o):this.overrideMaterialManager=new Ko(o):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(o){this.overrideMaterial=o}get clear(){return this.clearPass.enabled}set clear(o){this.clearPass.enabled=o}getSelection(){return this.selection}setSelection(o){this.selection=o}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(o){this.ignoreBackground=o}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(o){this.skipShadowMapUpdate=o}getClearPass(){return this.clearPass}render(o,t,n,s,a){const h=this.scene,u=this.camera,c=this.selection,p=u.layers.mask,f=h.background,m=o.shadowMap.autoUpdate,_=this.renderToScreen?null:t;c!==null&&u.layers.set(c.getLayer()),this.skipShadowMapUpdate&&(o.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(h.background=null),this.clearPass.enabled&&this.clearPass.render(o,t),o.setRenderTarget(_),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(o,h,u):o.render(h,u),u.layers.mask=p,h.background=f,o.shadowMap.autoUpdate=m}},If=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#if defined(USE_LOGARITHMIC_DEPTH_BUFFER) || defined(LOG_DEPTH)
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#elif defined(USE_REVERSED_DEPTH_BUFFER)
depth=1.0-depth;
#endif
return depth;}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,Uf="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",Vf=class extends jt{constructor(o,t,n,s,a=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:aa.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new K(null),depthBuffer:new K(null),resolution:new K(new ee),texelSize:new K(new ee),cameraNear:new K(.3),cameraFar:new K(1e3),aspect:new K(1),time:new K(0)},blending:vi,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:a}),o&&this.setShaderParts(o),t&&this.setDefines(t),n&&this.setUniforms(n),this.copyCameraSettings(s)}set inputBuffer(o){this.uniforms.inputBuffer.value=o}setInputBuffer(o){this.uniforms.inputBuffer.value=o}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(o){this.uniforms.depthBuffer.value=o}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(o){this.defines.DEPTH_PACKING=o.toFixed(0),this.needsUpdate=!0}setDepthBuffer(o,t=Bn){this.depthBuffer=o,this.depthPacking=t}setShaderData(o){this.setShaderParts(o.shaderParts),this.setDefines(o.defines),this.setUniforms(o.uniforms),this.setExtensions(o.extensions)}setShaderParts(o){return this.fragmentShader=If.replace(G.FRAGMENT_HEAD,o.get(G.FRAGMENT_HEAD)||"").replace(G.FRAGMENT_MAIN_UV,o.get(G.FRAGMENT_MAIN_UV)||"").replace(G.FRAGMENT_MAIN_IMAGE,o.get(G.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=Uf.replace(G.VERTEX_HEAD,o.get(G.VERTEX_HEAD)||"").replace(G.VERTEX_MAIN_SUPPORT,o.get(G.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(o){for(const t of o.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(o){for(const t of o.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(o){this.extensions={};for(const t of o)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(o){this.encodeOutput!==o&&(o?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(o){return this.encodeOutput}setOutputEncodingEnabled(o){this.encodeOutput=o}get time(){return this.uniforms.time.value}set time(o){this.uniforms.time.value=o}setDeltaTime(o){this.uniforms.time.value+=o}adoptCameraSettings(o){this.copyCameraSettings(o)}copyCameraSettings(o){o&&(this.uniforms.cameraNear.value=o.near,this.uniforms.cameraFar.value=o.far,o instanceof la?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(o,t){const n=this.uniforms;n.resolution.value.set(o,t),n.texelSize.value.set(1/o,1/t),n.aspect.value=o/t}static get Section(){return G}};function Yo(o,t,n){for(const s of t){const a="$1"+o+s.charAt(0).toUpperCase()+s.slice(1),h=new RegExp("([^\\.])(\\b"+s+"\\b)","g");for(const u of n.entries())u[1]!==null&&n.set(u[0],u[1].replace(h,a))}}function Nf(o,t,n){let s=t.getFragmentShader(),a=t.getVertexShader();const h=s!==void 0&&/mainImage/.test(s),u=s!==void 0&&/mainUv/.test(s);if(n.attributes|=t.getAttributes(),s===void 0)throw new Error(`Missing fragment shader (${t.name})`);if(u&&(n.attributes&zt.CONVOLUTION)!==0)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${t.name})`);if(!h&&!u)throw new Error(`Could not find mainImage or mainUv function (${t.name})`);{const c=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,p=n.shaderParts;let f=p.get(G.FRAGMENT_HEAD)||"",m=p.get(G.FRAGMENT_MAIN_UV)||"",_=p.get(G.FRAGMENT_MAIN_IMAGE)||"",x=p.get(G.VERTEX_HEAD)||"",v=p.get(G.VERTEX_MAIN_SUPPORT)||"";const E=new Set,g=new Set;if(u&&(m+=`	${o}MainUv(UV);
`,n.uvTransformation=!0),a!==null&&/mainSupport/.test(a)){const C=/mainSupport *\([\w\s]*?uv\s*?\)/.test(a);v+=`	${o}MainSupport(`,v+=C?`vUv);
`:`);
`;for(const P of a.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const k of P[1].split(/\s*,\s*/))n.varyings.add(k),E.add(k),g.add(k);for(const P of a.matchAll(c))g.add(P[1])}for(const C of s.matchAll(c))g.add(C[1]);for(const C of t.defines.keys())g.add(C.replace(/\([\w\s,]*\)/g,""));for(const C of t.uniforms.keys())g.add(C);g.delete("while"),g.delete("for"),g.delete("if"),t.uniforms.forEach((C,P)=>n.uniforms.set(o+P.charAt(0).toUpperCase()+P.slice(1),C)),t.defines.forEach((C,P)=>n.defines.set(o+P.charAt(0).toUpperCase()+P.slice(1),C));const w=new Map([["fragment",s],["vertex",a]]);Yo(o,g,n.defines),Yo(o,g,w),s=w.get("fragment"),a=w.get("vertex");const S=t.blendMode;if(n.blendModes.set(S.blendFunction,S),h){t.inputColorSpace!==null&&t.inputColorSpace!==n.colorSpace&&(_+=t.inputColorSpace===pe?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),t.outputColorSpace!==oa?n.colorSpace=t.outputColorSpace:t.inputColorSpace!==null&&(n.colorSpace=t.inputColorSpace);const C=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;_+=`${o}MainImage(color0, UV, `,(n.attributes&zt.DEPTH)!==0&&C.test(s)&&(_+="depth, ",n.readDepth=!0),_+=`color1);
	`;const P=o+"BlendOpacity";n.uniforms.set(P,S.opacity),_+=`color0 = blend${S.blendFunction}(color0, color1, ${P});

	`,f+=`uniform float ${P};

`}if(f+=s+`
`,a!==null&&(x+=a+`
`),p.set(G.FRAGMENT_HEAD,f),p.set(G.FRAGMENT_MAIN_UV,m),p.set(G.FRAGMENT_MAIN_IMAGE,_),p.set(G.VERTEX_HEAD,x),p.set(G.VERTEX_MAIN_SUPPORT,v),t.extensions!==null)for(const C of t.extensions)n.extensions.add(C)}}var zf=class extends Ne{constructor(o,...t){super("EffectPass"),this.fullscreenMaterial=new Vf(null,null,null,o),this.listener=n=>this.handleEvent(n),this.effects=[],this.setEffects(t),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(o){for(const t of this.effects)t.mainScene=o}set mainCamera(o){this.fullscreenMaterial.copyCameraSettings(o);for(const t of this.effects)t.mainCamera=o}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(o){this.fullscreenMaterial.encodeOutput=o}get dithering(){return this.fullscreenMaterial.dithering}set dithering(o){const t=this.fullscreenMaterial;t.dithering=o,t.needsUpdate=!0}setEffects(o){for(const t of this.effects)t.removeEventListener("change",this.listener);this.effects=o.sort((t,n)=>n.attributes-t.attributes);for(const t of this.effects)t.addEventListener("change",this.listener)}updateMaterial(){const o=new Ip;let t=0;for(const u of this.effects)if(u.blendMode.blendFunction===z.DST)o.attributes|=u.getAttributes()&zt.DEPTH;else{if((o.attributes&u.getAttributes()&zt.CONVOLUTION)!==0)throw new Error(`Convolution effects cannot be merged (${u.name})`);Nf("e"+t++,u,o)}let n=o.shaderParts.get(G.FRAGMENT_HEAD),s=o.shaderParts.get(G.FRAGMENT_MAIN_IMAGE),a=o.shaderParts.get(G.FRAGMENT_MAIN_UV);const h=/\bblend\b/g;for(const u of o.blendModes.values())n+=u.getShaderCode().replace(h,`blend${u.blendFunction}`)+`
`;(o.attributes&zt.DEPTH)!==0?(o.readDepth&&(s=`float depth = readDepth(UV);

	`+s),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,o.colorSpace===pe&&(s+=`color0 = sRGBToLinear(color0);
	`),o.uvTransformation?(a=`vec2 transformedUv = vUv;
`+a,o.defines.set("UV","transformedUv")):o.defines.set("UV","vUv"),o.shaderParts.set(G.FRAGMENT_HEAD,n),o.shaderParts.set(G.FRAGMENT_MAIN_IMAGE,s),o.shaderParts.set(G.FRAGMENT_MAIN_UV,a);for(const[u,c]of o.shaderParts)c!==null&&o.shaderParts.set(u,c.trim().replace(/^#/,`
#`));this.skipRendering=t===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(o)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(o,t=Bn){this.fullscreenMaterial.depthBuffer=o,this.fullscreenMaterial.depthPacking=t;for(const n of this.effects)n.setDepthTexture(o,t)}render(o,t,n,s,a){for(const h of this.effects)h.update(o,t,s);if(!this.skipRendering||this.renderToScreen){const h=this.fullscreenMaterial;h.inputBuffer=t.texture,h.time+=s*this.timeScale,o.setRenderTarget(this.renderToScreen?null:n),o.render(this.scene,this.camera)}}setSize(o,t){this.fullscreenMaterial.setSize(o,t);for(const n of this.effects)n.setSize(o,t)}initialize(o,t,n){this.renderer=o;for(const s of this.effects)s.initialize(o,t,n);this.updateMaterial(),n!==void 0&&n!==Ht&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const o of this.effects)o.removeEventListener("change",this.listener),o.dispose()}handleEvent(o){switch(o.type){case"change":this.recompile();break}}},Ar,Wo;function Ff(){return Wo||(Wo=1,Ar={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}),Ar}var Rr,qo;function Hf(){if(qo)return Rr;qo=1;function o(t,n,s){return t*(1-s)+n*s}return Rr=o,Rr}var Dr,$o;function Gf(){if($o)return Dr;$o=1;var o=Ff(),t=Hf();Dr=n;function n(u){var c,p,f,m,_,x,v,E,C,g,w;if(u||(u={}),E=(u.nshades||72)-1,v=u.format||"hex",x=u.colormap,x||(x="jet"),typeof x=="string"){if(x=x.toLowerCase(),!o[x])throw Error(x+" not a supported colorscale");_=o[x]}else if(Array.isArray(x))_=x.slice();else throw Error("unsupported colormap option",x);if(_.length>E+1)throw new Error(x+" map requires nshades to be at least size "+_.length);Array.isArray(u.alpha)?u.alpha.length!==2?g=[1,1]:g=u.alpha.slice():typeof u.alpha=="number"?g=[u.alpha,u.alpha]:g=[1,1],c=_.map(function(T){return Math.round(T.index*E)}),g[0]=Math.min(Math.max(g[0],0),1),g[1]=Math.min(Math.max(g[1],0),1);var S=_.map(function(T,M){var O=_[M].index,R=_[M].rgb.slice();return R.length===4&&R[3]>=0&&R[3]<=1||(R[3]=g[0]+(g[1]-g[0])*O),R}),C=[];for(w=0;w<c.length-1;++w){m=c[w+1]-c[w],p=S[w],f=S[w+1];for(var P=0;P<m;P++){var k=P/m;C.push([Math.round(t(p[0],f[0],k)),Math.round(t(p[1],f[1],k)),Math.round(t(p[2],f[2],k)),t(p[3],f[3],k)])}}return C.push(_[_.length-1].rgb.concat(g[1])),v==="hex"?C=C.map(a):v==="rgbaString"?C=C.map(h):v==="float"&&(C=C.map(s)),C}function s(u){return[u[0]/255,u[1]/255,u[2]/255,u[3]]}function a(u){for(var c,p="#",f=0;f<3;++f)c=u[f],c=c.toString(16),p+=("00"+c).substr(c.length);return p}function h(u){return"rgba("+u.join(",")+")"}return Dr}var jf=Gf();const Kf=na(jf),Xo=(o,t)=>Kf({colormap:o,nshades:t,format:"float",alpha:1}),Zo=(o,t,n)=>o*(1-n)+t*n,Yf=(o,t,n)=>Wf((n-o)/(t-o)),Wf=(o,t=0,n=1)=>Math.min(n,Math.max(t,o));var qf=Fc();const Bt=512,$f=50,Xf=-15,Zf=15,Qf=5,Jf=3,em=50,tm=(o,t)=>{let n=[];for(let s=0;s<o;s++)n.push(Array(t).fill(0));return n},im=o=>{const{perceptualSpread:t,perceptualSharpness:n,spectralFlatness:s,loudness:a}=o;return{loudness:Yf(Jf,em,a.total),perceptualSharpness:n,perceptualSpread:t,spectralFlatness:s}},nm={audio:{channelCount:{ideal:2,min:1},echoCancellation:!0,autoGainControl:!0,noiseSuppression:!0}};class rm{meydaPromise({constrains:t=nm,bufferSize:n=Bt}){return!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia?Promise.reject(new Error("getUserMedia is not supported in this browser. Please use a modern browser with Web Audio API support.")):navigator.mediaDevices.getUserMedia(t).then(s=>this.successStream({stream:s,bufferSize:n})).catch(s=>this.errorStream(s))}successStream({stream:t,bufferSize:n}){this.audioContext=new AudioContext;const s=t.getAudioTracks()[0];return s&&(this.streamAudioSettings=s.getSettings()),this.source=this.audioContext.createMediaStreamSource(t),this.meyda=qf.createMeydaAnalyzer({audioContext:this.audioContext,source:this.source,bufferSize:n}),this.meyda.start(),t}errorStream(t){t.name==="NotAllowedError"?console.error("AudioFeaturesExtractor: Microphone access denied by user"):t.name==="NotFoundError"?console.error("AudioFeaturesExtractor: No microphone device found"):t.name==="NotSupportedError"?console.error("AudioFeaturesExtractor: getUserMedia not supported in this browser"):console.error("AudioFeaturesExtractor:",t.message||t)}features(t=["amplitudeSpectrum","spectralCentroid","spectralRolloff","perceptualSharpness","loudness","rms","chroma","mfcc"]){return!this.meyda||!this.audioContext?null:this.meyda.get(t)}signal(){return this.meyda?this.meyda._m.signal:null}}function sm(o){return pa(document,"keydown").pipe(da(t=>t.keyCode===o),jc(!1),Kc(t=>!t))}function om(o){return pa(o,"click").pipe(Yc(250),Wc())}function am(o){return Hc().pipe(Gc(o),da(t=>!t[1]))}const lm=`
    precision highp float;
    precision highp int;
  
    uniform mat4 viewMatrix;
    uniform mat4 projectionMatrix;
    uniform mat4 modelMatrix;
   
    attribute vec3 position;
  
    uniform vec4 uColor;
  
    varying vec4 vColor;
  
    void main(){
      
      gl_Position = projectionMatrix * viewMatrix * // THREE.Camera
        modelMatrix * // THREE.Mesh
        vec4( position, 1.0 ); // from THREE.BufferGeometry
  
      vColor = uColor;
    }
  `,hm=`
    precision highp float;
  
    varying vec4 vColor;
  
    void main(){
      gl_FragColor =vColor;
    }
  `,ts=Math.min(1.2,window.devicePixelRatio);function um({renderer:o,composer:t}){const n=o.domElement,s=n.clientWidth*ts|0,a=n.clientHeight*ts|0,h=n.width!==s||n.height!==a;return h&&(o.setSize(s,a,!1),t.setSize(s,a)),h}const Qo={type:"change"},bs={type:"start"},fl={type:"end"},wn=new $c,Jo=new Xc,cm=Math.cos(70*Zc.DEG2RAD),oe=new je,be=2*Math.PI,Y={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Or=1e-6;class dm extends qc{constructor(t,n=null){super(t,n),this.state=Y.NONE,this.target=new je,this.cursor=new je,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:ai.ROTATE,MIDDLE:ai.DOLLY,RIGHT:ai.PAN},this.touches={ONE:ri.ROTATE,TWO:ri.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new je,this._lastQuaternion=new Co,this._lastTargetPosition=new je,this._quat=new Co().setFromUnitVectors(t.up,new je(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new Po,this._sphericalDelta=new Po,this._scale=1,this._panOffset=new je,this._rotateStart=new ee,this._rotateEnd=new ee,this._rotateDelta=new ee,this._panStart=new ee,this._panEnd=new ee,this._panDelta=new ee,this._dollyStart=new ee,this._dollyEnd=new ee,this._dollyDelta=new ee,this._dollyDirection=new je,this._mouse=new ee,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=fm.bind(this),this._onPointerDown=pm.bind(this),this._onPointerUp=mm.bind(this),this._onContextMenu=ym.bind(this),this._onMouseWheel=gm.bind(this),this._onKeyDown=bm.bind(this),this._onTouchStart=xm.bind(this),this._onTouchMove=wm.bind(this),this._onMouseDown=vm.bind(this),this._onMouseMove=_m.bind(this),this._interceptControlDown=Em.bind(this),this._interceptControlUp=Cm.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(t){super.connect(t),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(t){t.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=t}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Qo),this.update(),this.state=Y.NONE}update(t=null){const n=this.object.position;oe.copy(n).sub(this.target),oe.applyQuaternion(this._quat),this._spherical.setFromVector3(oe),this.autoRotate&&this.state===Y.NONE&&this._rotateLeft(this._getAutoRotationAngle(t)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let s=this.minAzimuthAngle,a=this.maxAzimuthAngle;isFinite(s)&&isFinite(a)&&(s<-Math.PI?s+=be:s>Math.PI&&(s-=be),a<-Math.PI?a+=be:a>Math.PI&&(a-=be),s<=a?this._spherical.theta=Math.max(s,Math.min(a,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(s+a)/2?Math.max(s,this._spherical.theta):Math.min(a,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let h=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const u=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),h=u!=this._spherical.radius}if(oe.setFromSpherical(this._spherical),oe.applyQuaternion(this._quatInverse),n.copy(this.target).add(oe),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let u=null;if(this.object.isPerspectiveCamera){const c=oe.length();u=this._clampDistance(c*this._scale);const p=c-u;this.object.position.addScaledVector(this._dollyDirection,p),this.object.updateMatrixWorld(),h=!!p}else if(this.object.isOrthographicCamera){const c=new je(this._mouse.x,this._mouse.y,0);c.unproject(this.object);const p=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),h=p!==this.object.zoom;const f=new je(this._mouse.x,this._mouse.y,0);f.unproject(this.object),this.object.position.sub(f).add(c),this.object.updateMatrixWorld(),u=oe.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;u!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(u).add(this.object.position):(wn.origin.copy(this.object.position),wn.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(wn.direction))<cm?this.object.lookAt(this.target):(Jo.setFromNormalAndCoplanarPoint(this.object.up,this.target),wn.intersectPlane(Jo,this.target))))}else if(this.object.isOrthographicCamera){const u=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),u!==this.object.zoom&&(this.object.updateProjectionMatrix(),h=!0)}return this._scale=1,this._performCursorZoom=!1,h||this._lastPosition.distanceToSquared(this.object.position)>Or||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Or||this._lastTargetPosition.distanceToSquared(this.target)>Or?(this.dispatchEvent(Qo),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(t){return t!==null?be/60*this.autoRotateSpeed*t:be/60/60*this.autoRotateSpeed}_getZoomScale(t){const n=Math.abs(t*.01);return Math.pow(.95,this.zoomSpeed*n)}_rotateLeft(t){this._sphericalDelta.theta-=t}_rotateUp(t){this._sphericalDelta.phi-=t}_panLeft(t,n){oe.setFromMatrixColumn(n,0),oe.multiplyScalar(-t),this._panOffset.add(oe)}_panUp(t,n){this.screenSpacePanning===!0?oe.setFromMatrixColumn(n,1):(oe.setFromMatrixColumn(n,0),oe.crossVectors(this.object.up,oe)),oe.multiplyScalar(t),this._panOffset.add(oe)}_pan(t,n){const s=this.domElement;if(this.object.isPerspectiveCamera){const a=this.object.position;oe.copy(a).sub(this.target);let h=oe.length();h*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*t*h/s.clientHeight,this.object.matrix),this._panUp(2*n*h/s.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(t*(this.object.right-this.object.left)/this.object.zoom/s.clientWidth,this.object.matrix),this._panUp(n*(this.object.top-this.object.bottom)/this.object.zoom/s.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(t,n){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const s=this.domElement.getBoundingClientRect(),a=t-s.left,h=n-s.top,u=s.width,c=s.height;this._mouse.x=a/u*2-1,this._mouse.y=-(h/c)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(t){return Math.max(this.minDistance,Math.min(this.maxDistance,t))}_handleMouseDownRotate(t){this._rotateStart.set(t.clientX,t.clientY)}_handleMouseDownDolly(t){this._updateZoomParameters(t.clientX,t.clientX),this._dollyStart.set(t.clientX,t.clientY)}_handleMouseDownPan(t){this._panStart.set(t.clientX,t.clientY)}_handleMouseMoveRotate(t){this._rotateEnd.set(t.clientX,t.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const n=this.domElement;this._rotateLeft(be*this._rotateDelta.x/n.clientHeight),this._rotateUp(be*this._rotateDelta.y/n.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(t){this._dollyEnd.set(t.clientX,t.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(t){this._panEnd.set(t.clientX,t.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(t){this._updateZoomParameters(t.clientX,t.clientY),t.deltaY<0?this._dollyIn(this._getZoomScale(t.deltaY)):t.deltaY>0&&this._dollyOut(this._getZoomScale(t.deltaY)),this.update()}_handleKeyDown(t){let n=!1;switch(t.code){case this.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(be*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),n=!0;break;case this.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(-be*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),n=!0;break;case this.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(be*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),n=!0;break;case this.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(-be*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),n=!0;break}n&&(t.preventDefault(),this.update())}_handleTouchStartRotate(t){if(this._pointers.length===1)this._rotateStart.set(t.pageX,t.pageY);else{const n=this._getSecondPointerPosition(t),s=.5*(t.pageX+n.x),a=.5*(t.pageY+n.y);this._rotateStart.set(s,a)}}_handleTouchStartPan(t){if(this._pointers.length===1)this._panStart.set(t.pageX,t.pageY);else{const n=this._getSecondPointerPosition(t),s=.5*(t.pageX+n.x),a=.5*(t.pageY+n.y);this._panStart.set(s,a)}}_handleTouchStartDolly(t){const n=this._getSecondPointerPosition(t),s=t.pageX-n.x,a=t.pageY-n.y,h=Math.sqrt(s*s+a*a);this._dollyStart.set(0,h)}_handleTouchStartDollyPan(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enablePan&&this._handleTouchStartPan(t)}_handleTouchStartDollyRotate(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enableRotate&&this._handleTouchStartRotate(t)}_handleTouchMoveRotate(t){if(this._pointers.length==1)this._rotateEnd.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),a=.5*(t.pageX+s.x),h=.5*(t.pageY+s.y);this._rotateEnd.set(a,h)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const n=this.domElement;this._rotateLeft(be*this._rotateDelta.x/n.clientHeight),this._rotateUp(be*this._rotateDelta.y/n.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(t){if(this._pointers.length===1)this._panEnd.set(t.pageX,t.pageY);else{const n=this._getSecondPointerPosition(t),s=.5*(t.pageX+n.x),a=.5*(t.pageY+n.y);this._panEnd.set(s,a)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(t){const n=this._getSecondPointerPosition(t),s=t.pageX-n.x,a=t.pageY-n.y,h=Math.sqrt(s*s+a*a);this._dollyEnd.set(0,h),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const u=(t.pageX+n.x)*.5,c=(t.pageY+n.y)*.5;this._updateZoomParameters(u,c)}_handleTouchMoveDollyPan(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enablePan&&this._handleTouchMovePan(t)}_handleTouchMoveDollyRotate(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enableRotate&&this._handleTouchMoveRotate(t)}_addPointer(t){this._pointers.push(t.pointerId)}_removePointer(t){delete this._pointerPositions[t.pointerId];for(let n=0;n<this._pointers.length;n++)if(this._pointers[n]==t.pointerId){this._pointers.splice(n,1);return}}_isTrackingPointer(t){for(let n=0;n<this._pointers.length;n++)if(this._pointers[n]==t.pointerId)return!0;return!1}_trackPointer(t){let n=this._pointerPositions[t.pointerId];n===void 0&&(n=new ee,this._pointerPositions[t.pointerId]=n),n.set(t.pageX,t.pageY)}_getSecondPointerPosition(t){const n=t.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[n]}_customWheelEvent(t){const n=t.deltaMode,s={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(n){case 1:s.deltaY*=16;break;case 2:s.deltaY*=100;break}return t.ctrlKey&&!this._controlActive&&(s.deltaY*=10),s}}function pm(o){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(o.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(o)&&(this._addPointer(o),o.pointerType==="touch"?this._onTouchStart(o):this._onMouseDown(o)))}function fm(o){this.enabled!==!1&&(o.pointerType==="touch"?this._onTouchMove(o):this._onMouseMove(o))}function mm(o){switch(this._removePointer(o),this._pointers.length){case 0:this.domElement.releasePointerCapture(o.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(fl),this.state=Y.NONE;break;case 1:const t=this._pointers[0],n=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:n.x,pageY:n.y});break}}function vm(o){let t;switch(o.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case ai.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(o),this.state=Y.DOLLY;break;case ai.ROTATE:if(o.ctrlKey||o.metaKey||o.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(o),this.state=Y.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(o),this.state=Y.ROTATE}break;case ai.PAN:if(o.ctrlKey||o.metaKey||o.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(o),this.state=Y.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(o),this.state=Y.PAN}break;default:this.state=Y.NONE}this.state!==Y.NONE&&this.dispatchEvent(bs)}function _m(o){switch(this.state){case Y.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(o);break;case Y.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(o);break;case Y.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(o);break}}function gm(o){this.enabled===!1||this.enableZoom===!1||this.state!==Y.NONE||(o.preventDefault(),this.dispatchEvent(bs),this._handleMouseWheel(this._customWheelEvent(o)),this.dispatchEvent(fl))}function bm(o){this.enabled!==!1&&this._handleKeyDown(o)}function xm(o){switch(this._trackPointer(o),this._pointers.length){case 1:switch(this.touches.ONE){case ri.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(o),this.state=Y.TOUCH_ROTATE;break;case ri.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(o),this.state=Y.TOUCH_PAN;break;default:this.state=Y.NONE}break;case 2:switch(this.touches.TWO){case ri.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(o),this.state=Y.TOUCH_DOLLY_PAN;break;case ri.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(o),this.state=Y.TOUCH_DOLLY_ROTATE;break;default:this.state=Y.NONE}break;default:this.state=Y.NONE}this.state!==Y.NONE&&this.dispatchEvent(bs)}function wm(o){switch(this._trackPointer(o),this.state){case Y.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(o),this.update();break;case Y.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(o),this.update();break;case Y.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(o),this.update();break;case Y.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(o),this.update();break;default:this.state=Y.NONE}}function ym(o){this.enabled!==!1&&o.preventDefault()}function Em(o){o.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function Cm(o){o.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const Pm=75,Sm=4/3,Tm=5,Mm=1e4,km=25,Am=7,Rm=.05,Dm=1,Om=Math.PI/2;function Lm(){return new la(Pm,Sm,Tm,Mm)}function Bm(o,t){const n=new dm(o,t);return n.enableDamping=!0,n.enablePan=!1,n.maxDistance=km,n.minDistance=Am,n.dampingFactor=Rm,n.minAzimuthAngle=-Math.PI,n.maxAzimuthAngle=Math.PI,n.minPolarAngle=Dm,n.maxPolarAngle=Om,n}function Im(o){return new Qc({uniforms:{uColor:{value:o}},vertexShader:lm,fragmentShader:hm,transparent:!0,side:zi})}const Um=32,Vm=-5,Nm=10,ea=16777215,zm=.75,Fm=1,Hm=1,Gm=0,jm=1,Km=1,Ym=1.25,Wm=1.2,qm=1,$m=3,Xm=30,Zm=15,Qm=.001,Lr=.5,Jm=-8,ta="picnic",Br=new rm,ev=document.querySelector("#cover"),ia=document.querySelector("#canvas"),ml=new Cp;document.querySelector("#stats").appendChild(ml.dom);let Ie,Ir,Vi,Dt,Ni,yn,Ur,Ue,En,ni,Vr;const Wi={amount:4,xscale:50},Ft={loudness:0,perceptualSharpness:0,perceptualSpread:0,spectralFlatness:0},_i=new Tp.Pane({title:"controls",expanded:!0});_i.addInput(Wi,"amount",{min:1,max:6});_i.addInput(Wi,"xscale",{min:20,max:100});_i.addMonitor(Ft,"loudness",{view:"graph",min:0,max:1});_i.addMonitor(Ft,"perceptualSpread",{view:"graph",min:0,max:1});_i.addMonitor(Ft,"perceptualSharpness",{view:"graph",min:0,max:1});_i.addMonitor(Ft,"spectralFlatness",{view:"graph",min:0,max:1});class tv{init(){this.scene=new Nr,Dt=Lm(),Dt.position.set(0,Vm,Nm),Dt.lookAt(0,0,0),Vi=new Jc({canvas:ia,antialias:!0,alpha:!0,powerPreference:"high-performance"}),Vi.setPixelRatio(ts),Ur=Bm(Dt,ia),Ur.update();const t=new ed(ea,zm);t.position.set(0,Fm,Hm),this.scene.add(t);const n=new Bf(this.scene,Dt);yn=new Lf({intensity:jm,luminanceThreshold:Gm,radius:Wm});const s=new zf(null,yn);Ni=new Bp(Vi),Ni.addPass(n),Ni.addPass(s),Ie=tm($f,Bt),ni=new td,Vr=new zr,Ue=new id(new nd(1),new rd({color:ea}),Bt),Ue.instanceMatrix.setUsage(sd),Ue.position.set(Jm,0,0),Ue.scale.set(1,1,1);let a=Xo(ta,Ie.length);Ir=Xo(ta,Bt).map(h=>new zr().fromArray(h)),Ir.forEach((h,u)=>Ue.setColorAt(u,h)),this.scene.add(Ue),En=new od;for(let h=0;h<Ie.length;h++)if(Ie[h]){const u=new ca;u.setAttribute("position",new Fr(new Float32Array(Ie[h].length*3),3)),u.computeBoundingSphere();const c=Im(a[Ie.length-h-1]),p=new ra(u,c);p.frustumCulled=!1,En.add(p)}this.scene.add(En)}intro(){Jr.timeline().to("#cover",{duration:1,autoAlpha:0,ease:"power2.out"}).to("#cover",{duration:1,delay:1,autoAlpha:0,ease:"power2.out"})}render([{timestamp:t}]){if(um({renderer:Vi,composer:Ni})){const{clientWidth:p,clientHeight:f}=Vi.domElement;Dt.aspect=p/f,Dt.updateProjectionMatrix()}const n=Br.features(["perceptualSharpness","perceptualSpread","spectralFlatness","amplitudeSpectrum","loudness"]);if(!n)return;const{amplitudeSpectrum:s}=n;Ie.pop(),Ie.unshift(s),Object.assign(Ft,im(n));const{loudness:a,perceptualSharpness:h,perceptualSpread:u}=Ft;yn.intensity=Zo(Km,Ym,a),yn.radius=Zo(qm,$m,h);for(let p=0;p<Ie.length;p++){const f=En.children[p].geometry.getAttribute("position");for(let m=0;m<f.count*3;m++){const _=m*3;f.array[_+0]=Wi.xscale+Wi.xscale*Math.log10(m/Ie[p].length),f.array[_+1]=Xf+Ft.perceptualSharpness+Ie[p][m]*(Wi.amount*a),f.array[_+2]=Zf-p*(Qf*u)}f.needsUpdate=!0}const c=Br.signal();if(c&&Ue){for(let p=0;p<Bt;p++)ni.position.set(Zm*p/Bt,c[p]*Xm,0),ni.rotation.set((t+a)*Qm,0,a),ni.scale.set(a*Lr,h*Lr,u*Lr),ni.updateMatrix(),Vr.set(Ir[p]),Ue.setColorAt(p,Vr),Ue.setMatrixAt(p,ni.matrix);Ue.instanceMatrix.needsUpdate=!0,Ue.instanceColor.needsUpdate=!0}Ur.update(),Ni.render(),ml.update()}run$(){return Jr.timeline().to("#cover",{duration:2,autoAlpha:1,ease:"expo.inOut"}),ad(ld([om(ev),hd(Br.meydaPromise({fftSize:Bt}))]).pipe(ud({count:2,delay:1e3}),So(()=>{this.init(),this.intro()})),am(sm(Um)).pipe(So(this.render))).pipe(cd(t=>(console.error("Error:",t),dd))).subscribe()}}document.addEventListener("DOMContentLoaded",()=>{new tv().run$()});
