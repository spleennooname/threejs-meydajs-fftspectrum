import{c as Z}from"./vendor.745aed45.js";var ee={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]};function re(f,y,m){return f*(1-m)+y*m}var ne=re,L=ee,X=ne,be=ie;function ie(f){var y,m,S,k,_,h,j,R,c,p,F;if(f||(f={}),R=(f.nshades||72)-1,j=f.format||"hex",h=f.colormap,h||(h="jet"),typeof h=="string"){if(h=h.toLowerCase(),!L[h])throw Error(h+" not a supported colorscale");_=L[h]}else if(Array.isArray(h))_=h.slice();else throw Error("unsupported colormap option",h);if(_.length>R+1)throw new Error(h+" map requires nshades to be at least size "+_.length);Array.isArray(f.alpha)?f.alpha.length!==2?p=[1,1]:p=f.alpha.slice():typeof f.alpha=="number"?p=[f.alpha,f.alpha]:p=[1,1],y=_.map(function(q){return Math.round(q.index*R)}),p[0]=Math.min(Math.max(p[0],0),1),p[1]=Math.min(Math.max(p[1],0),1);var P=_.map(function(q,N){var B=_[N].index,T=_[N].rgb.slice();return T.length===4&&T[3]>=0&&T[3]<=1||(T[3]=p[0]+(p[1]-p[0])*B),T}),c=[];for(F=0;F<y.length-1;++F){k=y[F+1]-y[F],m=P[F],S=P[F+1];for(var I=0;I<k;I++){var O=I/k;c.push([Math.round(X(m[0],S[0],O)),Math.round(X(m[1],S[1],O)),Math.round(X(m[2],S[2],O)),X(m[3],S[3],O)])}}return c.push(_[_.length-1].rgb.concat(p[1])),j==="hex"?c=c.map(ae):j==="rgbaString"?c=c.map(oe):j==="float"&&(c=c.map(te)),c}function te(f){return[f[0]/255,f[1]/255,f[2]/255,f[3]]}function ae(f){for(var y,m="#",S=0;S<3;++S)y=f[S],y=y.toString(16),m+=("00"+y).substr(y.length);return m}function oe(f){return"rgba("+f.join(",")+")"}var ge={exports:{}};(function(f,y){(function(m,S){f.exports=S()})(Z,function(){function m(r,e,i){if(i||arguments.length===2)for(var n,t=0,a=e.length;t<a;t++)!n&&t in e||(n||(n=Array.prototype.slice.call(e,0,t)),n[t]=e[t]);return r.concat(n||Array.prototype.slice.call(e))}var S=Object.freeze({__proto__:null,blackman:function(r){for(var e=new Float32Array(r),i=2*Math.PI/(r-1),n=2*i,t=0;t<r/2;t++)e[t]=.42-.5*Math.cos(t*i)+.08*Math.cos(t*n);for(t=Math.ceil(r/2);t>0;t--)e[r-t]=e[t-1];return e},hamming:function(r){for(var e=new Float32Array(r),i=0;i<r;i++)e[i]=.54-.46*Math.cos(2*Math.PI*(i/r-1));return e},hanning:function(r){for(var e=new Float32Array(r),i=0;i<r;i++)e[i]=.5-.5*Math.cos(2*Math.PI*i/(r-1));return e},sine:function(r){for(var e=Math.PI/(r-1),i=new Float32Array(r),n=0;n<r;n++)i[n]=Math.sin(e*n);return i}}),k={};function _(r){for(;r%2==0&&r>1;)r/=2;return r===1}function h(r,e){if(e!=="rect"){if(e!==""&&e||(e="hanning"),k[e]||(k[e]={}),!k[e][r.length])try{k[e][r.length]=S[e](r.length)}catch{throw new Error("Invalid windowing function")}r=function(i,n){for(var t=[],a=0;a<Math.min(i.length,n.length);a++)t[a]=i[a]*n[a];return t}(r,k[e][r.length])}return r}function j(r,e,i){for(var n=new Float32Array(r),t=0;t<n.length;t++)n[t]=t*e/i,n[t]=13*Math.atan(n[t]/1315.8)+3.5*Math.atan(Math.pow(n[t]/7518,2));return n}function R(r){return Float32Array.from(r)}function p(r){return 1125*Math.log(1+r/700)}function F(r,e,i){for(var n,t=new Float32Array(r+2),a=new Float32Array(r+2),d=e/2,u=p(0),g=(p(d)-u)/(r+1),o=new Array(r+2),l=0;l<t.length;l++)t[l]=l*g,a[l]=(n=t[l],700*(Math.exp(n/1125)-1)),o[l]=Math.floor((i+1)*a[l]/e);for(var w=new Array(r),b=0;b<w.length;b++){for(w[b]=new Array(i/2+1).fill(0),l=o[b];l<o[b+1];l++)w[b][l]=(l-o[b])/(o[b+1]-o[b]);for(l=o[b+1];l<o[b+2];l++)w[b][l]=(o[b+2]-l)/(o[b+2]-o[b+1])}return w}function P(r,e,i,n,t,a,d){n===void 0&&(n=5),t===void 0&&(t=2),a===void 0&&(a=!0),d===void 0&&(d=440);var u=Math.floor(i/2)+1,g=new Array(i).fill(0).map(function(s,v){return r*function(M,z){return Math.log2(16*M/z)}(e*v/i,d)});g[0]=g[1]-1.5*r;var o,l,w,b=g.slice(1).map(function(s,v){return Math.max(s-g[v])},1).concat([1]),C=Math.round(r/2),A=new Array(r).fill(0).map(function(s,v){return g.map(function(M){return(10*r+C+M-v)%r-C})}),E=A.map(function(s,v){return s.map(function(M,z){return Math.exp(-.5*Math.pow(2*A[v][z]/b[z],2))})});if(l=(o=E)[0].map(function(){return 0}),w=o.reduce(function(s,v){return v.forEach(function(M,z){s[z]+=Math.pow(M,2)}),s},l).map(Math.sqrt),E=o.map(function(s,v){return s.map(function(M,z){return M/(w[z]||1)})}),t){var G=g.map(function(s){return Math.exp(-.5*Math.pow((s/r-n)/t,2))});E=E.map(function(s){return s.map(function(v,M){return v*G[M]})})}return a&&(E=m(m([],E.slice(3),!0),E.slice(0,3),!0)),E.map(function(s){return s.slice(0,u)})}function c(r,e){for(var i=0,n=0,t=0;t<e.length;t++)i+=Math.pow(t,r)*Math.abs(e[t]),n+=e[t];return i/n}function I(r){var e=r.ampSpectrum,i=r.barkScale,n=r.numberOfBarkBands,t=n===void 0?24:n;if(typeof e!="object"||typeof i!="object")throw new TypeError;var a=t,d=new Float32Array(a),u=0,g=e,o=new Int32Array(a+1);o[0]=0;for(var l=i[g.length-1]/a,w=1,b=0;b<g.length;b++)for(;i[b]>l;)o[w++]=b,l=w*i[g.length-1]/a;for(o[a]=g.length-1,b=0;b<a;b++){for(var C=0,A=o[b];A<o[b+1];A++)C+=g[A];d[b]=Math.pow(C,.23)}for(b=0;b<d.length;b++)u+=d[b];return{specific:d,total:u}}function O(r){var e=r.ampSpectrum;if(typeof e!="object")throw new TypeError;for(var i=new Float32Array(e.length),n=0;n<i.length;n++)i[n]=Math.pow(e[n],2);return i}function q(r){var e=r.ampSpectrum,i=r.melFilterBank,n=r.bufferSize;if(typeof e!="object")throw new TypeError("Valid ampSpectrum is required to generate melBands");if(typeof i!="object")throw new TypeError("Valid melFilterBank is required to generate melBands");for(var t=O({ampSpectrum:e}),a=i.length,d=Array(a),u=new Float32Array(a),g=0;g<u.length;g++){d[g]=new Float32Array(n/2),u[g]=0;for(var o=0;o<n/2;o++)d[g][o]=i[g][o]*t[o],u[g]+=d[g][o];u[g]=Math.log(u[g]+1)}return Array.prototype.slice.call(u)}function N(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var B=null,T=N(function(r,e){var i=r.length;return e=e||2,B&&B[i]||function(n){(B=B||{})[n]=new Array(n*n);for(var t=Math.PI/n,a=0;a<n;a++)for(var d=0;d<n;d++)B[n][d+a*n]=Math.cos(t*(d+.5)*a)}(i),r.map(function(){return 0}).map(function(n,t){return e*r.reduce(function(a,d,u,g){return a+d*B[i][u+t*i]},0)})}),H=Object.freeze({__proto__:null,amplitudeSpectrum:function(r){return r.ampSpectrum},buffer:function(r){return r.signal},chroma:function(r){var e=r.ampSpectrum,i=r.chromaFilterBank;if(typeof e!="object")throw new TypeError("Valid ampSpectrum is required to generate chroma");if(typeof i!="object")throw new TypeError("Valid chromaFilterBank is required to generate chroma");var n=i.map(function(a,d){return e.reduce(function(u,g,o){return u+g*a[o]},0)}),t=Math.max.apply(Math,n);return t?n.map(function(a){return a/t}):n},complexSpectrum:function(r){return r.complexSpectrum},energy:function(r){var e=r.signal;if(typeof e!="object")throw new TypeError;for(var i=0,n=0;n<e.length;n++)i+=Math.pow(Math.abs(e[n]),2);return i},loudness:I,melBands:q,mfcc:function(r){var e=r.ampSpectrum,i=r.melFilterBank,n=r.numberOfMFCCCoefficients,t=r.bufferSize,a=Math.min(40,Math.max(1,n||13));if(i.length<a)throw new Error("Insufficient filter bank for requested number of coefficients");var d=q({ampSpectrum:e,melFilterBank:i,bufferSize:t});return T(d).slice(0,a)},perceptualSharpness:function(r){for(var e=I({ampSpectrum:r.ampSpectrum,barkScale:r.barkScale}),i=e.specific,n=0,t=0;t<i.length;t++)n+=t<15?(t+1)*i[t+1]:.066*Math.exp(.171*(t+1));return n*=.11/e.total},perceptualSpread:function(r){for(var e=I({ampSpectrum:r.ampSpectrum,barkScale:r.barkScale}),i=0,n=0;n<e.specific.length;n++)e.specific[n]>i&&(i=e.specific[n]);return Math.pow((e.total-i)/e.total,2)},powerSpectrum:O,rms:function(r){var e=r.signal;if(typeof e!="object")throw new TypeError;for(var i=0,n=0;n<e.length;n++)i+=Math.pow(e[n],2);return i/=e.length,i=Math.sqrt(i)},spectralCentroid:function(r){var e=r.ampSpectrum;if(typeof e!="object")throw new TypeError;return c(1,e)},spectralCrest:function(r){var e=r.ampSpectrum;if(typeof e!="object")throw new TypeError;var i=0,n=-1/0;return e.forEach(function(t){i+=Math.pow(t,2),n=t>n?t:n}),i/=e.length,i=Math.sqrt(i),n/i},spectralFlatness:function(r){var e=r.ampSpectrum;if(typeof e!="object")throw new TypeError;for(var i=0,n=0,t=0;t<e.length;t++)i+=Math.log(e[t]),n+=e[t];return Math.exp(i/e.length)*e.length/n},spectralFlux:function(r){var e=r.signal,i=r.previousSignal,n=r.bufferSize;if(typeof e!="object"||typeof i!="object")throw new TypeError;for(var t=0,a=-n/2;a<e.length/2-1;a++)x=Math.abs(e[a])-Math.abs(i[a]),t+=(x+Math.abs(x))/2;return t},spectralKurtosis:function(r){var e=r.ampSpectrum;if(typeof e!="object")throw new TypeError;var i=e,n=c(1,i),t=c(2,i),a=c(3,i),d=c(4,i);return(-3*Math.pow(n,4)+6*n*t-4*n*a+d)/Math.pow(Math.sqrt(t-Math.pow(n,2)),4)},spectralRolloff:function(r){var e=r.ampSpectrum,i=r.sampleRate;if(typeof e!="object")throw new TypeError;for(var n=e,t=i/(2*(n.length-1)),a=0,d=0;d<n.length;d++)a+=n[d];for(var u=.99*a,g=n.length-1;a>u&&g>=0;)a-=n[g],--g;return(g+1)*t},spectralSkewness:function(r){var e=r.ampSpectrum;if(typeof e!="object")throw new TypeError;var i=c(1,e),n=c(2,e),t=c(3,e);return(2*Math.pow(i,3)-3*i*n+t)/Math.pow(Math.sqrt(n-Math.pow(i,2)),3)},spectralSlope:function(r){var e=r.ampSpectrum,i=r.sampleRate,n=r.bufferSize;if(typeof e!="object")throw new TypeError;for(var t=0,a=0,d=new Float32Array(e.length),u=0,g=0,o=0;o<e.length;o++){t+=e[o];var l=o*i/n;d[o]=l,u+=l*l,a+=l,g+=l*e[o]}return(e.length*g-a*t)/(t*(u-Math.pow(a,2)))},spectralSpread:function(r){var e=r.ampSpectrum;if(typeof e!="object")throw new TypeError;return Math.sqrt(c(2,e)-Math.pow(c(1,e),2))},zcr:function(r){var e=r.signal;if(typeof e!="object")throw new TypeError;for(var i=0,n=1;n<e.length;n++)(e[n-1]>=0&&e[n]<0||e[n-1]<0&&e[n]>=0)&&i++;return i}});function J(r){if(Array.isArray(r)){for(var e=0,i=Array(r.length);e<r.length;e++)i[e]=r[e];return i}return Array.from(r)}var V={},U={},D={bitReverseArray:function(r){if(V[r]===void 0){for(var e=(r-1).toString(2).length,i="0".repeat(e),n={},t=0;t<r;t++){var a=t.toString(2);a=i.substr(a.length)+a,a=[].concat(J(a)).reverse().join(""),n[t]=parseInt(a,2)}V[r]=n}return V[r]},multiply:function(r,e){return{real:r.real*e.real-r.imag*e.imag,imag:r.real*e.imag+r.imag*e.real}},add:function(r,e){return{real:r.real+e.real,imag:r.imag+e.imag}},subtract:function(r,e){return{real:r.real-e.real,imag:r.imag-e.imag}},euler:function(r,e){var i=-2*Math.PI*r/e;return{real:Math.cos(i),imag:Math.sin(i)}},conj:function(r){return r.imag*=-1,r},constructComplexArray:function(r){var e={};e.real=r.real===void 0?r.slice():r.real.slice();var i=e.real.length;return U[i]===void 0&&(U[i]=Array.apply(null,Array(i)).map(Number.prototype.valueOf,0)),e.imag=U[i].slice(),e}},Q=function(r){var e={};r.real===void 0||r.imag===void 0?e=D.constructComplexArray(r):(e.real=r.real.slice(),e.imag=r.imag.slice());var i=e.real.length,n=Math.log2(i);if(Math.round(n)!=n)throw new Error("Input size must be a power of 2.");if(e.real.length!=e.imag.length)throw new Error("Real and imaginary components must have the same length.");for(var t=D.bitReverseArray(i),a={real:[],imag:[]},d=0;d<i;d++)a.real[t[d]]=e.real[d],a.imag[t[d]]=e.imag[d];for(var u=0;u<i;u++)e.real[u]=a.real[u],e.imag[u]=a.imag[u];for(var g=1;g<=n;g++)for(var o=Math.pow(2,g),l=0;l<o/2;l++)for(var w=D.euler(l,o),b=0;b<i/o;b++){var C=o*b+l,A=o*b+l+o/2,E={real:e.real[C],imag:e.imag[C]},G={real:e.real[A],imag:e.imag[A]},s=D.multiply(w,G),v=D.subtract(E,s);e.real[A]=v.real,e.imag[A]=v.imag;var M=D.add(s,E);e.real[C]=M.real,e.imag[C]=M.imag}return e},W=Q,Y=function(){function r(e,i){var n=this;if(this._m=i,!e.audioContext)throw this._m.errors.noAC;if(e.bufferSize&&!_(e.bufferSize))throw this._m._errors.notPow2;if(!e.source)throw this._m._errors.noSource;this._m.audioContext=e.audioContext,this._m.bufferSize=e.bufferSize||this._m.bufferSize||256,this._m.hopSize=e.hopSize||this._m.hopSize||this._m.bufferSize,this._m.sampleRate=e.sampleRate||this._m.audioContext.sampleRate||44100,this._m.callback=e.callback,this._m.windowingFunction=e.windowingFunction||"hanning",this._m.featureExtractors=H,this._m.EXTRACTION_STARTED=e.startImmediately||!1,this._m.channel=typeof e.channel=="number"?e.channel:0,this._m.inputs=e.inputs||1,this._m.outputs=e.outputs||1,this._m.numberOfMFCCCoefficients=e.numberOfMFCCCoefficients||this._m.numberOfMFCCCoefficients||13,this._m.numberOfBarkBands=e.numberOfBarkBands||this._m.numberOfBarkBands||24,this._m.spn=this._m.audioContext.createScriptProcessor(this._m.bufferSize,this._m.inputs,this._m.outputs),this._m.spn.connect(this._m.audioContext.destination),this._m._featuresToExtract=e.featureExtractors||[],this._m.barkScale=j(this._m.bufferSize,this._m.sampleRate,this._m.bufferSize),this._m.melFilterBank=F(Math.max(this._m.melBands,this._m.numberOfMFCCCoefficients),this._m.sampleRate,this._m.bufferSize),this._m.inputData=null,this._m.previousInputData=null,this._m.frame=null,this._m.previousFrame=null,this.setSource(e.source),this._m.spn.onaudioprocess=function(t){var a;n._m.inputData!==null&&(n._m.previousInputData=n._m.inputData),n._m.inputData=t.inputBuffer.getChannelData(n._m.channel),n._m.previousInputData?((a=new Float32Array(n._m.previousInputData.length+n._m.inputData.length-n._m.hopSize)).set(n._m.previousInputData.slice(n._m.hopSize)),a.set(n._m.inputData,n._m.previousInputData.length-n._m.hopSize)):a=n._m.inputData;var d=function(u,g,o){if(u.length<g)throw new Error("Buffer is too short for frame length");if(o<1)throw new Error("Hop length cannot be less that 1");if(g<1)throw new Error("Frame length cannot be less that 1");var l=1+Math.floor((u.length-g)/o);return new Array(l).fill(0).map(function(w,b){return u.slice(b*o,b*o+g)})}(a,n._m.bufferSize,n._m.hopSize);d.forEach(function(u){n._m.frame=u;var g=n._m.extract(n._m._featuresToExtract,n._m.frame,n._m.previousFrame);typeof n._m.callback=="function"&&n._m.EXTRACTION_STARTED&&n._m.callback(g),n._m.previousFrame=n._m.frame})}}return r.prototype.start=function(e){this._m._featuresToExtract=e||this._m._featuresToExtract,this._m.EXTRACTION_STARTED=!0},r.prototype.stop=function(){this._m.EXTRACTION_STARTED=!1},r.prototype.setSource=function(e){this._m.source&&this._m.source.disconnect(this._m.spn),this._m.source=e,this._m.source.connect(this._m.spn)},r.prototype.setChannel=function(e){e<=this._m.inputs?this._m.channel=e:console.error("Channel ".concat(e," does not exist. Make sure you've provided a value for 'inputs' that is greater than ").concat(e," when instantiating the MeydaAnalyzer"))},r.prototype.get=function(e){return this._m.inputData?this._m.extract(e||this._m._featuresToExtract,this._m.inputData,this._m.previousInputData):null},r}(),$={audioContext:null,spn:null,bufferSize:512,sampleRate:44100,melBands:26,chromaBands:12,callback:null,windowingFunction:"hanning",featureExtractors:H,EXTRACTION_STARTED:!1,numberOfMFCCCoefficients:13,numberOfBarkBands:24,_featuresToExtract:[],windowing:h,_errors:{notPow2:new Error("Meyda: Buffer size must be a power of 2, e.g. 64 or 512"),featureUndef:new Error("Meyda: No features defined."),invalidFeatureFmt:new Error("Meyda: Invalid feature format"),invalidInput:new Error("Meyda: Invalid input."),noAC:new Error("Meyda: No AudioContext specified."),noSource:new Error("Meyda: No source node specified.")},createMeydaAnalyzer:function(r){return new Y(r,Object.assign({},$))},listAvailableFeatureExtractors:function(){return Object.keys(this.featureExtractors)},extract:function(r,e,i){var n=this;if(!e)throw this._errors.invalidInput;if(typeof e!="object")throw this._errors.invalidInput;if(!r)throw this._errors.featureUndef;if(!_(e.length))throw this._errors.notPow2;this.barkScale!==void 0&&this.barkScale.length==this.bufferSize||(this.barkScale=j(this.bufferSize,this.sampleRate,this.bufferSize)),this.melFilterBank!==void 0&&this.barkScale.length==this.bufferSize&&this.melFilterBank.length==this.melBands||(this.melFilterBank=F(Math.max(this.melBands,this.numberOfMFCCCoefficients),this.sampleRate,this.bufferSize)),this.chromaFilterBank!==void 0&&this.chromaFilterBank.length==this.chromaBands||(this.chromaFilterBank=P(this.chromaBands,this.sampleRate,this.bufferSize)),"buffer"in e&&e.buffer===void 0?this.signal=R(e):this.signal=e;var t=K(e,this.windowingFunction,this.bufferSize);if(this.signal=t.windowedSignal,this.complexSpectrum=t.complexSpectrum,this.ampSpectrum=t.ampSpectrum,i){var a=K(i,this.windowingFunction,this.bufferSize);this.previousSignal=a.windowedSignal,this.previousComplexSpectrum=a.complexSpectrum,this.previousAmpSpectrum=a.ampSpectrum}var d=function(u){return n.featureExtractors[u]({ampSpectrum:n.ampSpectrum,chromaFilterBank:n.chromaFilterBank,complexSpectrum:n.complexSpectrum,signal:n.signal,bufferSize:n.bufferSize,sampleRate:n.sampleRate,barkScale:n.barkScale,melFilterBank:n.melFilterBank,previousSignal:n.previousSignal,previousAmpSpectrum:n.previousAmpSpectrum,previousComplexSpectrum:n.previousComplexSpectrum,numberOfMFCCCoefficients:n.numberOfMFCCCoefficients,numberOfBarkBands:n.numberOfBarkBands})};if(typeof r=="object")return r.reduce(function(u,g){var o;return Object.assign({},u,((o={})[g]=d(g),o))},{});if(typeof r=="string")return d(r);throw this._errors.invalidFeatureFmt}},K=function(r,e,i){var n={};r.buffer===void 0?n.signal=R(r):n.signal=r,n.windowedSignal=h(n.signal,e),n.complexSpectrum=W(n.windowedSignal),n.ampSpectrum=new Float32Array(i/2);for(var t=0;t<i/2;t++)n.ampSpectrum[t]=Math.sqrt(Math.pow(n.complexSpectrum.real[t],2)+Math.pow(n.complexSpectrum.imag[t],2));return n};return typeof window!="undefined"&&(window.Meyda=$),$})})(ge);export{be as c,ge as m};
